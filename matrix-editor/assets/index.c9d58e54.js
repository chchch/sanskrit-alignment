import{showSaveFilePicker as jt}from"https://cdn.jsdelivr.net/npm/native-file-system-adapter/mod.js";(function(){const k=document.createElement("link").relList;if(k&&k.supports&&k.supports("modulepreload"))return;for(const C of document.querySelectorAll('link[rel="modulepreload"]'))H(C);new MutationObserver(C=>{for(const b of C)if(b.type==="childList")for(const f of b.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&H(f)}).observe(document,{childList:!0,subtree:!0});function M(C){const b={};return C.integrity&&(b.integrity=C.integrity),C.referrerpolicy&&(b.referrerPolicy=C.referrerpolicy),C.crossorigin==="use-credentials"?b.credentials="include":C.crossorigin==="anonymous"?b.credentials="omit":b.credentials="same-origin",b}function H(C){if(C.ep)return;C.ep=!0;const b=M(C);fetch(C.href,b)}})();var yn={};(function(d){d.__type__="csv";var k=typeof jQuery<"u"&&jQuery.Deferred||typeof _<"u"&&_.Deferred||function(){var a,o,x=new Promise(function(w,L){a=w,o=L});return{resolve:a,reject:o,promise:function(){return x}}};d.fetch=function(a){var o=new k;if(a.file){var x=new FileReader,w=a.encoding||"UTF-8";x.onload=function(F){var B=d.extractFields(d.parse(F.target.result,a),a);B.useMemoryStore=!0,B.metadata={filename:a.file.name},o.resolve(B)},x.onerror=function(F){o.reject({error:{message:"Failed to load file. Code: "+F.target.error.code}})},x.readAsText(a.file,w)}else if(a.data){var L=d.extractFields(d.parse(a.data,a),a);L.useMemoryStore=!0,o.resolve(L)}else if(a.url){var z=window.fetch||function(F){var B=jQuery.get(F),N={then:function(G){return B.done(G),N},catch:function(G){return B.fail(G),N}};return N};z(a.url).then(function(F){return F.text?F.text():F}).then(function(F){var B=d.extractFields(d.parse(F,a),a);B.useMemoryStore=!0,o.resolve(B)}).catch(function(F,B){o.reject({error:{message:"Failed to load file. "+F.statusText+". Code: "+F.status,request:F}})})}return o.promise()},d.extractFields=function(a,o){return o.noHeaderRow!==!0&&a.length>0?{fields:a[0],records:a.slice(1)}:{records:a}},d.normalizeDialectOptions=function(a){var o={delimiter:",",doublequote:!0,lineterminator:`
`,quotechar:'"',skipinitialspace:!0,skipinitialrows:0};for(var x in a)x==="trim"?o.skipinitialspace=a.trim:o[x.toLowerCase()]=a[x];return o},d.parse=function(a,o){(!o||o&&!o.lineterminator)&&(a=d.normalizeLineTerminator(a,o));var x=d.normalizeDialectOptions(o);a=f(a,x.lineterminator);var w="",L=!1,z=!1,F="",B=[],N=[],G,K;for(K=function(U){return z!==!0&&(U===""?U=null:x.skipinitialspace===!0&&(U=b(U)),M.test(U)?U=parseInt(U,10):H.test(U)&&(U=parseFloat(U,10))),U},G=0;G<a.length;G+=1)w=a.charAt(G),L===!1&&(w===x.delimiter||w===x.lineterminator)?(F=K(F),B.push(F),w===x.lineterminator&&(N.push(B),B=[]),F="",z=!1):w!==x.quotechar?F+=w:L?a.charAt(G+1)===x.quotechar?(F+=x.quotechar,G+=1):L=!1:(L=!0,z=!0);return F=K(F),B.push(F),N.push(B),x.skipinitialrows&&(N=N.slice(x.skipinitialrows)),N},d.normalizeLineTerminator=function(a,o){return o=o||{},o.lineterminator?a:a.replace(/(\r\n|\n|\r)/gm,`
`)},d.objectToArray=function(a){for(var o=[],x=[],w=[],L=0;L<a.fields.length;L++){var z=a.fields[L].id;w.push(z);var F=a.fields[L].label?a.fields[L].label:z;x.push(F)}o.push(x);for(var L=0;L<a.records.length;L++){for(var B=[],N=a.records[L],G=0;G<w.length;G++)B.push(N[w[G]]);o.push(B)}return o},d.serialize=function(a,o){var x=null;a instanceof Array?x=a:x=d.objectToArray(a);var w=d.normalizeDialectOptions(o),L="",z="",F="",B="",N,G,K;for(K=function(U){return U===null?U="":typeof U=="string"&&C.test(U)?(w.doublequote&&(U=U.replace(/"/g,'""')),U=w.quotechar+U+w.quotechar):typeof U=="number"&&(U=U.toString(10)),U},N=0;N<x.length;N+=1)for(L=x[N],G=0;G<L.length;G+=1)z=K(L[G]),G===L.length-1?(F+=z,B+=F+w.lineterminator,F=""):F+=z+w.delimiter,z="";return B};var M=/^\d+$/,H=/^\d*\.\d+$|^\d+\.\d*$/,C=/^\s|\s$|,|"|\n/,b=function(){return String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^\s*/,"").replace(/\s*$/,"")}}();function f(a,o){return a.charAt(a.length-o.length)!==o?a:a.substring(0,a.length-o.length)}})(yn);function Bn(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var bn={exports:{}};(function(d,k){(function(M,H){d.exports=H()})(window,function(){return function(M){var H={};function C(b){if(H[b])return H[b].exports;var f=H[b]={i:b,l:!1,exports:{}};return M[b].call(f.exports,f,f.exports,C),f.l=!0,f.exports}return C.m=M,C.c=H,C.d=function(b,f,a){C.o(b,f)||Object.defineProperty(b,f,{enumerable:!0,get:a})},C.r=function(b){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(b,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(b,"__esModule",{value:!0})},C.t=function(b,f){if(1&f&&(b=C(b)),8&f||4&f&&typeof b=="object"&&b&&b.__esModule)return b;var a=Object.create(null);if(C.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:b}),2&f&&typeof b!="string")for(var o in b)C.d(a,o,function(x){return b[x]}.bind(null,o));return a},C.n=function(b){var f=b&&b.__esModule?function(){return b.default}:function(){return b};return C.d(f,"a",f),f},C.o=function(b,f){return Object.prototype.hasOwnProperty.call(b,f)},C.p="",C(C.s=1)}([function(M,H,C){var b,f;b=[C(2)],(f=function(a){function o(e){if(o.is(e,"function"))return x?e():a.on("raphael.DOMload",e);if(o.is(e,u))return o._engine.create[U](o,e.splice(0,3+o.is(e[0],c))).add(e);var t=Array.prototype.slice.call(arguments,0);if(o.is(t[t.length-1],"function")){var i=t.pop();return x?i.call(o._engine.create[U](o,t)):a.on("raphael.DOMload",function(){i.call(o._engine.create[U](o,t))})}return o._engine.create[U](o,arguments)}o.version="2.3.0",o.eve=a;var x,w,L=/[, ]+/,z={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},F=/\{(\d+)\}/g,B="hasOwnProperty",N={doc:document,win:window},G={was:Object.prototype[B].call(N.win,"Raphael"),is:N.win.Raphael},K=function(){this.ca=this.customAttributes={}},U="apply",X="concat",ae="ontouchstart"in window||window.TouchEvent||window.DocumentTouch&&document instanceof DocumentTouch,de="",ve=" ",$=String,Q="split",W="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[Q](ve),I={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},ie=$.prototype.toLowerCase,re=Math,ge=re.max,xe=re.min,Y=re.abs,fe=re.pow,pe=re.PI,c="number",u="array",p=Object.prototype.toString,n=(o._ISURL=/^url\(['"]?(.+?)['"]?\)$/i,/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i),r={NaN:1,Infinity:1,"-Infinity":1},s=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,h=re.round,m=parseFloat,v=parseInt,A=$.prototype.toUpperCase,D=o._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0,class:""},T=o._availableAnimAttrs={blur:c,"clip-rect":"csv",cx:c,cy:c,fill:"colour","fill-opacity":c,"font-size":c,height:c,opacity:c,path:"path",r:c,rx:c,ry:c,stroke:"colour","stroke-opacity":c,"stroke-width":c,transform:"transform",width:c,x:c,y:c},V=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,j={hs:1,rg:1},oe=/,?([achlmqrstvxz]),?/gi,be=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,we=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,ye=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/gi,Ae=(o._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,{}),Ee=function(e,t){return m(e)-m(t)},_e=function(e){return e},ke=o._rectPath=function(e,t,i,l,g){return g?[["M",e+g,t],["l",i-2*g,0],["a",g,g,0,0,1,g,g],["l",0,l-2*g],["a",g,g,0,0,1,-g,g],["l",2*g-i,0],["a",g,g,0,0,1,-g,-g],["l",0,2*g-l],["a",g,g,0,0,1,g,-g],["z"]]:[["M",e,t],["l",i,0],["l",0,l],["l",-i,0],["z"]]},Be=function(e,t,i,l){return l==null&&(l=i),[["M",e,t],["m",0,-l],["a",i,l,0,1,1,0,2*l],["a",i,l,0,1,1,0,-2*l],["z"]]},Me=o._getPath={path:function(e){return e.attr("path")},circle:function(e){var t=e.attrs;return Be(t.cx,t.cy,t.r)},ellipse:function(e){var t=e.attrs;return Be(t.cx,t.cy,t.rx,t.ry)},rect:function(e){var t=e.attrs;return ke(t.x,t.y,t.width,t.height,t.r)},image:function(e){var t=e.attrs;return ke(t.x,t.y,t.width,t.height)},text:function(e){var t=e._getBBox();return ke(t.x,t.y,t.width,t.height)},set:function(e){var t=e._getBBox();return ke(t.x,t.y,t.width,t.height)}},De=o.mapPath=function(e,t){if(!t)return e;var i,l,g,S,P,E,R;for(g=0,P=(e=At(e)).length;g<P;g++)for(S=1,E=(R=e[g]).length;S<E;S+=2)i=t.x(R[S],R[S+1]),l=t.y(R[S],R[S+1]),R[S]=i,R[S+1]=l;return e};if(o._g=N,o.type=N.win.SVGAngle||N.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML",o.type=="VML"){var Te,Fe=N.doc.createElement("div");if(Fe.innerHTML='<v:shape adj="1"/>',(Te=Fe.firstChild).style.behavior="url(#default#VML)",!Te||typeof Te.adj!="object")return o.type=de;Fe=null}function qe(e){if(typeof e=="function"||Object(e)!==e)return e;var t=new e.constructor;for(var i in e)e[B](i)&&(t[i]=qe(e[i]));return t}o.svg=!(o.vml=o.type=="VML"),o._Paper=K,o.fn=w=K.prototype=o.prototype,o._id=0,o.is=function(e,t){return(t=ie.call(t))=="finite"?!r[B](+e):t=="array"?e instanceof Array:t=="null"&&e===null||t==typeof e&&e!==null||t=="object"&&e===Object(e)||t=="array"&&Array.isArray&&Array.isArray(e)||p.call(e).slice(8,-1).toLowerCase()==t},o.angle=function(e,t,i,l,g,S){if(g==null){var P=e-i,E=t-l;return P||E?(180+180*re.atan2(-E,-P)/pe+360)%360:0}return o.angle(e,t,g,S)-o.angle(i,l,g,S)},o.rad=function(e){return e%360*pe/180},o.deg=function(e){return Math.round(180*e/pe%360*1e3)/1e3},o.snapTo=function(e,t,i){if(i=o.is(i,"finite")?i:10,o.is(e,u)){for(var l=e.length;l--;)if(Y(e[l]-t)<=i)return e[l]}else{var g=t%(e=+e);if(g<i)return t-g;if(g>e-i)return t-g+e}return t};var Ye,Ct;o.createUUID=(Ye=/[xy]/g,Ct=function(e){var t=16*re.random()|0;return(e=="x"?t:3&t|8).toString(16)},function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(Ye,Ct).toUpperCase()}),o.setWindow=function(e){a("raphael.setWindow",o,N.win,e),N.win=e,N.doc=N.win.document,o._engine.initWin&&o._engine.initWin(N.win)};var Qe=function(e){if(o.vml){var t,i=/^\s+|\s+$/g;try{var l=new ActiveXObject("htmlfile");l.write("<body>"),l.close(),t=l.body}catch{t=createPopup().document.body}var g=t.createTextRange();Qe=ze(function(P){try{t.style.color=$(P).replace(i,de);var E=g.queryCommandValue("ForeColor");return"#"+("000000"+(E=(255&E)<<16|65280&E|(16711680&E)>>>16).toString(16)).slice(-6)}catch{return"none"}})}else{var S=N.doc.createElement("i");S.title="Rapha\xEBl Colour Picker",S.style.display="none",N.doc.body.appendChild(S),Qe=ze(function(P){return S.style.color=P,N.doc.defaultView.getComputedStyle(S,de).getPropertyValue("color")})}return Qe(e)},ot=function(){return"hsb("+[this.h,this.s,this.b]+")"},lt=function(){return"hsl("+[this.h,this.s,this.l]+")"},kt=function(){return this.hex},ct=function(e,t,i){if(t==null&&o.is(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(i=e.b,t=e.g,e=e.r),t==null&&o.is(e,"string")){var l=o.getRGB(e);e=l.r,t=l.g,i=l.b}return(e>1||t>1||i>1)&&(e/=255,t/=255,i/=255),[e,t,i]},Bt=function(e,t,i,l){var g={r:e*=255,g:t*=255,b:i*=255,hex:o.rgb(e,t,i),toString:kt};return o.is(l,"finite")&&(g.opacity=l),g};function ze(e,t,i){return function l(){var g=Array.prototype.slice.call(arguments,0),S=g.join("\u2400"),P=l.cache=l.cache||{},E=l.count=l.count||[];return P[B](S)?(function(R,O){for(var Z=0,le=R.length;Z<le;Z++)if(R[Z]===O)return R.push(R.splice(Z,1)[0])}(E,S),i?i(P[S]):P[S]):(E.length>=1e3&&delete P[E.shift()],E.push(S),P[S]=e[U](t,g),i?i(P[S]):P[S])}}o.color=function(e){var t;return o.is(e,"object")&&"h"in e&&"s"in e&&"b"in e?(t=o.hsb2rgb(e),e.r=t.r,e.g=t.g,e.b=t.b,e.hex=t.hex):o.is(e,"object")&&"h"in e&&"s"in e&&"l"in e?(t=o.hsl2rgb(e),e.r=t.r,e.g=t.g,e.b=t.b,e.hex=t.hex):(o.is(e,"string")&&(e=o.getRGB(e)),o.is(e,"object")&&"r"in e&&"g"in e&&"b"in e?(t=o.rgb2hsl(e),e.h=t.h,e.s=t.s,e.l=t.l,t=o.rgb2hsb(e),e.v=t.b):(e={hex:"none"}).r=e.g=e.b=e.h=e.s=e.v=e.l=-1),e.toString=kt,e},o.hsb2rgb=function(e,t,i,l){var g,S,P,E,R;return this.is(e,"object")&&"h"in e&&"s"in e&&"b"in e&&(i=e.b,t=e.s,l=e.o,e=e.h),E=(R=i*t)*(1-Y((e=(e*=360)%360/60)%2-1)),g=S=P=i-R,Bt(g+=[R,E,0,0,E,R][e=~~e],S+=[E,R,R,E,0,0][e],P+=[0,0,E,R,R,E][e],l)},o.hsl2rgb=function(e,t,i,l){var g,S,P,E,R;return this.is(e,"object")&&"h"in e&&"s"in e&&"l"in e&&(i=e.l,t=e.s,e=e.h),(e>1||t>1||i>1)&&(e/=360,t/=100,i/=100),E=(R=2*t*(i<.5?i:1-i))*(1-Y((e=(e*=360)%360/60)%2-1)),g=S=P=i-R/2,Bt(g+=[R,E,0,0,E,R][e=~~e],S+=[E,R,R,E,0,0][e],P+=[0,0,E,R,R,E][e],l)},o.rgb2hsb=function(e,t,i){var l,g;return e=(i=ct(e,t,i))[0],t=i[1],i=i[2],{h:(((g=(l=ge(e,t,i))-xe(e,t,i))==0?null:l==e?(t-i)/g:l==t?(i-e)/g+2:(e-t)/g+4)+360)%6*60/360,s:g==0?0:g/l,b:l,toString:ot}},o.rgb2hsl=function(e,t,i){var l,g,S,P;return e=(i=ct(e,t,i))[0],t=i[1],i=i[2],l=((g=ge(e,t,i))+(S=xe(e,t,i)))/2,{h:(((P=g-S)==0?null:g==e?(t-i)/P:g==t?(i-e)/P+2:(e-t)/P+4)+360)%6*60/360,s:P==0?0:l<.5?P/(2*l):P/(2-2*l),l,toString:lt}},o._path2string=function(){return this.join(",").replace(oe,"$1")},o._preload=function(e,t){var i=N.doc.createElement("img");i.style.cssText="position:absolute;left:-9999em;top:-9999em",i.onload=function(){t.call(this),this.onload=null,N.doc.body.removeChild(this)},i.onerror=function(){N.doc.body.removeChild(this)},N.doc.body.appendChild(i),i.src=e};function Ke(){return this.hex}function ut(e,t){for(var i=[],l=0,g=e.length;g-2*!t>l;l+=2){var S=[{x:+e[l-2],y:+e[l-1]},{x:+e[l],y:+e[l+1]},{x:+e[l+2],y:+e[l+3]},{x:+e[l+4],y:+e[l+5]}];t?l?g-4==l?S[3]={x:+e[0],y:+e[1]}:g-2==l&&(S[2]={x:+e[0],y:+e[1]},S[3]={x:+e[2],y:+e[3]}):S[0]={x:+e[g-2],y:+e[g-1]}:g-4==l?S[3]=S[2]:l||(S[0]={x:+e[l],y:+e[l+1]}),i.push(["C",(-S[0].x+6*S[1].x+S[2].x)/6,(-S[0].y+6*S[1].y+S[2].y)/6,(S[1].x+6*S[2].x-S[3].x)/6,(S[1].y+6*S[2].y-S[3].y)/6,S[2].x,S[2].y])}return i}o.getRGB=ze(function(e){if(!e||(e=$(e)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Ke};if(e=="none")return{r:-1,g:-1,b:-1,hex:"none",toString:Ke};!j[B](e.toLowerCase().substring(0,2))&&e.charAt()!="#"&&(e=Qe(e));var t,i,l,g,S,P,E=e.match(n);return E?(E[2]&&(l=v(E[2].substring(5),16),i=v(E[2].substring(3,5),16),t=v(E[2].substring(1,3),16)),E[3]&&(l=v((S=E[3].charAt(3))+S,16),i=v((S=E[3].charAt(2))+S,16),t=v((S=E[3].charAt(1))+S,16)),E[4]&&(P=E[4][Q](V),t=m(P[0]),P[0].slice(-1)=="%"&&(t*=2.55),i=m(P[1]),P[1].slice(-1)=="%"&&(i*=2.55),l=m(P[2]),P[2].slice(-1)=="%"&&(l*=2.55),E[1].toLowerCase().slice(0,4)=="rgba"&&(g=m(P[3])),P[3]&&P[3].slice(-1)=="%"&&(g/=100)),E[5]?(P=E[5][Q](V),t=m(P[0]),P[0].slice(-1)=="%"&&(t*=2.55),i=m(P[1]),P[1].slice(-1)=="%"&&(i*=2.55),l=m(P[2]),P[2].slice(-1)=="%"&&(l*=2.55),(P[0].slice(-3)=="deg"||P[0].slice(-1)=="\xB0")&&(t/=360),E[1].toLowerCase().slice(0,4)=="hsba"&&(g=m(P[3])),P[3]&&P[3].slice(-1)=="%"&&(g/=100),o.hsb2rgb(t,i,l,g)):E[6]?(P=E[6][Q](V),t=m(P[0]),P[0].slice(-1)=="%"&&(t*=2.55),i=m(P[1]),P[1].slice(-1)=="%"&&(i*=2.55),l=m(P[2]),P[2].slice(-1)=="%"&&(l*=2.55),(P[0].slice(-3)=="deg"||P[0].slice(-1)=="\xB0")&&(t/=360),E[1].toLowerCase().slice(0,4)=="hsla"&&(g=m(P[3])),P[3]&&P[3].slice(-1)=="%"&&(g/=100),o.hsl2rgb(t,i,l,g)):((E={r:t,g:i,b:l,toString:Ke}).hex="#"+(16777216|l|i<<8|t<<16).toString(16).slice(1),o.is(g,"finite")&&(E.opacity=g),E)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Ke}},o),o.hsb=ze(function(e,t,i){return o.hsb2rgb(e,t,i).hex}),o.hsl=ze(function(e,t,i){return o.hsl2rgb(e,t,i).hex}),o.rgb=ze(function(e,t,i){function l(g){return g+.5|0}return"#"+(16777216|l(i)|l(t)<<8|l(e)<<16).toString(16).slice(1)}),o.getColor=function(e){var t=this.getColor.start=this.getColor.start||{h:0,s:1,b:e||.75},i=this.hsb2rgb(t.h,t.s,t.b);return t.h+=.075,t.h>1&&(t.h=0,t.s-=.2,t.s<=0&&(this.getColor.start={h:0,s:1,b:t.b})),i.hex},o.getColor.reset=function(){delete this.start},o.parsePathString=function(e){if(!e)return null;var t=Ue(e);if(t.arr)return He(t.arr);var i={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},l=[];return o.is(e,u)&&o.is(e[0],u)&&(l=He(e)),l.length||$(e).replace(be,function(g,S,P){var E=[],R=S.toLowerCase();if(P.replace(ye,function(O,Z){Z&&E.push(+Z)}),R=="m"&&E.length>2&&(l.push([S][X](E.splice(0,2))),R="l",S=S=="m"?"l":"L"),R=="r")l.push([S][X](E));else for(;E.length>=i[R]&&(l.push([S][X](E.splice(0,i[R]))),i[R]););}),l.toString=o._path2string,t.arr=He(l),l},o.parseTransformString=ze(function(e){if(!e)return null;var t=[];return o.is(e,u)&&o.is(e[0],u)&&(t=He(e)),t.length||$(e).replace(we,function(i,l,g){var S=[];ie.call(l),g.replace(ye,function(P,E){E&&S.push(+E)}),t.push([l][X](S))}),t.toString=o._path2string,t},this,function(e){if(!e)return e;for(var t=[],i=0;i<e.length;i++){for(var l=[],g=0;g<e[i].length;g++)l.push(e[i][g]);t.push(l)}return t});var Ue=function(e){var t=Ue.ps=Ue.ps||{};return t[e]?t[e].sleep=100:t[e]={sleep:100},setTimeout(function(){for(var i in t)t[B](i)&&i!=e&&(t[i].sleep--,!t[i].sleep&&delete t[i])}),t[e]};function ht(e,t,i,l,g){return e*(e*(-3*t+9*i-9*l+3*g)+6*t-12*i+6*l)-3*t+3*i}function Ge(e,t,i,l,g,S,P,E,R){R==null&&(R=1);for(var O=(R=R>1?1:R<0?0:R)/2,Z=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],le=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],te=0,J=0;J<12;J++){var ne=O*Z[J]+O,ce=ht(ne,e,i,g,P),se=ht(ne,t,l,S,E),ee=ce*ce+se*se;te+=le[J]*re.sqrt(ee)}return O*te}function _t(e,t,i,l,g,S,P,E){if(!(ge(e,i)<xe(g,P)||xe(e,i)>ge(g,P)||ge(t,l)<xe(S,E)||xe(t,l)>ge(S,E))){var R=(e-i)*(S-E)-(t-l)*(g-P);if(R){var O=((e*l-t*i)*(g-P)-(e-i)*(g*E-S*P))/R,Z=((e*l-t*i)*(S-E)-(t-l)*(g*E-S*P))/R,le=+O.toFixed(2),te=+Z.toFixed(2);if(!(le<+xe(e,i).toFixed(2)||le>+ge(e,i).toFixed(2)||le<+xe(g,P).toFixed(2)||le>+ge(g,P).toFixed(2)||te<+xe(t,l).toFixed(2)||te>+ge(t,l).toFixed(2)||te<+xe(S,E).toFixed(2)||te>+ge(S,E).toFixed(2)))return{x:O,y:Z}}}}function dt(e,t,i){var l=o.bezierBBox(e),g=o.bezierBBox(t);if(!o.isBBoxIntersect(l,g))return i?0:[];for(var S=Ge.apply(0,e),P=Ge.apply(0,t),E=ge(~~(S/5),1),R=ge(~~(P/5),1),O=[],Z=[],le={},te=i?0:[],J=0;J<E+1;J++){var ne=o.findDotsAtSegment.apply(o,e.concat(J/E));O.push({x:ne.x,y:ne.y,t:J/E})}for(J=0;J<R+1;J++)ne=o.findDotsAtSegment.apply(o,t.concat(J/R)),Z.push({x:ne.x,y:ne.y,t:J/R});for(J=0;J<E;J++)for(var ce=0;ce<R;ce++){var se=O[J],ee=O[J+1],Ce=Z[ce],ue=Z[ce+1],me=Y(ee.x-se.x)<.001?"y":"x",he=Y(ue.x-Ce.x)<.001?"y":"x",Pe=_t(se.x,se.y,ee.x,ee.y,Ce.x,Ce.y,ue.x,ue.y);if(Pe){if(le[Pe.x.toFixed(4)]==Pe.y.toFixed(4))continue;le[Pe.x.toFixed(4)]=Pe.y.toFixed(4);var Se=se.t+Y((Pe[me]-se[me])/(ee[me]-se[me]))*(ee.t-se.t),Le=Ce.t+Y((Pe[he]-Ce[he])/(ue[he]-Ce[he]))*(ue.t-Ce.t);Se>=0&&Se<=1.001&&Le>=0&&Le<=1.001&&(i?te++:te.push({x:Pe.x,y:Pe.y,t1:xe(Se,1),t2:xe(Le,1)}))}}return te}function St(e,t,i){e=o._path2curve(e),t=o._path2curve(t);for(var l,g,S,P,E,R,O,Z,le,te,J=i?0:[],ne=0,ce=e.length;ne<ce;ne++){var se=e[ne];if(se[0]=="M")l=E=se[1],g=R=se[2];else{se[0]=="C"?(le=[l,g].concat(se.slice(1)),l=le[6],g=le[7]):(le=[l,g,l,g,E,R,E,R],l=E,g=R);for(var ee=0,Ce=t.length;ee<Ce;ee++){var ue=t[ee];if(ue[0]=="M")S=O=ue[1],P=Z=ue[2];else{ue[0]=="C"?(te=[S,P].concat(ue.slice(1)),S=te[6],P=te[7]):(te=[S,P,S,P,O,Z,O,Z],S=O,P=Z);var me=dt(le,te,i);if(i)J+=me;else{for(var he=0,Pe=me.length;he<Pe;he++)me[he].segment1=ne,me[he].segment2=ee,me[he].bez1=le,me[he].bez2=te;J=J.concat(me)}}}}}return J}o.findDotsAtSegment=function(e,t,i,l,g,S,P,E,R){var O=1-R,Z=fe(O,3),le=fe(O,2),te=R*R,J=te*R,ne=Z*e+3*le*R*i+3*O*R*R*g+J*P,ce=Z*t+3*le*R*l+3*O*R*R*S+J*E,se=e+2*R*(i-e)+te*(g-2*i+e),ee=t+2*R*(l-t)+te*(S-2*l+t),Ce=i+2*R*(g-i)+te*(P-2*g+i),ue=l+2*R*(S-l)+te*(E-2*S+l),me=O*e+R*i,he=O*t+R*l,Pe=O*g+R*P,Se=O*S+R*E,Le=90-180*re.atan2(se-Ce,ee-ue)/pe;return(se>Ce||ee<ue)&&(Le+=180),{x:ne,y:ce,m:{x:se,y:ee},n:{x:Ce,y:ue},start:{x:me,y:he},end:{x:Pe,y:Se},alpha:Le}},o.bezierBBox=function(e,t,i,l,g,S,P,E){o.is(e,"array")||(e=[e,t,i,l,g,S,P,E]);var R=Nt.apply(null,e);return{x:R.min.x,y:R.min.y,x2:R.max.x,y2:R.max.y,width:R.max.x-R.min.x,height:R.max.y-R.min.y}},o.isPointInsideBBox=function(e,t,i){return t>=e.x&&t<=e.x2&&i>=e.y&&i<=e.y2},o.isBBoxIntersect=function(e,t){var i=o.isPointInsideBBox;return i(t,e.x,e.y)||i(t,e.x2,e.y)||i(t,e.x,e.y2)||i(t,e.x2,e.y2)||i(e,t.x,t.y)||i(e,t.x2,t.y)||i(e,t.x,t.y2)||i(e,t.x2,t.y2)||(e.x<t.x2&&e.x>t.x||t.x<e.x2&&t.x>e.x)&&(e.y<t.y2&&e.y>t.y||t.y<e.y2&&t.y>e.y)},o.pathIntersection=function(e,t){return St(e,t)},o.pathIntersectionNumber=function(e,t){return St(e,t,1)},o.isPointInsidePath=function(e,t,i){var l=o.pathBBox(e);return o.isPointInsideBBox(l,t,i)&&St(e,[["M",t,i],["H",l.x2+10]],1)%2==1},o._removedFactory=function(e){return function(){a("raphael.log",null,"Rapha\xEBl: you are calling to method \u201C"+e+"\u201D of removed object",e)}};var Je=o.pathBBox=function(e){var t=Ue(e);if(t.bbox)return qe(t.bbox);if(!e)return{x:0,y:0,width:0,height:0,x2:0,y2:0};for(var i,l=0,g=0,S=[],P=[],E=0,R=(e=At(e)).length;E<R;E++)if((i=e[E])[0]=="M")l=i[1],g=i[2],S.push(l),P.push(g);else{var O=Nt(l,g,i[1],i[2],i[3],i[4],i[5],i[6]);S=S[X](O.min.x,O.max.x),P=P[X](O.min.y,O.max.y),l=i[5],g=i[6]}var Z=xe[U](0,S),le=xe[U](0,P),te=ge[U](0,S),J=ge[U](0,P),ne=te-Z,ce=J-le,se={x:Z,y:le,x2:te,y2:J,width:ne,height:ce,cx:Z+ne/2,cy:le+ce/2};return t.bbox=qe(se),se},He=function(e){var t=qe(e);return t.toString=o._path2string,t},Qt=o._pathToRelative=function(e){var t=Ue(e);if(t.rel)return He(t.rel);o.is(e,u)&&o.is(e&&e[0],u)||(e=o.parsePathString(e));var i=[],l=0,g=0,S=0,P=0,E=0;e[0][0]=="M"&&(S=l=e[0][1],P=g=e[0][2],E++,i.push(["M",l,g]));for(var R=E,O=e.length;R<O;R++){var Z=i[R]=[],le=e[R];if(le[0]!=ie.call(le[0]))switch(Z[0]=ie.call(le[0]),Z[0]){case"a":Z[1]=le[1],Z[2]=le[2],Z[3]=le[3],Z[4]=le[4],Z[5]=le[5],Z[6]=+(le[6]-l).toFixed(3),Z[7]=+(le[7]-g).toFixed(3);break;case"v":Z[1]=+(le[1]-g).toFixed(3);break;case"m":S=le[1],P=le[2];default:for(var te=1,J=le.length;te<J;te++)Z[te]=+(le[te]-(te%2?l:g)).toFixed(3)}else{Z=i[R]=[],le[0]=="m"&&(S=le[1]+l,P=le[2]+g);for(var ne=0,ce=le.length;ne<ce;ne++)i[R][ne]=le[ne]}var se=i[R].length;switch(i[R][0]){case"z":l=S,g=P;break;case"h":l+=+i[R][se-1];break;case"v":g+=+i[R][se-1];break;default:l+=+i[R][se-2],g+=+i[R][se-1]}}return i.toString=o._path2string,t.rel=He(i),i},ft=o._pathToAbsolute=function(e){var t=Ue(e);if(t.abs)return He(t.abs);if(o.is(e,u)&&o.is(e&&e[0],u)||(e=o.parsePathString(e)),!e||!e.length)return[["M",0,0]];var i=[],l=0,g=0,S=0,P=0,E=0;e[0][0]=="M"&&(S=l=+e[0][1],P=g=+e[0][2],E++,i[0]=["M",l,g]);for(var R,O,Z=e.length==3&&e[0][0]=="M"&&e[1][0].toUpperCase()=="R"&&e[2][0].toUpperCase()=="Z",le=E,te=e.length;le<te;le++){if(i.push(R=[]),(O=e[le])[0]!=A.call(O[0]))switch(R[0]=A.call(O[0]),R[0]){case"A":R[1]=O[1],R[2]=O[2],R[3]=O[3],R[4]=O[4],R[5]=O[5],R[6]=+(O[6]+l),R[7]=+(O[7]+g);break;case"V":R[1]=+O[1]+g;break;case"H":R[1]=+O[1]+l;break;case"R":for(var J=[l,g][X](O.slice(1)),ne=2,ce=J.length;ne<ce;ne++)J[ne]=+J[ne]+l,J[++ne]=+J[ne]+g;i.pop(),i=i[X](ut(J,Z));break;case"M":S=+O[1]+l,P=+O[2]+g;default:for(ne=1,ce=O.length;ne<ce;ne++)R[ne]=+O[ne]+(ne%2?l:g)}else if(O[0]=="R")J=[l,g][X](O.slice(1)),i.pop(),i=i[X](ut(J,Z)),R=["R"][X](O.slice(-2));else for(var se=0,ee=O.length;se<ee;se++)R[se]=O[se];switch(R[0]){case"Z":l=S,g=P;break;case"H":l=R[1];break;case"V":g=R[1];break;case"M":S=R[R.length-2],P=R[R.length-1];default:l=R[R.length-2],g=R[R.length-1]}}return i.toString=o._path2string,t.abs=He(i),i},pt=function(e,t,i,l){return[e,t,i,l,i,l]},Ze=function(e,t,i,l,g,S){return[1/3*e+2/3*i,1/3*t+2/3*l,1/3*g+2/3*i,1/3*S+2/3*l,g,S]},Tt=function(e,t,i,l,g,S,P,E,R,O){var Z,le=120*pe/180,te=pe/180*(+g||0),J=[],ne=ze(function(mn,gn,Ft){return{x:mn*re.cos(Ft)-gn*re.sin(Ft),y:mn*re.sin(Ft)+gn*re.cos(Ft)}});if(O)Se=O[0],Le=O[1],he=O[2],Pe=O[3];else{e=(Z=ne(e,t,-te)).x,t=Z.y,E=(Z=ne(E,R,-te)).x,R=Z.y;var ce=(e-E)/2,se=(t-R)/2,ee=ce*ce/(i*i)+se*se/(l*l);ee>1&&(i*=ee=re.sqrt(ee),l*=ee);var Ce=i*i,ue=l*l,me=(S==P?-1:1)*re.sqrt(Y((Ce*ue-Ce*se*se-ue*ce*ce)/(Ce*se*se+ue*ce*ce))),he=me*i*se/l+(e+E)/2,Pe=me*-l*ce/i+(t+R)/2,Se=re.asin(((t-Pe)/l).toFixed(9)),Le=re.asin(((R-Pe)/l).toFixed(9));(Se=e<he?pe-Se:Se)<0&&(Se=2*pe+Se),(Le=E<he?pe-Le:Le)<0&&(Le=2*pe+Le),P&&Se>Le&&(Se-=2*pe),!P&&Le>Se&&(Le-=2*pe)}var gt=Le-Se;if(Y(gt)>le){var Lt=Le,$e=E,Xe=R;Le=Se+le*(P&&Le>Se?1:-1),E=he+i*re.cos(Le),R=Pe+l*re.sin(Le),J=Tt(E,R,i,l,g,0,P,$e,Xe,[Le,Lt,he,Pe])}gt=Le-Se;var xt=re.cos(Se),vt=re.sin(Se),Dt=re.cos(Le),je=re.sin(Le),at=re.tan(gt/4),It=4/3*i*at,un=4/3*l*at,hn=[e,t],yt=[e+It*vt,t-un*xt],dn=[E+It*je,R-un*Dt],fn=[E,R];if(yt[0]=2*hn[0]-yt[0],yt[1]=2*hn[1]-yt[1],O)return[yt,dn,fn][X](J);for(var pn=[],tt=0,Rn=(J=[yt,dn,fn][X](J).join()[Q](",")).length;tt<Rn;tt++)pn[tt]=tt%2?ne(J[tt-1],J[tt],te).y:ne(J[tt],J[tt+1],te).x;return pn},nt=function(e,t,i,l,g,S,P,E,R){var O=1-R;return{x:fe(O,3)*e+3*fe(O,2)*R*i+3*O*R*R*g+fe(R,3)*P,y:fe(O,3)*t+3*fe(O,2)*R*l+3*O*R*R*S+fe(R,3)*E}},Nt=ze(function(e,t,i,l,g,S,P,E){var R,O=g-2*i+e-(P-2*g+i),Z=2*(i-e)-2*(g-i),le=e-i,te=(-Z+re.sqrt(Z*Z-4*O*le))/2/O,J=(-Z-re.sqrt(Z*Z-4*O*le))/2/O,ne=[t,E],ce=[e,P];return Y(te)>"1e12"&&(te=.5),Y(J)>"1e12"&&(J=.5),te>0&&te<1&&(R=nt(e,t,i,l,g,S,P,E,te),ce.push(R.x),ne.push(R.y)),J>0&&J<1&&(R=nt(e,t,i,l,g,S,P,E,J),ce.push(R.x),ne.push(R.y)),O=S-2*l+t-(E-2*S+l),le=t-l,te=(-(Z=2*(l-t)-2*(S-l))+re.sqrt(Z*Z-4*O*le))/2/O,J=(-Z-re.sqrt(Z*Z-4*O*le))/2/O,Y(te)>"1e12"&&(te=.5),Y(J)>"1e12"&&(J=.5),te>0&&te<1&&(R=nt(e,t,i,l,g,S,P,E,te),ce.push(R.x),ne.push(R.y)),J>0&&J<1&&(R=nt(e,t,i,l,g,S,P,E,J),ce.push(R.x),ne.push(R.y)),{min:{x:xe[U](0,ce),y:xe[U](0,ne)},max:{x:ge[U](0,ce),y:ge[U](0,ne)}}}),At=o._path2curve=ze(function(e,t){var i=!t&&Ue(e);if(!t&&i.curve)return He(i.curve);for(var l=ft(e),g=t&&ft(t),S={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},P={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},E=function(me,he,Pe){var Se,Le;if(!me)return["C",he.x,he.y,he.x,he.y,he.x,he.y];switch(!(me[0]in{T:1,Q:1})&&(he.qx=he.qy=null),me[0]){case"M":he.X=me[1],he.Y=me[2];break;case"A":me=["C"][X](Tt[U](0,[he.x,he.y][X](me.slice(1))));break;case"S":Pe=="C"||Pe=="S"?(Se=2*he.x-he.bx,Le=2*he.y-he.by):(Se=he.x,Le=he.y),me=["C",Se,Le][X](me.slice(1));break;case"T":Pe=="Q"||Pe=="T"?(he.qx=2*he.x-he.qx,he.qy=2*he.y-he.qy):(he.qx=he.x,he.qy=he.y),me=["C"][X](Ze(he.x,he.y,he.qx,he.qy,me[1],me[2]));break;case"Q":he.qx=me[1],he.qy=me[2],me=["C"][X](Ze(he.x,he.y,me[1],me[2],me[3],me[4]));break;case"L":me=["C"][X](pt(he.x,he.y,me[1],me[2]));break;case"H":me=["C"][X](pt(he.x,he.y,me[1],he.y));break;case"V":me=["C"][X](pt(he.x,he.y,he.x,me[1]));break;case"Z":me=["C"][X](pt(he.x,he.y,he.X,he.Y))}return me},R=function(me,he){if(me[he].length>7){me[he].shift();for(var Pe=me[he];Pe.length;)Z[he]="A",g&&(le[he]="A"),me.splice(he++,0,["C"][X](Pe.splice(0,6)));me.splice(he,1),ce=ge(l.length,g&&g.length||0)}},O=function(me,he,Pe,Se,Le){me&&he&&me[Le][0]=="M"&&he[Le][0]!="M"&&(he.splice(Le,0,["M",Se.x,Se.y]),Pe.bx=0,Pe.by=0,Pe.x=me[Le][1],Pe.y=me[Le][2],ce=ge(l.length,g&&g.length||0))},Z=[],le=[],te="",J="",ne=0,ce=ge(l.length,g&&g.length||0);ne<ce;ne++){l[ne]&&(te=l[ne][0]),te!="C"&&(Z[ne]=te,ne&&(J=Z[ne-1])),l[ne]=E(l[ne],S,J),Z[ne]!="A"&&te=="C"&&(Z[ne]="C"),R(l,ne),g&&(g[ne]&&(te=g[ne][0]),te!="C"&&(le[ne]=te,ne&&(J=le[ne-1])),g[ne]=E(g[ne],P,J),le[ne]!="A"&&te=="C"&&(le[ne]="C"),R(g,ne)),O(l,g,S,P,ne),O(g,l,P,S,ne);var se=l[ne],ee=g&&g[ne],Ce=se.length,ue=g&&ee.length;S.x=se[Ce-2],S.y=se[Ce-1],S.bx=m(se[Ce-4])||S.x,S.by=m(se[Ce-3])||S.y,P.bx=g&&(m(ee[ue-4])||P.x),P.by=g&&(m(ee[ue-3])||P.y),P.x=g&&ee[ue-2],P.y=g&&ee[ue-1]}return g||(i.curve=He(l)),g?[l,g]:l},null,He),Mt=(o._parseDots=ze(function(e){for(var t=[],i=0,l=e.length;i<l;i++){var g={},S=e[i].match(/^([^:]*):?([\d\.]*)/);if(g.color=o.getRGB(S[1]),g.color.error)return null;g.opacity=g.color.opacity,g.color=g.color.hex,S[2]&&(g.offset=S[2]+"%"),t.push(g)}for(i=1,l=t.length-1;i<l;i++)if(!t[i].offset){for(var P=m(t[i-1].offset||0),E=0,R=i+1;R<l;R++)if(t[R].offset){E=t[R].offset;break}E||(E=100,R=l);for(var O=((E=m(E))-P)/(R-i+1);i<R;i++)P+=O,t[i].offset=P+"%"}return t}),o._tear=function(e,t){e==t.top&&(t.top=e.prev),e==t.bottom&&(t.bottom=e.next),e.next&&(e.next.prev=e.prev),e.prev&&(e.prev.next=e.next)}),Cn=(o._tofront=function(e,t){t.top!==e&&(Mt(e,t),e.next=null,e.prev=t.top,t.top.next=e,t.top=e)},o._toback=function(e,t){t.bottom!==e&&(Mt(e,t),e.next=t.bottom,e.prev=null,t.bottom.prev=e,t.bottom=e)},o._insertafter=function(e,t,i){Mt(e,i),t==i.top&&(i.top=e),t.next&&(t.next.prev=e),e.next=t.next,e.prev=t,t.next=e},o._insertbefore=function(e,t,i){Mt(e,i),t==i.bottom&&(i.bottom=e),t.prev&&(t.prev.next=e),e.prev=t.prev,t.prev=e,e.next=t},o.toMatrix=function(e,t){var i=Je(e),l={_:{transform:de},getBBox:function(){return i}};return Kt(l,t),l.matrix}),Kt=(o.transformPath=function(e,t){return De(e,Cn(e,t))},o._extractTransform=function(e,t){if(t==null)return e._.transform;t=$(t).replace(/\.{3}|\u2026/g,e._.transform||de);var i,l,g=o.parseTransformString(t),S=0,P=1,E=1,R=e._,O=new rt;if(R.transform=g||[],g)for(var Z=0,le=g.length;Z<le;Z++){var te,J,ne,ce,se,ee=g[Z],Ce=ee.length,ue=$(ee[0]).toLowerCase(),me=ee[0]!=ue,he=me?O.invert():0;ue=="t"&&Ce==3?me?(te=he.x(0,0),J=he.y(0,0),ne=he.x(ee[1],ee[2]),ce=he.y(ee[1],ee[2]),O.translate(ne-te,ce-J)):O.translate(ee[1],ee[2]):ue=="r"?Ce==2?(se=se||e.getBBox(1),O.rotate(ee[1],se.x+se.width/2,se.y+se.height/2),S+=ee[1]):Ce==4&&(me?(ne=he.x(ee[2],ee[3]),ce=he.y(ee[2],ee[3]),O.rotate(ee[1],ne,ce)):O.rotate(ee[1],ee[2],ee[3]),S+=ee[1]):ue=="s"?Ce==2||Ce==3?(se=se||e.getBBox(1),O.scale(ee[1],ee[Ce-1],se.x+se.width/2,se.y+se.height/2),P*=ee[1],E*=ee[Ce-1]):Ce==5&&(me?(ne=he.x(ee[3],ee[4]),ce=he.y(ee[3],ee[4]),O.scale(ee[1],ee[2],ne,ce)):O.scale(ee[1],ee[2],ee[3],ee[4]),P*=ee[1],E*=ee[2]):ue=="m"&&Ce==7&&O.add(ee[1],ee[2],ee[3],ee[4],ee[5],ee[6]),R.dirtyT=1,e.matrix=O}e.matrix=O,R.sx=P,R.sy=E,R.deg=S,R.dx=i=O.e,R.dy=l=O.f,P==1&&E==1&&!S&&R.bbox?(R.bbox.x+=+i,R.bbox.y+=+l):R.dirtyT=1}),Jt=function(e){var t=e[0];switch(t.toLowerCase()){case"t":return[t,0,0];case"m":return[t,1,0,0,1,0,0];case"r":return e.length==4?[t,0,e[2],e[3]]:[t,0];case"s":return e.length==5?[t,1,1,e[3],e[4]]:e.length==3?[t,1,1]:[t,1]}},kn=o._equaliseTransform=function(e,t){t=$(t).replace(/\.{3}|\u2026/g,e),e=o.parseTransformString(e)||[],t=o.parseTransformString(t)||[];for(var i,l,g,S,P=ge(e.length,t.length),E=[],R=[],O=0;O<P;O++){if(g=e[O]||Jt(t[O]),S=t[O]||Jt(g),g[0]!=S[0]||g[0].toLowerCase()=="r"&&(g[2]!=S[2]||g[3]!=S[3])||g[0].toLowerCase()=="s"&&(g[3]!=S[3]||g[4]!=S[4]))return;for(E[O]=[],R[O]=[],i=0,l=ge(g.length,S.length);i<l;i++)i in g&&(E[O][i]=g[i]),i in S&&(R[O][i]=S[i])}return{from:E,to:R}};function rt(e,t,i,l,g,S){e!=null?(this.a=+e,this.b=+t,this.c=+i,this.d=+l,this.e=+g,this.f=+S):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}o._getContainer=function(e,t,i,l){var g;if((g=l!=null||o.is(e,"object")?e:N.doc.getElementById(e))!=null)return g.tagName?t==null?{container:g,width:g.style.pixelWidth||g.offsetWidth,height:g.style.pixelHeight||g.offsetHeight}:{container:g,width:t,height:i}:{container:1,x:e,y:t,width:i,height:l}},o.pathToRelative=Qt,o._engine={},o.path2curve=At,o.matrix=function(e,t,i,l,g,S){return new rt(e,t,i,l,g,S)},function(e){function t(l){return l[0]*l[0]+l[1]*l[1]}function i(l){var g=re.sqrt(t(l));l[0]&&(l[0]/=g),l[1]&&(l[1]/=g)}e.add=function(l,g,S,P,E,R){var O,Z,le,te,J=[[],[],[]],ne=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],ce=[[l,S,E],[g,P,R],[0,0,1]];for(l&&l instanceof rt&&(ce=[[l.a,l.c,l.e],[l.b,l.d,l.f],[0,0,1]]),O=0;O<3;O++)for(Z=0;Z<3;Z++){for(te=0,le=0;le<3;le++)te+=ne[O][le]*ce[le][Z];J[O][Z]=te}this.a=J[0][0],this.b=J[1][0],this.c=J[0][1],this.d=J[1][1],this.e=J[0][2],this.f=J[1][2]},e.invert=function(){var l=this,g=l.a*l.d-l.b*l.c;return new rt(l.d/g,-l.b/g,-l.c/g,l.a/g,(l.c*l.f-l.d*l.e)/g,(l.b*l.e-l.a*l.f)/g)},e.clone=function(){return new rt(this.a,this.b,this.c,this.d,this.e,this.f)},e.translate=function(l,g){this.add(1,0,0,1,l,g)},e.scale=function(l,g,S,P){g==null&&(g=l),(S||P)&&this.add(1,0,0,1,S,P),this.add(l,0,0,g,0,0),(S||P)&&this.add(1,0,0,1,-S,-P)},e.rotate=function(l,g,S){l=o.rad(l),g=g||0,S=S||0;var P=+re.cos(l).toFixed(9),E=+re.sin(l).toFixed(9);this.add(P,E,-E,P,g,S),this.add(1,0,0,1,-g,-S)},e.x=function(l,g){return l*this.a+g*this.c+this.e},e.y=function(l,g){return l*this.b+g*this.d+this.f},e.get=function(l){return+this[$.fromCharCode(97+l)].toFixed(4)},e.toString=function(){return o.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},e.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},e.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},e.split=function(){var l={};l.dx=this.e,l.dy=this.f;var g=[[this.a,this.c],[this.b,this.d]];l.scalex=re.sqrt(t(g[0])),i(g[0]),l.shear=g[0][0]*g[1][0]+g[0][1]*g[1][1],g[1]=[g[1][0]-g[0][0]*l.shear,g[1][1]-g[0][1]*l.shear],l.scaley=re.sqrt(t(g[1])),i(g[1]),l.shear/=l.scaley;var S=-g[0][1],P=g[1][1];return P<0?(l.rotate=o.deg(re.acos(P)),S<0&&(l.rotate=360-l.rotate)):l.rotate=o.deg(re.asin(S)),l.isSimple=!(+l.shear.toFixed(9)||l.scalex.toFixed(9)!=l.scaley.toFixed(9)&&l.rotate),l.isSuperSimple=!+l.shear.toFixed(9)&&l.scalex.toFixed(9)==l.scaley.toFixed(9)&&!l.rotate,l.noRotation=!+l.shear.toFixed(9)&&!l.rotate,l},e.toTransformString=function(l){var g=l||this[Q]();return g.isSimple?(g.scalex=+g.scalex.toFixed(4),g.scaley=+g.scaley.toFixed(4),g.rotate=+g.rotate.toFixed(4),(g.dx||g.dy?"t"+[g.dx,g.dy]:de)+(g.scalex!=1||g.scaley!=1?"s"+[g.scalex,g.scaley,0,0]:de)+(g.rotate?"r"+[g.rotate,0,0]:de)):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(rt.prototype);for(var _n=function(){this.returnValue=!1},Sn=function(){return this.originalEvent.preventDefault()},An=function(){this.cancelBubble=!0},En=function(){return this.originalEvent.stopPropagation()},Zt=function(e){var t=N.doc.documentElement.scrollTop||N.doc.body.scrollTop,i=N.doc.documentElement.scrollLeft||N.doc.body.scrollLeft;return{x:e.clientX+i,y:e.clientY+t}},Pn=N.doc.addEventListener?function(e,t,i,l){var g=function(P){var E=Zt(P);return i.call(l,P,E.x,E.y)};if(e.addEventListener(t,g,!1),ae&&I[t]){var S=function(P){for(var E=Zt(P),R=P,O=0,Z=P.targetTouches&&P.targetTouches.length;O<Z;O++)if(P.targetTouches[O].target==e){(P=P.targetTouches[O]).originalEvent=R,P.preventDefault=Sn,P.stopPropagation=En;break}return i.call(l,P,E.x,E.y)};e.addEventListener(I[t],S,!1)}return function(){return e.removeEventListener(t,g,!1),ae&&I[t]&&e.removeEventListener(I[t],S,!1),!0}}:N.doc.attachEvent?function(e,t,i,l){var g=function(S){S=S||N.win.event;var P=N.doc.documentElement.scrollTop||N.doc.body.scrollTop,E=N.doc.documentElement.scrollLeft||N.doc.body.scrollLeft,R=S.clientX+E,O=S.clientY+P;return S.preventDefault=S.preventDefault||_n,S.stopPropagation=S.stopPropagation||An,i.call(l,S,R,O)};return e.attachEvent("on"+t,g),function(){return e.detachEvent("on"+t,g),!0}}:void 0,et=[],Ot=function(e){for(var t,i=e.clientX,l=e.clientY,g=N.doc.documentElement.scrollTop||N.doc.body.scrollTop,S=N.doc.documentElement.scrollLeft||N.doc.body.scrollLeft,P=et.length;P--;){if(t=et[P],ae&&e.touches){for(var E,R=e.touches.length;R--;)if((E=e.touches[R]).identifier==t.el._drag.id){i=E.clientX,l=E.clientY,(e.originalEvent?e.originalEvent:e).preventDefault();break}}else e.preventDefault();var O,Z=t.el.node,le=Z.nextSibling,te=Z.parentNode,J=Z.style.display;N.win.opera&&te.removeChild(Z),Z.style.display="none",O=t.el.paper.getElementByPoint(i,l),Z.style.display=J,N.win.opera&&(le?te.insertBefore(Z,le):te.appendChild(Z)),O&&a("raphael.drag.over."+t.el.id,t.el,O),i+=S,l+=g,a("raphael.drag.move."+t.el.id,t.move_scope||t.el,i-t.el._drag.x,l-t.el._drag.y,i,l,e)}},Ht=function(e){o.unmousemove(Ot).unmouseup(Ht);for(var t,i=et.length;i--;)(t=et[i]).el._drag={},a("raphael.drag.end."+t.el.id,t.end_scope||t.start_scope||t.move_scope||t.el,e);et=[]},Ne=o.el={},en=W.length;en--;)(function(e){o[e]=Ne[e]=function(t,i){return o.is(t,"function")&&(this.events=this.events||[],this.events.push({name:e,f:t,unbind:Pn(this.shape||this.node||N.doc,e,t,i||this)})),this},o["un"+e]=Ne["un"+e]=function(t){for(var i=this.events||[],l=i.length;l--;)i[l].name!=e||!o.is(t,"undefined")&&i[l].f!=t||(i[l].unbind(),i.splice(l,1),!i.length&&delete this.events);return this}})(W[en]);Ne.data=function(e,t){var i=Ae[this.id]=Ae[this.id]||{};if(arguments.length==0)return i;if(arguments.length==1){if(o.is(e,"object")){for(var l in e)e[B](l)&&this.data(l,e[l]);return this}return a("raphael.data.get."+this.id,this,i[e],e),i[e]}return i[e]=t,a("raphael.data.set."+this.id,this,t,e),this},Ne.removeData=function(e){return e==null?delete Ae[this.id]:Ae[this.id]&&delete Ae[this.id][e],this},Ne.getData=function(){return qe(Ae[this.id]||{})},Ne.hover=function(e,t,i,l){return this.mouseover(e,i).mouseout(t,l||i)},Ne.unhover=function(e,t){return this.unmouseover(e).unmouseout(t)};var mt=[];Ne.drag=function(e,t,i,l,g,S){function P(E){(E.originalEvent||E).preventDefault();var R=E.clientX,O=E.clientY,Z=N.doc.documentElement.scrollTop||N.doc.body.scrollTop,le=N.doc.documentElement.scrollLeft||N.doc.body.scrollLeft;if(this._drag.id=E.identifier,ae&&E.touches){for(var te,J=E.touches.length;J--;)if(te=E.touches[J],this._drag.id=te.identifier,te.identifier==this._drag.id){R=te.clientX,O=te.clientY;break}}this._drag.x=R+le,this._drag.y=O+Z,!et.length&&o.mousemove(Ot).mouseup(Ht),et.push({el:this,move_scope:l,start_scope:g,end_scope:S}),t&&a.on("raphael.drag.start."+this.id,t),e&&a.on("raphael.drag.move."+this.id,e),i&&a.on("raphael.drag.end."+this.id,i),a("raphael.drag.start."+this.id,g||l||this,this._drag.x,this._drag.y,E)}return this._drag={},mt.push({el:this,start:P}),this.mousedown(P),this},Ne.onDragOver=function(e){e?a.on("raphael.drag.over."+this.id,e):a.unbind("raphael.drag.over."+this.id)},Ne.undrag=function(){for(var e=mt.length;e--;)mt[e].el==this&&(this.unmousedown(mt[e].start),mt.splice(e,1),a.unbind("raphael.drag.*."+this.id));!mt.length&&o.unmousemove(Ot).unmouseup(Ht),et=[]},w.circle=function(e,t,i){var l=o._engine.circle(this,e||0,t||0,i||0);return this.__set__&&this.__set__.push(l),l},w.rect=function(e,t,i,l,g){var S=o._engine.rect(this,e||0,t||0,i||0,l||0,g||0);return this.__set__&&this.__set__.push(S),S},w.ellipse=function(e,t,i,l){var g=o._engine.ellipse(this,e||0,t||0,i||0,l||0);return this.__set__&&this.__set__.push(g),g},w.path=function(e){e&&!o.is(e,"string")&&!o.is(e[0],u)&&(e+=de);var t=o._engine.path(o.format[U](o,arguments),this);return this.__set__&&this.__set__.push(t),t},w.image=function(e,t,i,l,g){var S=o._engine.image(this,e||"about:blank",t||0,i||0,l||0,g||0);return this.__set__&&this.__set__.push(S),S},w.text=function(e,t,i){var l=o._engine.text(this,e||0,t||0,$(i));return this.__set__&&this.__set__.push(l),l},w.set=function(e){!o.is(e,"array")&&(e=Array.prototype.splice.call(arguments,0,arguments.length));var t=new Pt(e);return this.__set__&&this.__set__.push(t),t.paper=this,t.type="set",t},w.setStart=function(e){this.__set__=e||this.set()},w.setFinish=function(e){var t=this.__set__;return delete this.__set__,t},w.getSize=function(){var e=this.canvas.parentNode;return{width:e.offsetWidth,height:e.offsetHeight}},w.setSize=function(e,t){return o._engine.setSize.call(this,e,t)},w.setViewBox=function(e,t,i,l,g){return o._engine.setViewBox.call(this,e,t,i,l,g)},w.top=w.bottom=null,w.raphael=o;function tn(){return this.x+ve+this.y+ve+this.width+" \xD7 "+this.height}w.getElementByPoint=function(e,t){var i,l,g,S,P,E,R,O=this.canvas,Z=N.doc.elementFromPoint(e,t);if(N.win.opera&&Z.tagName=="svg"){var le=(l=(i=O).getBoundingClientRect(),g=i.ownerDocument,S=g.body,P=g.documentElement,E=P.clientTop||S.clientTop||0,R=P.clientLeft||S.clientLeft||0,{y:l.top+(N.win.pageYOffset||P.scrollTop||S.scrollTop)-E,x:l.left+(N.win.pageXOffset||P.scrollLeft||S.scrollLeft)-R}),te=O.createSVGRect();te.x=e-le.x,te.y=t-le.y,te.width=te.height=1;var J=O.getIntersectionList(te,null);J.length&&(Z=J[J.length-1])}if(!Z)return null;for(;Z.parentNode&&Z!=O.parentNode&&!Z.raphael;)Z=Z.parentNode;return Z==this.canvas.parentNode&&(Z=O),Z=Z&&Z.raphael?this.getById(Z.raphaelid):null},w.getElementsByBBox=function(e){var t=this.set();return this.forEach(function(i){o.isBBoxIntersect(i.getBBox(),e)&&t.push(i)}),t},w.getById=function(e){for(var t=this.bottom;t;){if(t.id==e)return t;t=t.next}return null},w.forEach=function(e,t){for(var i=this.bottom;i;){if(e.call(t,i)===!1)return this;i=i.next}return this},w.getElementsByPoint=function(e,t){var i=this.set();return this.forEach(function(l){l.isPointInside(e,t)&&i.push(l)}),i},Ne.isPointInside=function(e,t){var i=this.realPath=Me[this.type](this);return this.attr("transform")&&this.attr("transform").length&&(i=o.transformPath(i,this.attr("transform"))),o.isPointInsidePath(i,e,t)},Ne.getBBox=function(e){if(this.removed)return{};var t=this._;return e?(!t.dirty&&t.bboxwt||(this.realPath=Me[this.type](this),t.bboxwt=Je(this.realPath),t.bboxwt.toString=tn,t.dirty=0),t.bboxwt):((t.dirty||t.dirtyT||!t.bbox)&&(!t.dirty&&this.realPath||(t.bboxwt=0,this.realPath=Me[this.type](this)),t.bbox=Je(De(this.realPath,this.matrix)),t.bbox.toString=tn,t.dirty=t.dirtyT=0),t.bbox)},Ne.clone=function(){if(this.removed)return null;var e=this.paper[this.type]().attr(this.attr());return this.__set__&&this.__set__.push(e),e},Ne.glow=function(e){if(this.type=="text")return null;var t={width:((e=e||{}).width||10)+(+this.attr("stroke-width")||1),fill:e.fill||!1,opacity:e.opacity==null?.5:e.opacity,offsetx:e.offsetx||0,offsety:e.offsety||0,color:e.color||"#000"},i=t.width/2,l=this.paper,g=l.set(),S=this.realPath||Me[this.type](this);S=this.matrix?De(S,this.matrix):S;for(var P=1;P<i+1;P++)g.push(l.path(S).attr({stroke:t.color,fill:t.fill?t.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(t.width/i*P).toFixed(3),opacity:+(t.opacity/i).toFixed(3)}));return g.insertBefore(this).translate(t.offsetx,t.offsety)};var $t=function(e,t,i,l,g,S,P,E,R){return R==null?Ge(e,t,i,l,g,S,P,E):o.findDotsAtSegment(e,t,i,l,g,S,P,E,function(O,Z,le,te,J,ne,ce,se,ee){if(!(ee<0||Ge(O,Z,le,te,J,ne,ce,se)<ee)){var Ce,ue=.5,me=1-ue;for(Ce=Ge(O,Z,le,te,J,ne,ce,se,me);Y(Ce-ee)>.01;)Ce=Ge(O,Z,le,te,J,ne,ce,se,me+=(Ce<ee?1:-1)*(ue/=2));return me}}(e,t,i,l,g,S,P,E,R))},Vt=function(e,t){return function(i,l,g){for(var S,P,E,R,O,Z="",le={},te=0,J=0,ne=(i=At(i)).length;J<ne;J++){if((E=i[J])[0]=="M")S=+E[1],P=+E[2];else{if(te+(R=$t(S,P,E[1],E[2],E[3],E[4],E[5],E[6]))>l){if(t&&!le.start){if(Z+=["C"+(O=$t(S,P,E[1],E[2],E[3],E[4],E[5],E[6],l-te)).start.x,O.start.y,O.m.x,O.m.y,O.x,O.y],g)return Z;le.start=Z,Z=["M"+O.x,O.y+"C"+O.n.x,O.n.y,O.end.x,O.end.y,E[5],E[6]].join(),te+=R,S=+E[5],P=+E[6];continue}if(!e&&!t)return{x:(O=$t(S,P,E[1],E[2],E[3],E[4],E[5],E[6],l-te)).x,y:O.y,alpha:O.alpha}}te+=R,S=+E[5],P=+E[6]}Z+=E.shift()+E}return le.end=Z,(O=e?te:t?le:o.findDotsAtSegment(S,P,E[0],E[1],E[2],E[3],E[4],E[5],1)).alpha&&(O={x:O.x,y:O.y,alpha:O.alpha}),O}},nn=Vt(1),rn=Vt(),Ut=Vt(0,1);o.getTotalLength=nn,o.getPointAtLength=rn,o.getSubpath=function(e,t,i){if(this.getTotalLength(e)-i<1e-6)return Ut(e,t).end;var l=Ut(e,i,1);return t?Ut(l,t).end:l},Ne.getTotalLength=function(){var e=this.getPath();if(e)return this.node.getTotalLength?this.node.getTotalLength():nn(e)},Ne.getPointAtLength=function(e){var t=this.getPath();if(t)return rn(t,e)},Ne.getPath=function(){var e,t=o._getPath[this.type];if(this.type!="text"&&this.type!="set")return t&&(e=t(this)),e},Ne.getSubpath=function(e,t){var i=this.getPath();if(i)return o.getSubpath(i,e,t)};var Ve=o.easing_formulas={linear:function(e){return e},"<":function(e){return fe(e,1.7)},">":function(e){return fe(e,.48)},"<>":function(e){var t=.48-e/1.04,i=re.sqrt(.1734+t*t),l=i-t,g=-i-t,S=fe(Y(l),1/3)*(l<0?-1:1)+fe(Y(g),1/3)*(g<0?-1:1)+.5;return 3*(1-S)*S*S+S*S*S},backIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},backOut:function(e){var t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},elastic:function(e){return e==!!e?e:fe(2,-10*e)*re.sin(2*pe*(e-.075)/.3)+1},bounce:function(e){var t=7.5625,i=2.75;return e<1/i?t*e*e:e<2/i?t*(e-=1.5/i)*e+.75:e<2.5/i?t*(e-=2.25/i)*e+.9375:t*(e-=2.625/i)*e+.984375}};Ve.easeIn=Ve["ease-in"]=Ve["<"],Ve.easeOut=Ve["ease-out"]=Ve[">"],Ve.easeInOut=Ve["ease-in-out"]=Ve["<>"],Ve["back-in"]=Ve.backIn,Ve["back-out"]=Ve.backOut;var Re=[],sn=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,16)},Gt=function(){for(var e=+new Date,t=0;t<Re.length;t++){var i=Re[t];if(!i.el.removed&&!i.paused){var l,g,S=e-i.start,P=i.ms,E=i.easing,R=i.from,O=i.diff,Z=i.to,le=(i.t,i.el),te={},J={};if(i.initstatus?(S=(i.initstatus*i.anim.top-i.prev)/(i.percent-i.prev)*P,i.status=i.initstatus,delete i.initstatus,i.stop&&Re.splice(t--,1)):i.status=(i.prev+(i.percent-i.prev)*(S/P))/i.anim.top,!(S<0))if(S<P){var ne=E(S/P);for(var ce in R)if(R[B](ce)){switch(T[ce]){case c:l=+R[ce]+ne*P*O[ce];break;case"colour":l="rgb("+[Xt(h(R[ce].r+ne*P*O[ce].r)),Xt(h(R[ce].g+ne*P*O[ce].g)),Xt(h(R[ce].b+ne*P*O[ce].b))].join(",")+")";break;case"path":l=[];for(var se=0,ee=R[ce].length;se<ee;se++){l[se]=[R[ce][se][0]];for(var Ce=1,ue=R[ce][se].length;Ce<ue;Ce++)l[se][Ce]=+R[ce][se][Ce]+ne*P*O[ce][se][Ce];l[se]=l[se].join(ve)}l=l.join(ve);break;case"transform":if(O[ce].real)for(l=[],se=0,ee=R[ce].length;se<ee;se++)for(l[se]=[R[ce][se][0]],Ce=1,ue=R[ce][se].length;Ce<ue;Ce++)l[se][Ce]=R[ce][se][Ce]+ne*P*O[ce][se][Ce];else{var me=function(Pe){return+R[ce][Pe]+ne*P*O[ce][Pe]};l=[["m",me(0),me(1),me(2),me(3),me(4),me(5)]]}break;case"csv":if(ce=="clip-rect")for(l=[],se=4;se--;)l[se]=+R[ce][se]+ne*P*O[ce][se];break;default:var he=[][X](R[ce]);for(l=[],se=le.paper.customAttributes[ce].length;se--;)l[se]=+he[se]+ne*P*O[ce][se]}te[ce]=l}le.attr(te),function(Pe,Se,Le){setTimeout(function(){a("raphael.anim.frame."+Pe,Se,Le)})}(le.id,le,i.anim)}else{if(function(Pe,Se,Le){setTimeout(function(){a("raphael.anim.frame."+Se.id,Se,Le),a("raphael.anim.finish."+Se.id,Se,Le),o.is(Pe,"function")&&Pe.call(Se)})}(i.callback,le,i.anim),le.attr(Z),Re.splice(t--,1),i.repeat>1&&!i.next){for(g in Z)Z[B](g)&&(J[g]=i.totalOrigin[g]);i.el.attr(J),Et(i.anim,i.el,i.anim.percents[0],null,i.totalOrigin,i.repeat-1)}i.next&&!i.stop&&Et(i.anim,i.el,i.next,null,i.totalOrigin,i.repeat)}}}Re.length&&sn(Gt)},Xt=function(e){return e>255?255:e<0?0:e};function Ln(e,t,i,l,g,S){var P=3*t,E=3*(l-t)-P,R=1-P-E,O=3*i,Z=3*(g-i)-O,le=1-O-Z;function te(J){return((R*J+E)*J+P)*J}return function(J,ne){var ce=function(se,ee){var Ce,ue,me,he,Pe,Se;for(me=se,Se=0;Se<8;Se++){if(he=te(me)-se,Y(he)<ee)return me;if(Y(Pe=(3*R*me+2*E)*me+P)<1e-6)break;me-=he/Pe}if(ue=1,(me=se)<(Ce=0))return Ce;if(me>ue)return ue;for(;Ce<ue;){if(he=te(me),Y(he-se)<ee)return me;se>he?Ce=me:ue=me,me=(ue-Ce)/2+Ce}return me}(J,ne);return((le*ce+Z)*ce+O)*ce}(e,1/(200*S))}function We(e,t){var i=[],l={};if(this.ms=t,this.times=1,e){for(var g in e)e[B](g)&&(l[m(g)]=e[g],i.push(m(g)));i.sort(Ee)}this.anim=l,this.top=i[i.length-1],this.percents=i}function Et(e,t,i,l,g,S){i=m(i);var P,E,R,O,Z,le,te=e.ms,J={},ne={},ce={};if(l)for(ee=0,Ce=Re.length;ee<Ce;ee++){var se=Re[ee];if(se.el.id==t.id&&se.anim==e){se.percent!=i?(Re.splice(ee,1),R=1):E=se,t.attr(se.totalOrigin);break}}else l=+ne;for(var ee=0,Ce=e.percents.length;ee<Ce;ee++){if(e.percents[ee]==i||e.percents[ee]>l*e.top){i=e.percents[ee],Z=e.percents[ee-1]||0,te=te/e.top*(i-Z),O=e.percents[ee+1],P=e.anim[i];break}l&&t.attr(e.anim[e.percents[ee]])}if(P){if(E)E.initstatus=l,E.start=new Date-E.ms*l;else{for(var ue in P)if(P[B](ue)&&(T[B](ue)||t.paper.customAttributes[B](ue)))switch(J[ue]=t.attr(ue),J[ue]==null&&(J[ue]=D[ue]),ne[ue]=P[ue],T[ue]){case c:ce[ue]=(ne[ue]-J[ue])/te;break;case"colour":J[ue]=o.getRGB(J[ue]);var me=o.getRGB(ne[ue]);ce[ue]={r:(me.r-J[ue].r)/te,g:(me.g-J[ue].g)/te,b:(me.b-J[ue].b)/te};break;case"path":var he=At(J[ue],ne[ue]),Pe=he[1];for(J[ue]=he[0],ce[ue]=[],ee=0,Ce=J[ue].length;ee<Ce;ee++){ce[ue][ee]=[0];for(var Se=1,Le=J[ue][ee].length;Se<Le;Se++)ce[ue][ee][Se]=(Pe[ee][Se]-J[ue][ee][Se])/te}break;case"transform":var gt=t._,Lt=kn(gt[ue],ne[ue]);if(Lt)for(J[ue]=Lt.from,ne[ue]=Lt.to,ce[ue]=[],ce[ue].real=!0,ee=0,Ce=J[ue].length;ee<Ce;ee++)for(ce[ue][ee]=[J[ue][ee][0]],Se=1,Le=J[ue][ee].length;Se<Le;Se++)ce[ue][ee][Se]=(ne[ue][ee][Se]-J[ue][ee][Se])/te;else{var $e=t.matrix||new rt,Xe={_:{transform:gt.transform},getBBox:function(){return t.getBBox(1)}};J[ue]=[$e.a,$e.b,$e.c,$e.d,$e.e,$e.f],Kt(Xe,ne[ue]),ne[ue]=Xe._.transform,ce[ue]=[(Xe.matrix.a-$e.a)/te,(Xe.matrix.b-$e.b)/te,(Xe.matrix.c-$e.c)/te,(Xe.matrix.d-$e.d)/te,(Xe.matrix.e-$e.e)/te,(Xe.matrix.f-$e.f)/te]}break;case"csv":var xt=$(P[ue])[Q](L),vt=$(J[ue])[Q](L);if(ue=="clip-rect")for(J[ue]=vt,ce[ue]=[],ee=vt.length;ee--;)ce[ue][ee]=(xt[ee]-J[ue][ee])/te;ne[ue]=xt;break;default:for(xt=[][X](P[ue]),vt=[][X](J[ue]),ce[ue]=[],ee=t.paper.customAttributes[ue].length;ee--;)ce[ue][ee]=((xt[ee]||0)-(vt[ee]||0))/te}var Dt=P.easing,je=o.easing_formulas[Dt];if(!je)if((je=$(Dt).match(s))&&je.length==5){var at=je;je=function(It){return Ln(It,+at[1],+at[2],+at[3],+at[4],te)}}else je=_e;if(se={anim:e,percent:i,timestamp:le=P.start||e.start||+new Date,start:le+(e.del||0),status:0,initstatus:l||0,stop:!1,ms:te,easing:je,from:J,diff:ce,to:ne,el:t,callback:P.callback,prev:Z,next:O,repeat:S||e.times,origin:t.attr(),totalOrigin:g},Re.push(se),l&&!E&&!R&&(se.stop=!0,se.start=new Date-te*l,Re.length==1))return Gt();R&&(se.start=new Date-se.ms*l),Re.length==1&&sn(Gt)}a("raphael.anim.start."+t.id,t,e)}}function an(e){for(var t=0;t<Re.length;t++)Re[t].el.paper==e&&Re.splice(t--,1)}Ne.animateWith=function(e,t,i,l,g,S){if(this.removed)return S&&S.call(this),this;var P=i instanceof We?i:o.animation(i,l,g,S);Et(P,this,P.percents[0],null,this.attr());for(var E=0,R=Re.length;E<R;E++)if(Re[E].anim==t&&Re[E].el==e){Re[R-1].start=Re[E].start;break}return this},Ne.onAnimation=function(e){return e?a.on("raphael.anim.frame."+this.id,e):a.unbind("raphael.anim.frame."+this.id),this},We.prototype.delay=function(e){var t=new We(this.anim,this.ms);return t.times=this.times,t.del=+e||0,t},We.prototype.repeat=function(e){var t=new We(this.anim,this.ms);return t.del=this.del,t.times=re.floor(ge(e,0))||1,t},o.animation=function(e,t,i,l){if(e instanceof We)return e;!o.is(i,"function")&&i||(l=l||i||null,i=null),e=Object(e),t=+t||0;var g,S,P={};for(S in e)e[B](S)&&m(S)!=S&&m(S)+"%"!=S&&(g=!0,P[S]=e[S]);if(g)return i&&(P.easing=i),l&&(P.callback=l),new We({100:P},t);if(l){var E=0;for(var R in e){var O=v(R);e[B](R)&&O>E&&(E=O)}!e[E+="%"].callback&&(e[E].callback=l)}return new We(e,t)},Ne.animate=function(e,t,i,l){if(this.removed)return l&&l.call(this),this;var g=e instanceof We?e:o.animation(e,t,i,l);return Et(g,this,g.percents[0],null,this.attr()),this},Ne.setTime=function(e,t){return e&&t!=null&&this.status(e,xe(t,e.ms)/e.ms),this},Ne.status=function(e,t){var i,l,g=[],S=0;if(t!=null)return Et(e,this,-1,xe(t,1)),this;for(i=Re.length;S<i;S++)if((l=Re[S]).el.id==this.id&&(!e||l.anim==e)){if(e)return l.status;g.push({anim:l.anim,status:l.status})}return e?0:g},Ne.pause=function(e){for(var t=0;t<Re.length;t++)Re[t].el.id!=this.id||e&&Re[t].anim!=e||a("raphael.anim.pause."+this.id,this,Re[t].anim)!==!1&&(Re[t].paused=!0);return this},Ne.resume=function(e){for(var t=0;t<Re.length;t++)if(Re[t].el.id==this.id&&(!e||Re[t].anim==e)){var i=Re[t];a("raphael.anim.resume."+this.id,this,i.anim)!==!1&&(delete i.paused,this.status(i.anim,i.status))}return this},Ne.stop=function(e){for(var t=0;t<Re.length;t++)Re[t].el.id!=this.id||e&&Re[t].anim!=e||a("raphael.anim.stop."+this.id,this,Re[t].anim)!==!1&&Re.splice(t--,1);return this},a.on("raphael.remove",an),a.on("raphael.clear",an),Ne.toString=function(){return"Rapha\xEBl\u2019s object"};var on,ln,st,cn,Pt=function(e){if(this.items=[],this.length=0,this.type="set",e)for(var t=0,i=e.length;t<i;t++)!e[t]||e[t].constructor!=Ne.constructor&&e[t].constructor!=Pt||(this[this.items.length]=this.items[this.items.length]=e[t],this.length++)},Oe=Pt.prototype;for(var Wt in Oe.push=function(){for(var e,t,i=0,l=arguments.length;i<l;i++)!(e=arguments[i])||e.constructor!=Ne.constructor&&e.constructor!=Pt||(this[t=this.items.length]=this.items[t]=e,this.length++);return this},Oe.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},Oe.forEach=function(e,t){for(var i=0,l=this.items.length;i<l;i++)if(e.call(t,this.items[i],i)===!1)return this;return this},Ne)Ne[B](Wt)&&(Oe[Wt]=function(e){return function(){var t=arguments;return this.forEach(function(i){i[e][U](i,t)})}}(Wt));return Oe.attr=function(e,t){if(e&&o.is(e,u)&&o.is(e[0],"object"))for(var i=0,l=e.length;i<l;i++)this.items[i].attr(e[i]);else for(var g=0,S=this.items.length;g<S;g++)this.items[g].attr(e,t);return this},Oe.clear=function(){for(;this.length;)this.pop()},Oe.splice=function(e,t,i){e=e<0?ge(this.length+e,0):e,t=ge(0,xe(this.length-e,t));var l,g=[],S=[],P=[];for(l=2;l<arguments.length;l++)P.push(arguments[l]);for(l=0;l<t;l++)S.push(this[e+l]);for(;l<this.length-e;l++)g.push(this[e+l]);var E=P.length;for(l=0;l<E+g.length;l++)this.items[e+l]=this[e+l]=l<E?P[l]:g[l-E];for(l=this.items.length=this.length-=t-E;this[l];)delete this[l++];return new Pt(S)},Oe.exclude=function(e){for(var t=0,i=this.length;t<i;t++)if(this[t]==e)return this.splice(t,1),!0},Oe.animate=function(e,t,i,l){(o.is(i,"function")||!i)&&(l=i||null);var g,S,P=this.items.length,E=P,R=this;if(!P)return this;l&&(S=function(){!--P&&l.call(R)}),i=o.is(i,"string")?i:S;var O=o.animation(e,t,i,S);for(g=this.items[--E].animate(O);E--;)this.items[E]&&!this.items[E].removed&&this.items[E].animateWith(g,O,O),this.items[E]&&!this.items[E].removed||P--;return this},Oe.insertAfter=function(e){for(var t=this.items.length;t--;)this.items[t].insertAfter(e);return this},Oe.getBBox=function(){for(var e=[],t=[],i=[],l=[],g=this.items.length;g--;)if(!this.items[g].removed){var S=this.items[g].getBBox();e.push(S.x),t.push(S.y),i.push(S.x+S.width),l.push(S.y+S.height)}return{x:e=xe[U](0,e),y:t=xe[U](0,t),x2:i=ge[U](0,i),y2:l=ge[U](0,l),width:i-e,height:l-t}},Oe.clone=function(e){e=this.paper.set();for(var t=0,i=this.items.length;t<i;t++)e.push(this.items[t].clone());return e},Oe.toString=function(){return"Rapha\xEBl\u2018s set"},Oe.glow=function(e){var t=this.paper.set();return this.forEach(function(i,l){var g=i.glow(e);g!=null&&g.forEach(function(S,P){t.push(S)})}),t},Oe.isPointInside=function(e,t){var i=!1;return this.forEach(function(l){if(l.isPointInside(e,t))return i=!0,!1}),i},o.registerFont=function(e){if(!e.face)return e;this.fonts=this.fonts||{};var t={w:e.w,face:{},glyphs:{}},i=e.face["font-family"];for(var l in e.face)e.face[B](l)&&(t.face[l]=e.face[l]);if(this.fonts[i]?this.fonts[i].push(t):this.fonts[i]=[t],!e.svg){for(var g in t.face["units-per-em"]=v(e.face["units-per-em"],10),e.glyphs)if(e.glyphs[B](g)){var S=e.glyphs[g];if(t.glyphs[g]={w:S.w,k:{},d:S.d&&"M"+S.d.replace(/[mlcxtrv]/g,function(E){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[E]||"M"})+"z"},S.k)for(var P in S.k)S[B](P)&&(t.glyphs[g].k[P]=S.k[P])}}return e},w.getFont=function(e,t,i,l){if(l=l||"normal",i=i||"normal",t=+t||{normal:400,bold:700,lighter:300,bolder:800}[t]||400,o.fonts){var g,S=o.fonts[e];if(!S){var P=new RegExp("(^|\\s)"+e.replace(/[^\w\d\s+!~.:_-]/g,de)+"(\\s|$)","i");for(var E in o.fonts)if(o.fonts[B](E)&&P.test(E)){S=o.fonts[E];break}}if(S)for(var R=0,O=S.length;R<O&&((g=S[R]).face["font-weight"]!=t||g.face["font-style"]!=i&&g.face["font-style"]||g.face["font-stretch"]!=l);R++);return g}},w.print=function(e,t,i,l,g,S,P,E){S=S||"middle",P=ge(xe(P||0,1),-1),E=ge(xe(E||1,3),1);var R,O=$(i)[Q](de),Z=0,le=0,te=de;if(o.is(l,"string")&&(l=this.getFont(l)),l){R=(g||16)/l.face["units-per-em"];for(var J=l.face.bbox[Q](L),ne=+J[0],ce=J[3]-J[1],se=0,ee=+J[1]+(S=="baseline"?ce+ +l.face.descent:ce/2),Ce=0,ue=O.length;Ce<ue;Ce++){if(O[Ce]==`
`)Z=0,he=0,le=0,se+=ce*E;else{var me=le&&l.glyphs[O[Ce-1]]||{},he=l.glyphs[O[Ce]];Z+=le?(me.w||l.w)+(me.k&&me.k[O[Ce]]||0)+l.w*P:0,le=1}he&&he.d&&(te+=o.transformPath(he.d,["t",Z*R,se*R,"s",R,R,ne,ee,"t",(e-ne)/R,(t-ee)/R]))}}return this.path(te).attr({fill:"#000",stroke:"none"})},w.add=function(e){if(o.is(e,"array"))for(var t,i=this.set(),l=0,g=e.length;l<g;l++)t=e[l]||{},z[B](t.type)&&i.push(this[t.type]().attr(t));return i},o.format=function(e,t){var i=o.is(t,u)?[0][X](t):arguments;return e&&o.is(e,"string")&&i.length-1&&(e=e.replace(F,function(l,g){return i[++g]==null?de:i[g]})),e||de},o.fullfill=(on=/\{([^\}]+)\}/g,ln=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,function(e,t){return String(e).replace(on,function(i,l){return function(g,S,P){var E=P;return S.replace(ln,function(R,O,Z,le,te){O=O||le,E&&(O in E&&(E=E[O]),typeof E=="function"&&te&&(E=E()))}),E=(E==null||E==P?g:E)+""}(i,l,t)})}),o.ninja=function(){if(G.was)N.win.Raphael=G.is;else{window.Raphael=void 0;try{delete window.Raphael}catch{}}return o},o.st=Oe,a.on("raphael.DOMload",function(){x=!0}),(st=document).readyState==null&&st.addEventListener&&(st.addEventListener("DOMContentLoaded",cn=function(){st.removeEventListener("DOMContentLoaded",cn,!1),st.readyState="complete"},!1),st.readyState="loading"),function e(){/in/.test(st.readyState)?setTimeout(e,9):o.eve("raphael.DOMload")}(),o}.apply(H,b))===void 0||(M.exports=f)},function(M,H,C){var b,f;b=[C(0),C(3),C(4)],(f=function(a){return a}.apply(H,b))===void 0||(M.exports=f)},function(M,H,C){var b,f,a,o,x,w,L,z,F,B,N,G,K,U;o="hasOwnProperty",x=/[\.\/]/,w=/\s*,\s*/,L=function(X,ae){return X-ae},z={n:{}},F=function(){for(var X=0,ae=this.length;X<ae;X++)if(this[X]!==void 0)return this[X]},B=function(){for(var X=this.length;--X;)if(this[X]!==void 0)return this[X]},N=Object.prototype.toString,G=String,K=Array.isArray||function(X){return X instanceof Array||N.call(X)=="[object Array]"},(U=function(X,ae){var de,ve=a,$=Array.prototype.slice.call(arguments,2),Q=U.listeners(X),W=0,I=[],ie={},re=[],ge=f;re.firstDefined=F,re.lastDefined=B,f=X,a=0;for(var xe=0,Y=Q.length;xe<Y;xe++)"zIndex"in Q[xe]&&(I.push(Q[xe].zIndex),Q[xe].zIndex<0&&(ie[Q[xe].zIndex]=Q[xe]));for(I.sort(L);I[W]<0;)if(de=ie[I[W++]],re.push(de.apply(ae,$)),a)return a=ve,re;for(xe=0;xe<Y;xe++)if("zIndex"in(de=Q[xe]))if(de.zIndex==I[W]){if(re.push(de.apply(ae,$)),a)break;do if((de=ie[I[++W]])&&re.push(de.apply(ae,$)),a)break;while(de)}else ie[de.zIndex]=de;else if(re.push(de.apply(ae,$)),a)break;return a=ve,f=ge,re})._events=z,U.listeners=function(X){var ae,de,ve,$,Q,W,I,ie,re=K(X)?X:X.split(x),ge=z,xe=[ge],Y=[];for($=0,Q=re.length;$<Q;$++){for(ie=[],W=0,I=xe.length;W<I;W++)for(de=[(ge=xe[W].n)[re[$]],ge["*"]],ve=2;ve--;)(ae=de[ve])&&(ie.push(ae),Y=Y.concat(ae.f||[]));xe=ie}return Y},U.separator=function(X){X?(X="["+(X=G(X).replace(/(?=[\.\^\]\[\-])/g,"\\"))+"]",x=new RegExp(X)):x=/[\.\/]/},U.on=function(X,ae){if(typeof ae!="function")return function(){};for(var de=K(X)?K(X[0])?X:[X]:G(X).split(w),ve=0,$=de.length;ve<$;ve++)(function(Q){for(var W,I=K(Q)?Q:G(Q).split(x),ie=z,re=0,ge=I.length;re<ge;re++)ie=(ie=ie.n).hasOwnProperty(I[re])&&ie[I[re]]||(ie[I[re]]={n:{}});for(ie.f=ie.f||[],re=0,ge=ie.f.length;re<ge;re++)if(ie.f[re]==ae){W=!0;break}!W&&ie.f.push(ae)})(de[ve]);return function(Q){+Q==+Q&&(ae.zIndex=+Q)}},U.f=function(X){var ae=[].slice.call(arguments,1);return function(){U.apply(null,[X,null].concat(ae).concat([].slice.call(arguments,0)))}},U.stop=function(){a=1},U.nt=function(X){var ae=K(f)?f.join("."):f;return X?new RegExp("(?:\\.|\\/|^)"+X+"(?:\\.|\\/|$)").test(ae):ae},U.nts=function(){return K(f)?f:f.split(x)},U.off=U.unbind=function(X,ae){if(X){var de=K(X)?K(X[0])?X:[X]:G(X).split(w);if(de.length>1)for(var ve=0,$=de.length;ve<$;ve++)U.off(de[ve],ae);else{de=K(X)?X:G(X).split(x);var Q,W,I,ie,re,ge=[z];for(ve=0,$=de.length;ve<$;ve++)for(ie=0;ie<ge.length;ie+=I.length-2){if(I=[ie,1],Q=ge[ie].n,de[ve]!="*")Q[de[ve]]&&I.push(Q[de[ve]]);else for(W in Q)Q[o](W)&&I.push(Q[W]);ge.splice.apply(ge,I)}for(ve=0,$=ge.length;ve<$;ve++)for(Q=ge[ve];Q.n;){if(ae){if(Q.f){for(ie=0,re=Q.f.length;ie<re;ie++)if(Q.f[ie]==ae){Q.f.splice(ie,1);break}!Q.f.length&&delete Q.f}for(W in Q.n)if(Q.n[o](W)&&Q.n[W].f){var xe=Q.n[W].f;for(ie=0,re=xe.length;ie<re;ie++)if(xe[ie]==ae){xe.splice(ie,1);break}!xe.length&&delete Q.n[W].f}}else for(W in delete Q.f,Q.n)Q.n[o](W)&&Q.n[W].f&&delete Q.n[W].f;Q=Q.n}}}else U._events=z={n:{}}},U.once=function(X,ae){var de=function(){return U.off(X,de),ae.apply(this,arguments)};return U.on(X,de)},U.version="0.5.0",U.toString=function(){return"You are running Eve 0.5.0"},M.exports?M.exports=U:(b=function(){return U}.apply(H,[]))===void 0||(M.exports=b)},function(M,H,C){var b,f;b=[C(0)],(f=function(a){if(!a||a.svg){var o="hasOwnProperty",x=String,w=parseFloat,L=parseInt,z=Math,F=z.max,B=z.abs,N=z.pow,G=/[, ]+/,K=a.eve,U="",X=" ",ae="http://www.w3.org/1999/xlink",de={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},ve={};a.toString=function(){return`Your browser supports SVG.
You are running Rapha\xEBl `+this.version};var $=function(n,r){if(r)for(var s in typeof n=="string"&&(n=$(n)),r)r[o](s)&&(s.substring(0,6)=="xlink:"?n.setAttributeNS(ae,s.substring(6),x(r[s])):n.setAttribute(s,x(r[s])));else(n=a._g.doc.createElementNS("http://www.w3.org/2000/svg",n)).style&&(n.style.webkitTapHighlightColor="rgba(0,0,0,0)");return n},Q=function(n,r){var s="linear",h=n.id+r,m=.5,v=.5,A=n.node,D=n.paper,T=A.style,V=a._g.doc.getElementById(h);if(!V){if(r=(r=x(r).replace(a._radial_gradient,function(Ee,_e,ke){if(s="radial",_e&&ke){m=w(_e);var Be=2*((v=w(ke))>.5)-1;N(m-.5,2)+N(v-.5,2)>.25&&(v=z.sqrt(.25-N(m-.5,2))*Be+.5)&&v!=.5&&(v=v.toFixed(5)-1e-5*Be)}return U})).split(/\s*\-\s*/),s=="linear"){var j=r.shift();if(j=-w(j),isNaN(j))return null;var oe=[0,0,z.cos(a.rad(j)),z.sin(a.rad(j))],be=1/(F(B(oe[2]),B(oe[3]))||1);oe[2]*=be,oe[3]*=be,oe[2]<0&&(oe[0]=-oe[2],oe[2]=0),oe[3]<0&&(oe[1]=-oe[3],oe[3]=0)}var we=a._parseDots(r);if(!we)return null;if(h=h.replace(/[\(\)\s,\xb0#]/g,"_"),n.gradient&&h!=n.gradient.id&&(D.defs.removeChild(n.gradient),delete n.gradient),!n.gradient){V=$(s+"Gradient",{id:h}),n.gradient=V,$(V,s=="radial"?{fx:m,fy:v}:{x1:oe[0],y1:oe[1],x2:oe[2],y2:oe[3],gradientTransform:n.matrix.invert()}),D.defs.appendChild(V);for(var ye=0,Ae=we.length;ye<Ae;ye++)V.appendChild($("stop",{offset:we[ye].offset?we[ye].offset:ye?"100%":"0%","stop-color":we[ye].color||"#fff","stop-opacity":isFinite(we[ye].opacity)?we[ye].opacity:1}))}}return $(A,{fill:W(h),opacity:1,"fill-opacity":1}),T.fill=U,T.opacity=1,T.fillOpacity=1,1},W=function(n){if((r=document.documentMode)&&(r===9||r===10))return"url('#"+n+"')";var r,s=document.location;return"url('"+(s.protocol+"//"+s.host+s.pathname+s.search)+"#"+n+"')"},I=function(n){var r=n.getBBox(1);$(n.pattern,{patternTransform:n.matrix.invert()+" translate("+r.x+","+r.y+")"})},ie=function(n,r,s){if(n.type=="path"){for(var h,m,v,A,D,T=x(r).toLowerCase().split("-"),V=n.paper,j=s?"end":"start",oe=n.node,be=n.attrs,we=be["stroke-width"],ye=T.length,Ae="classic",Ee=3,_e=3,ke=5;ye--;)switch(T[ye]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":Ae=T[ye];break;case"wide":_e=5;break;case"narrow":_e=2;break;case"long":Ee=5;break;case"short":Ee=2}if(Ae=="open"?(Ee+=2,_e+=2,ke+=2,v=1,A=s?4:1,D={fill:"none",stroke:be.stroke}):(A=v=Ee/2,D={fill:be.stroke,stroke:"none"}),n._.arrows?s?(n._.arrows.endPath&&ve[n._.arrows.endPath]--,n._.arrows.endMarker&&ve[n._.arrows.endMarker]--):(n._.arrows.startPath&&ve[n._.arrows.startPath]--,n._.arrows.startMarker&&ve[n._.arrows.startMarker]--):n._.arrows={},Ae!="none"){var Be="raphael-marker-"+Ae,Me="raphael-marker-"+j+Ae+Ee+_e+"-obj"+n.id;a._g.doc.getElementById(Be)?ve[Be]++:(V.defs.appendChild($($("path"),{"stroke-linecap":"round",d:de[Ae],id:Be})),ve[Be]=1);var De,Te=a._g.doc.getElementById(Me);Te?(ve[Me]++,De=Te.getElementsByTagName("use")[0]):(Te=$($("marker"),{id:Me,markerHeight:_e,markerWidth:Ee,orient:"auto",refX:A,refY:_e/2}),De=$($("use"),{"xlink:href":"#"+Be,transform:(s?"rotate(180 "+Ee/2+" "+_e/2+") ":U)+"scale("+Ee/ke+","+_e/ke+")","stroke-width":(1/((Ee/ke+_e/ke)/2)).toFixed(4)}),Te.appendChild(De),V.defs.appendChild(Te),ve[Me]=1),$(De,D);var Fe=v*(Ae!="diamond"&&Ae!="oval");s?(h=n._.arrows.startdx*we||0,m=a.getTotalLength(be.path)-Fe*we):(h=Fe*we,m=a.getTotalLength(be.path)-(n._.arrows.enddx*we||0)),(D={})["marker-"+j]="url(#"+Me+")",(m||h)&&(D.d=a.getSubpath(be.path,h,m)),$(oe,D),n._.arrows[j+"Path"]=Be,n._.arrows[j+"Marker"]=Me,n._.arrows[j+"dx"]=Fe,n._.arrows[j+"Type"]=Ae,n._.arrows[j+"String"]=r}else s?(h=n._.arrows.startdx*we||0,m=a.getTotalLength(be.path)-h):(h=0,m=a.getTotalLength(be.path)-(n._.arrows.enddx*we||0)),n._.arrows[j+"Path"]&&$(oe,{d:a.getSubpath(be.path,h,m)}),delete n._.arrows[j+"Path"],delete n._.arrows[j+"Marker"],delete n._.arrows[j+"dx"],delete n._.arrows[j+"Type"],delete n._.arrows[j+"String"];for(D in ve)if(ve[o](D)&&!ve[D]){var qe=a._g.doc.getElementById(D);qe&&qe.parentNode.removeChild(qe)}}},re={"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},ge=function(n,r,s){if(r=re[x(r).toLowerCase()]){for(var h=n.attrs["stroke-width"]||"1",m={round:h,square:h,butt:0}[n.attrs["stroke-linecap"]||s["stroke-linecap"]]||0,v=[],A=r.length;A--;)v[A]=r[A]*h+(A%2?1:-1)*m;$(n.node,{"stroke-dasharray":v.join(",")})}else $(n.node,{"stroke-dasharray":"none"})},xe=function(n,r){var s=n.node,h=n.attrs,m=s.style.visibility;for(var v in s.style.visibility="hidden",r)if(r[o](v)){if(!a._availableAttrs[o](v))continue;var A=r[v];switch(h[v]=A,v){case"blur":n.blur(A);break;case"title":var D=s.getElementsByTagName("title");if(D.length&&(D=D[0]))D.firstChild.nodeValue=A;else{D=$("title");var T=a._g.doc.createTextNode(A);D.appendChild(T),s.appendChild(D)}break;case"href":case"target":var V=s.parentNode;if(V.tagName.toLowerCase()!="a"){var j=$("a");V.insertBefore(j,s),j.appendChild(s),V=j}v=="target"?V.setAttributeNS(ae,"show",A=="blank"?"new":A):V.setAttributeNS(ae,v,A);break;case"cursor":s.style.cursor=A;break;case"transform":n.transform(A);break;case"arrow-start":ie(n,A);break;case"arrow-end":ie(n,A,1);break;case"clip-rect":var oe=x(A).split(G);if(oe.length==4){n.clip&&n.clip.parentNode.parentNode.removeChild(n.clip.parentNode);var be=$("clipPath"),we=$("rect");be.id=a.createUUID(),$(we,{x:oe[0],y:oe[1],width:oe[2],height:oe[3]}),be.appendChild(we),n.paper.defs.appendChild(be),$(s,{"clip-path":"url(#"+be.id+")"}),n.clip=we}if(!A){var ye=s.getAttribute("clip-path");if(ye){var Ae=a._g.doc.getElementById(ye.replace(/(^url\(#|\)$)/g,U));Ae&&Ae.parentNode.removeChild(Ae),$(s,{"clip-path":U}),delete n.clip}}break;case"path":n.type=="path"&&($(s,{d:A?h.path=a._pathToAbsolute(A):"M0,0"}),n._.dirty=1,n._.arrows&&("startString"in n._.arrows&&ie(n,n._.arrows.startString),"endString"in n._.arrows&&ie(n,n._.arrows.endString,1)));break;case"width":if(s.setAttribute(v,A),n._.dirty=1,!h.fx)break;v="x",A=h.x;case"x":h.fx&&(A=-h.x-(h.width||0));case"rx":if(v=="rx"&&n.type=="rect")break;case"cx":s.setAttribute(v,A),n.pattern&&I(n),n._.dirty=1;break;case"height":if(s.setAttribute(v,A),n._.dirty=1,!h.fy)break;v="y",A=h.y;case"y":h.fy&&(A=-h.y-(h.height||0));case"ry":if(v=="ry"&&n.type=="rect")break;case"cy":s.setAttribute(v,A),n.pattern&&I(n),n._.dirty=1;break;case"r":n.type=="rect"?$(s,{rx:A,ry:A}):s.setAttribute(v,A),n._.dirty=1;break;case"src":n.type=="image"&&s.setAttributeNS(ae,"href",A);break;case"stroke-width":n._.sx==1&&n._.sy==1||(A/=F(B(n._.sx),B(n._.sy))||1),s.setAttribute(v,A),h["stroke-dasharray"]&&ge(n,h["stroke-dasharray"],r),n._.arrows&&("startString"in n._.arrows&&ie(n,n._.arrows.startString),"endString"in n._.arrows&&ie(n,n._.arrows.endString,1));break;case"stroke-dasharray":ge(n,A,r);break;case"fill":var Ee=x(A).match(a._ISURL);if(Ee){be=$("pattern");var _e=$("image");be.id=a.createUUID(),$(be,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),$(_e,{x:0,y:0,"xlink:href":Ee[1]}),be.appendChild(_e),function(Te){a._preload(Ee[1],function(){var Fe=this.offsetWidth,qe=this.offsetHeight;$(Te,{width:Fe,height:qe}),$(_e,{width:Fe,height:qe})})}(be),n.paper.defs.appendChild(be),$(s,{fill:"url(#"+be.id+")"}),n.pattern=be,n.pattern&&I(n);break}var ke=a.getRGB(A);if(ke.error){if((n.type=="circle"||n.type=="ellipse"||x(A).charAt()!="r")&&Q(n,A)){if("opacity"in h||"fill-opacity"in h){var Be=a._g.doc.getElementById(s.getAttribute("fill").replace(/^url\(#|\)$/g,U));if(Be){var Me=Be.getElementsByTagName("stop");$(Me[Me.length-1],{"stop-opacity":("opacity"in h?h.opacity:1)*("fill-opacity"in h?h["fill-opacity"]:1)})}}h.gradient=A,h.fill="none";break}}else delete r.gradient,delete h.gradient,!a.is(h.opacity,"undefined")&&a.is(r.opacity,"undefined")&&$(s,{opacity:h.opacity}),!a.is(h["fill-opacity"],"undefined")&&a.is(r["fill-opacity"],"undefined")&&$(s,{"fill-opacity":h["fill-opacity"]});ke[o]("opacity")&&$(s,{"fill-opacity":ke.opacity>1?ke.opacity/100:ke.opacity});case"stroke":ke=a.getRGB(A),s.setAttribute(v,ke.hex),v=="stroke"&&ke[o]("opacity")&&$(s,{"stroke-opacity":ke.opacity>1?ke.opacity/100:ke.opacity}),v=="stroke"&&n._.arrows&&("startString"in n._.arrows&&ie(n,n._.arrows.startString),"endString"in n._.arrows&&ie(n,n._.arrows.endString,1));break;case"gradient":(n.type=="circle"||n.type=="ellipse"||x(A).charAt()!="r")&&Q(n,A);break;case"opacity":h.gradient&&!h[o]("stroke-opacity")&&$(s,{"stroke-opacity":A>1?A/100:A});case"fill-opacity":if(h.gradient){(Be=a._g.doc.getElementById(s.getAttribute("fill").replace(/^url\(#|\)$/g,U)))&&(Me=Be.getElementsByTagName("stop"),$(Me[Me.length-1],{"stop-opacity":A}));break}default:v=="font-size"&&(A=L(A,10)+"px");var De=v.replace(/(\-.)/g,function(Te){return Te.substring(1).toUpperCase()});s.style[De]=A,n._.dirty=1,s.setAttribute(v,A)}}Y(n,r),s.style.visibility=m},Y=function(n,r){if(n.type=="text"&&(r[o]("text")||r[o]("font")||r[o]("font-size")||r[o]("x")||r[o]("y"))){var s=n.attrs,h=n.node,m=h.firstChild?L(a._g.doc.defaultView.getComputedStyle(h.firstChild,U).getPropertyValue("font-size"),10):10;if(r[o]("text")){for(s.text=r.text;h.firstChild;)h.removeChild(h.firstChild);for(var v,A=x(r.text).split(`
`),D=[],T=0,V=A.length;T<V;T++)v=$("tspan"),T&&$(v,{dy:1.2*m,x:s.x}),v.appendChild(a._g.doc.createTextNode(A[T])),h.appendChild(v),D[T]=v}else for(T=0,V=(D=h.getElementsByTagName("tspan")).length;T<V;T++)T?$(D[T],{dy:1.2*m,x:s.x}):$(D[0],{dy:0});$(h,{x:s.x,y:s.y}),n._.dirty=1;var j=n._getBBox(),oe=s.y-(j.y+j.height/2);oe&&a.is(oe,"finite")&&$(D[0],{dy:oe})}},fe=function(n){return n.parentNode&&n.parentNode.tagName.toLowerCase()==="a"?n.parentNode:n},pe=function(n,r){this[0]=this.node=n,n.raphael=!0,this.id=("0000"+(Math.random()*Math.pow(36,5)<<0).toString(36)).slice(-5),n.raphaelid=this.id,this.matrix=a.matrix(),this.realPath=null,this.paper=r,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!r.bottom&&(r.bottom=this),this.prev=r.top,r.top&&(r.top.next=this),r.top=this,this.next=null},c=a.el;pe.prototype=c,c.constructor=pe,a._engine.path=function(n,r){var s=$("path");r.canvas&&r.canvas.appendChild(s);var h=new pe(s,r);return h.type="path",xe(h,{fill:"none",stroke:"#000",path:n}),h},c.rotate=function(n,r,s){if(this.removed)return this;if((n=x(n).split(G)).length-1&&(r=w(n[1]),s=w(n[2])),n=w(n[0]),s==null&&(r=s),r==null||s==null){var h=this.getBBox(1);r=h.x+h.width/2,s=h.y+h.height/2}return this.transform(this._.transform.concat([["r",n,r,s]])),this},c.scale=function(n,r,s,h){if(this.removed)return this;if((n=x(n).split(G)).length-1&&(r=w(n[1]),s=w(n[2]),h=w(n[3])),n=w(n[0]),r==null&&(r=n),h==null&&(s=h),s==null||h==null)var m=this.getBBox(1);return s=s==null?m.x+m.width/2:s,h=h==null?m.y+m.height/2:h,this.transform(this._.transform.concat([["s",n,r,s,h]])),this},c.translate=function(n,r){return this.removed?this:((n=x(n).split(G)).length-1&&(r=w(n[1])),n=w(n[0])||0,r=+r||0,this.transform(this._.transform.concat([["t",n,r]])),this)},c.transform=function(n){var r=this._;if(n==null)return r.transform;if(a._extractTransform(this,n),this.clip&&$(this.clip,{transform:this.matrix.invert()}),this.pattern&&I(this),this.node&&$(this.node,{transform:this.matrix}),r.sx!=1||r.sy!=1){var s=this.attrs[o]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":s})}return this},c.hide=function(){return this.removed||(this.node.style.display="none"),this},c.show=function(){return this.removed||(this.node.style.display=""),this},c.remove=function(){var n=fe(this.node);if(!this.removed&&n.parentNode){var r=this.paper;for(var s in r.__set__&&r.__set__.exclude(this),K.unbind("raphael.*.*."+this.id),this.gradient&&r.defs.removeChild(this.gradient),a._tear(this,r),n.parentNode.removeChild(n),this.removeData(),this)this[s]=typeof this[s]=="function"?a._removedFactory(s):null;this.removed=!0}},c._getBBox=function(){if(this.node.style.display=="none"){this.show();var n=!0}var r,s=!1;this.paper.canvas.parentElement?r=this.paper.canvas.parentElement.style:this.paper.canvas.parentNode&&(r=this.paper.canvas.parentNode.style),r&&r.display=="none"&&(s=!0,r.display="");var h={};try{h=this.node.getBBox()}catch{h={x:this.node.clientLeft,y:this.node.clientTop,width:this.node.clientWidth,height:this.node.clientHeight}}finally{h=h||{},s&&(r.display="none")}return n&&this.hide(),h},c.attr=function(n,r){if(this.removed)return this;if(n==null){var s={};for(var h in this.attrs)this.attrs[o](h)&&(s[h]=this.attrs[h]);return s.gradient&&s.fill=="none"&&(s.fill=s.gradient)&&delete s.gradient,s.transform=this._.transform,s}if(r==null&&a.is(n,"string")){if(n=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;if(n=="transform")return this._.transform;for(var m=n.split(G),v={},A=0,D=m.length;A<D;A++)(n=m[A])in this.attrs?v[n]=this.attrs[n]:a.is(this.paper.customAttributes[n],"function")?v[n]=this.paper.customAttributes[n].def:v[n]=a._availableAttrs[n];return D-1?v:v[m[0]]}if(r==null&&a.is(n,"array")){for(v={},A=0,D=n.length;A<D;A++)v[n[A]]=this.attr(n[A]);return v}if(r!=null){var T={};T[n]=r}else n!=null&&a.is(n,"object")&&(T=n);for(var V in T)K("raphael.attr."+V+"."+this.id,this,T[V]);for(V in this.paper.customAttributes)if(this.paper.customAttributes[o](V)&&T[o](V)&&a.is(this.paper.customAttributes[V],"function")){var j=this.paper.customAttributes[V].apply(this,[].concat(T[V]));for(var oe in this.attrs[V]=T[V],j)j[o](oe)&&(T[oe]=j[oe])}return xe(this,T),this},c.toFront=function(){if(this.removed)return this;var n=fe(this.node);n.parentNode.appendChild(n);var r=this.paper;return r.top!=this&&a._tofront(this,r),this},c.toBack=function(){if(this.removed)return this;var n=fe(this.node),r=n.parentNode;return r.insertBefore(n,r.firstChild),a._toback(this,this.paper),this.paper,this},c.insertAfter=function(n){if(this.removed||!n)return this;var r=fe(this.node),s=fe(n.node||n[n.length-1].node);return s.nextSibling?s.parentNode.insertBefore(r,s.nextSibling):s.parentNode.appendChild(r),a._insertafter(this,n,this.paper),this},c.insertBefore=function(n){if(this.removed||!n)return this;var r=fe(this.node),s=fe(n.node||n[0].node);return s.parentNode.insertBefore(r,s),a._insertbefore(this,n,this.paper),this},c.blur=function(n){var r=this;if(+n!=0){var s=$("filter"),h=$("feGaussianBlur");r.attrs.blur=n,s.id=a.createUUID(),$(h,{stdDeviation:+n||1.5}),s.appendChild(h),r.paper.defs.appendChild(s),r._blur=s,$(r.node,{filter:"url(#"+s.id+")"})}else r._blur&&(r._blur.parentNode.removeChild(r._blur),delete r._blur,delete r.attrs.blur),r.node.removeAttribute("filter");return r},a._engine.circle=function(n,r,s,h){var m=$("circle");n.canvas&&n.canvas.appendChild(m);var v=new pe(m,n);return v.attrs={cx:r,cy:s,r:h,fill:"none",stroke:"#000"},v.type="circle",$(m,v.attrs),v},a._engine.rect=function(n,r,s,h,m,v){var A=$("rect");n.canvas&&n.canvas.appendChild(A);var D=new pe(A,n);return D.attrs={x:r,y:s,width:h,height:m,rx:v||0,ry:v||0,fill:"none",stroke:"#000"},D.type="rect",$(A,D.attrs),D},a._engine.ellipse=function(n,r,s,h,m){var v=$("ellipse");n.canvas&&n.canvas.appendChild(v);var A=new pe(v,n);return A.attrs={cx:r,cy:s,rx:h,ry:m,fill:"none",stroke:"#000"},A.type="ellipse",$(v,A.attrs),A},a._engine.image=function(n,r,s,h,m,v){var A=$("image");$(A,{x:s,y:h,width:m,height:v,preserveAspectRatio:"none"}),A.setAttributeNS(ae,"href",r),n.canvas&&n.canvas.appendChild(A);var D=new pe(A,n);return D.attrs={x:s,y:h,width:m,height:v,src:r},D.type="image",D},a._engine.text=function(n,r,s,h){var m=$("text");n.canvas&&n.canvas.appendChild(m);var v=new pe(m,n);return v.attrs={x:r,y:s,"text-anchor":"middle",text:h,"font-family":a._availableAttrs["font-family"],"font-size":a._availableAttrs["font-size"],stroke:"none",fill:"#000"},v.type="text",xe(v,v.attrs),v},a._engine.setSize=function(n,r){return this.width=n||this.width,this.height=r||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox),this},a._engine.create=function(){var n=a._getContainer.apply(0,arguments),r=n&&n.container;if(!r)throw new Error("SVG container not found.");var s,h=n.x,m=n.y,v=n.width,A=n.height,D=$("svg"),T="overflow:hidden;";return h=h||0,m=m||0,$(D,{height:A=A||342,version:1.1,width:v=v||512,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}),r==1?(D.style.cssText=T+"position:absolute;left:"+h+"px;top:"+m+"px",a._g.doc.body.appendChild(D),s=1):(D.style.cssText=T+"position:relative",r.firstChild?r.insertBefore(D,r.firstChild):r.appendChild(D)),(r=new a._Paper).width=v,r.height=A,r.canvas=D,r.clear(),r._left=r._top=0,s&&(r.renderfix=function(){}),r.renderfix(),r},a._engine.setViewBox=function(n,r,s,h,m){K("raphael.setViewBox",this,this._viewBox,[n,r,s,h,m]);var v,A,D=this.getSize(),T=F(s/D.width,h/D.height),V=this.top,j=m?"xMidYMid meet":"xMinYMin";for(n==null?(this._vbSize&&(T=1),delete this._vbSize,v="0 0 "+this.width+X+this.height):(this._vbSize=T,v=n+X+r+X+s+X+h),$(this.canvas,{viewBox:v,preserveAspectRatio:j});T&&V;)A="stroke-width"in V.attrs?V.attrs["stroke-width"]:1,V.attr({"stroke-width":A}),V._.dirty=1,V._.dirtyT=1,V=V.prev;return this._viewBox=[n,r,s,h,!!m],this},a.prototype.renderfix=function(){var n,r=this.canvas,s=r.style;try{n=r.getScreenCTM()||r.createSVGMatrix()}catch{n=r.createSVGMatrix()}var h=-n.e%1,m=-n.f%1;(h||m)&&(h&&(this._left=(this._left+h)%1,s.left=this._left+"px"),m&&(this._top=(this._top+m)%1,s.top=this._top+"px"))},a.prototype.clear=function(){a.eve("raphael.clear",this);for(var n=this.canvas;n.firstChild;)n.removeChild(n.firstChild);this.bottom=this.top=null,(this.desc=$("desc")).appendChild(a._g.doc.createTextNode("Created with Rapha\xEBl "+a.version)),n.appendChild(this.desc),n.appendChild(this.defs=$("defs"))},a.prototype.remove=function(){for(var n in K("raphael.remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this)this[n]=typeof this[n]=="function"?a._removedFactory(n):null};var u=a.st;for(var p in c)c[o](p)&&!u[o](p)&&(u[p]=function(n){return function(){var r=arguments;return this.forEach(function(s){s[n].apply(s,r)})}}(p))}}.apply(H,b))===void 0||(M.exports=f)},function(M,H,C){var b,f;b=[C(0)],(f=function(a){if(!a||a.vml){var o="hasOwnProperty",x=String,w=parseFloat,L=Math,z=L.round,F=L.max,B=L.min,N=L.abs,G=/[, ]+/,K=a.eve,U=" ",X="",ae={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},de=/([clmz]),?([^clmz]*)/gi,ve=/ progid:\S+Blur\([^\)]+\)/g,$=/-?[^,\s-]+/g,Q="position:absolute;left:0;top:0;width:1px;height:1px;behavior:url(#default#VML)",W=21600,I={path:1,rect:1,image:1},ie={circle:1,ellipse:1},re=function(r,s,h){var m=a.matrix();return m.rotate(-r,.5,.5),{dx:m.x(s,h),dy:m.y(s,h)}},ge=function(r,s,h,m,v,A){var D=r._,T=r.matrix,V=D.fillpos,j=r.node,oe=j.style,be=1,we="",ye=W/s,Ae=W/h;if(oe.visibility="hidden",s&&h){if(j.coordsize=N(ye)+U+N(Ae),oe.rotation=A*(s*h<0?-1:1),A){var Ee=re(A,m,v);m=Ee.dx,v=Ee.dy}if(s<0&&(we+="x"),h<0&&(we+=" y")&&(be=-1),oe.flip=we,j.coordorigin=m*-ye+U+v*-Ae,V||D.fillsize){var _e=j.getElementsByTagName("fill");_e=_e&&_e[0],j.removeChild(_e),V&&(Ee=re(A,T.x(V[0],V[1]),T.y(V[0],V[1])),_e.position=Ee.dx*be+U+Ee.dy*be),D.fillsize&&(_e.size=D.fillsize[0]*N(s)+U+D.fillsize[1]*N(h)),j.appendChild(_e)}oe.visibility="visible"}};a.toString=function(){return`Your browser doesn\u2019t support SVG. Falling down to VML.
You are running Rapha\xEBl `+this.version};var xe,Y=function(r,s,h){for(var m=x(s).toLowerCase().split("-"),v=h?"end":"start",A=m.length,D="classic",T="medium",V="medium";A--;)switch(m[A]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":D=m[A];break;case"wide":case"narrow":V=m[A];break;case"long":case"short":T=m[A]}var j=r.node.getElementsByTagName("stroke")[0];j[v+"arrow"]=D,j[v+"arrowlength"]=T,j[v+"arrowwidth"]=V},fe=function(r,s){r.attrs=r.attrs||{};var h=r.node,m=r.attrs,v=h.style,A=I[r.type]&&(s.x!=m.x||s.y!=m.y||s.width!=m.width||s.height!=m.height||s.cx!=m.cx||s.cy!=m.cy||s.rx!=m.rx||s.ry!=m.ry||s.r!=m.r),D=ie[r.type]&&(m.cx!=s.cx||m.cy!=s.cy||m.r!=s.r||m.rx!=s.rx||m.ry!=s.ry),T=r;for(var V in s)s[o](V)&&(m[V]=s[V]);if(A&&(m.path=a._getPath[r.type](r),r._.dirty=1),s.href&&(h.href=s.href),s.title&&(h.title=s.title),s.target&&(h.target=s.target),s.cursor&&(v.cursor=s.cursor),"blur"in s&&r.blur(s.blur),(s.path&&r.type=="path"||A)&&(h.path=function(ze){var Ke=/[ahqstv]/gi,ut=a._pathToAbsolute;if(x(ze).match(Ke)&&(ut=a._path2curve),Ke=/[clmz]/g,ut==a._pathToAbsolute&&!x(ze).match(Ke)){var Ue=x(ze).replace(de,function(Qt,ft,pt){var Ze=[],Tt=ft.toLowerCase()=="m",nt=ae[ft];return pt.replace($,function(Nt){Tt&&Ze.length==2&&(nt+=Ze+ae[ft=="m"?"l":"L"],Ze=[]),Ze.push(z(Nt*W))}),nt+Ze});return Ue}var ht,Ge,_t=ut(ze);Ue=[];for(var dt=0,St=_t.length;dt<St;dt++){ht=_t[dt],(Ge=_t[dt][0].toLowerCase())=="z"&&(Ge="x");for(var Je=1,He=ht.length;Je<He;Je++)Ge+=z(ht[Je]*W)+(Je!=He-1?",":X);Ue.push(Ge)}return Ue.join(U)}(~x(m.path).toLowerCase().indexOf("r")?a._pathToAbsolute(m.path):m.path),r._.dirty=1,r.type=="image"&&(r._.fillpos=[m.x,m.y],r._.fillsize=[m.width,m.height],ge(r,1,1,0,0,0))),"transform"in s&&r.transform(s.transform),D){var j=+m.cx,oe=+m.cy,be=+m.rx||+m.r||0,we=+m.ry||+m.r||0;h.path=a.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",z((j-be)*W),z((oe-we)*W),z((j+be)*W),z((oe+we)*W),z(j*W)),r._.dirty=1}if("clip-rect"in s){var ye=x(s["clip-rect"]).split(G);if(ye.length==4){ye[2]=+ye[2]+ +ye[0],ye[3]=+ye[3]+ +ye[1];var Ae=h.clipRect||a._g.doc.createElement("div"),Ee=Ae.style;Ee.clip=a.format("rect({1}px {2}px {3}px {0}px)",ye),h.clipRect||(Ee.position="absolute",Ee.top=0,Ee.left=0,Ee.width=r.paper.width+"px",Ee.height=r.paper.height+"px",h.parentNode.insertBefore(Ae,h),Ae.appendChild(h),h.clipRect=Ae)}s["clip-rect"]||h.clipRect&&(h.clipRect.style.clip="auto")}if(r.textpath){var _e=r.textpath.style;s.font&&(_e.font=s.font),s["font-family"]&&(_e.fontFamily='"'+s["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,X)+'"'),s["font-size"]&&(_e.fontSize=s["font-size"]),s["font-weight"]&&(_e.fontWeight=s["font-weight"]),s["font-style"]&&(_e.fontStyle=s["font-style"])}if("arrow-start"in s&&Y(T,s["arrow-start"]),"arrow-end"in s&&Y(T,s["arrow-end"],1),s.opacity!=null||s.fill!=null||s.src!=null||s.stroke!=null||s["stroke-width"]!=null||s["stroke-opacity"]!=null||s["fill-opacity"]!=null||s["stroke-dasharray"]!=null||s["stroke-miterlimit"]!=null||s["stroke-linejoin"]!=null||s["stroke-linecap"]!=null){var ke=h.getElementsByTagName("fill");if(!(ke=ke&&ke[0])&&(ke=xe("fill")),r.type=="image"&&s.src&&(ke.src=s.src),s.fill&&(ke.on=!0),ke.on!=null&&s.fill!="none"&&s.fill!==null||(ke.on=!1),ke.on&&s.fill){var Be=x(s.fill).match(a._ISURL);if(Be){ke.parentNode==h&&h.removeChild(ke),ke.rotate=!0,ke.src=Be[1],ke.type="tile";var Me=r.getBBox(1);ke.position=Me.x+U+Me.y,r._.fillpos=[Me.x,Me.y],a._preload(Be[1],function(){r._.fillsize=[this.offsetWidth,this.offsetHeight]})}else ke.color=a.getRGB(s.fill).hex,ke.src=X,ke.type="solid",a.getRGB(s.fill).error&&(T.type in{circle:1,ellipse:1}||x(s.fill).charAt()!="r")&&pe(T,s.fill,ke)&&(m.fill="none",m.gradient=s.fill,ke.rotate=!1)}if("fill-opacity"in s||"opacity"in s){var De=((+m["fill-opacity"]+1||2)-1)*((+m.opacity+1||2)-1)*((+a.getRGB(s.fill).o+1||2)-1);De=B(F(De,0),1),ke.opacity=De,ke.src&&(ke.color="none")}h.appendChild(ke);var Te=h.getElementsByTagName("stroke")&&h.getElementsByTagName("stroke")[0],Fe=!1;!Te&&(Fe=Te=xe("stroke")),(s.stroke&&s.stroke!="none"||s["stroke-width"]||s["stroke-opacity"]!=null||s["stroke-dasharray"]||s["stroke-miterlimit"]||s["stroke-linejoin"]||s["stroke-linecap"])&&(Te.on=!0),(s.stroke=="none"||s.stroke===null||Te.on==null||s.stroke==0||s["stroke-width"]==0)&&(Te.on=!1);var qe=a.getRGB(s.stroke);Te.on&&s.stroke&&(Te.color=qe.hex),De=((+m["stroke-opacity"]+1||2)-1)*((+m.opacity+1||2)-1)*((+qe.o+1||2)-1);var Ye=.75*(w(s["stroke-width"])||1);if(De=B(F(De,0),1),s["stroke-width"]==null&&(Ye=m["stroke-width"]),s["stroke-width"]&&(Te.weight=Ye),Ye&&Ye<1&&(De*=Ye)&&(Te.weight=1),Te.opacity=De,s["stroke-linejoin"]&&(Te.joinstyle=s["stroke-linejoin"]||"miter"),Te.miterlimit=s["stroke-miterlimit"]||8,s["stroke-linecap"]&&(Te.endcap=s["stroke-linecap"]=="butt"?"flat":s["stroke-linecap"]=="square"?"square":"round"),"stroke-dasharray"in s){var Ct={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};Te.dashstyle=Ct[o](s["stroke-dasharray"])?Ct[s["stroke-dasharray"]]:X}Fe&&h.appendChild(Te)}if(T.type=="text"){T.paper.canvas.style.display=X;var Qe=T.paper.span,ot=m.font&&m.font.match(/\d+(?:\.\d*)?(?=px)/);v=Qe.style,m.font&&(v.font=m.font),m["font-family"]&&(v.fontFamily=m["font-family"]),m["font-weight"]&&(v.fontWeight=m["font-weight"]),m["font-style"]&&(v.fontStyle=m["font-style"]),ot=w(m["font-size"]||ot&&ot[0])||10,v.fontSize=100*ot+"px",T.textpath.string&&(Qe.innerHTML=x(T.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var lt=Qe.getBoundingClientRect();T.W=m.w=(lt.right-lt.left)/100,T.H=m.h=(lt.bottom-lt.top)/100,T.X=m.x,T.Y=m.y+T.H/2,("x"in s||"y"in s)&&(T.path.v=a.format("m{0},{1}l{2},{1}",z(m.x*W),z(m.y*W),z(m.x*W)+1));for(var kt=["x","y","text","font","font-family","font-weight","font-style","font-size"],ct=0,Bt=kt.length;ct<Bt;ct++)if(kt[ct]in s){T._.dirty=1;break}switch(m["text-anchor"]){case"start":T.textpath.style["v-text-align"]="left",T.bbx=T.W/2;break;case"end":T.textpath.style["v-text-align"]="right",T.bbx=-T.W/2;break;default:T.textpath.style["v-text-align"]="center",T.bbx=0}T.textpath.style["v-text-kern"]=!0}},pe=function(r,s,h){r.attrs=r.attrs||{},r.attrs;var m=Math.pow,v="linear",A=".5 .5";if(r.attrs.gradient=s,s=(s=x(s).replace(a._radial_gradient,function(be,we,ye){return v="radial",we&&ye&&(we=w(we),ye=w(ye),m(we-.5,2)+m(ye-.5,2)>.25&&(ye=L.sqrt(.25-m(we-.5,2))*(2*(ye>.5)-1)+.5),A=we+U+ye),X})).split(/\s*\-\s*/),v=="linear"){var D=s.shift();if(D=-w(D),isNaN(D))return null}var T=a._parseDots(s);if(!T)return null;if(r=r.shape||r.node,T.length){r.removeChild(h),h.on=!0,h.method="none",h.color=T[0].color,h.color2=T[T.length-1].color;for(var V=[],j=0,oe=T.length;j<oe;j++)T[j].offset&&V.push(T[j].offset+U+T[j].color);h.colors=V.length?V.join():"0% "+h.color,v=="radial"?(h.type="gradientTitle",h.focus="100%",h.focussize="0 0",h.focusposition=A,h.angle=0):(h.type="gradient",h.angle=(270-D)%360),r.appendChild(h)}return 1},c=function(r,s){this[0]=this.node=r,r.raphael=!0,this.id=a._oid++,r.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=s,this.matrix=a.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!s.bottom&&(s.bottom=this),this.prev=s.top,s.top&&(s.top.next=this),s.top=this,this.next=null},u=a.el;c.prototype=u,u.constructor=c,u.transform=function(r){if(r==null)return this._.transform;var s,h=this.paper._viewBoxShift,m=h?"s"+[h.scale,h.scale]+"-1-1t"+[h.dx,h.dy]:X;h&&(s=r=x(r).replace(/\.{3}|\u2026/g,this._.transform||X)),a._extractTransform(this,m+r);var v,A=this.matrix.clone(),D=this.skew,T=this.node,V=~x(this.attrs.fill).indexOf("-"),j=!x(this.attrs.fill).indexOf("url(");if(A.translate(1,1),j||V||this.type=="image")if(D.matrix="1 0 0 1",D.offset="0 0",v=A.split(),V&&v.noRotation||!v.isSimple){T.style.filter=A.toFilter();var oe=this.getBBox(),be=this.getBBox(1),we=oe.x-be.x,ye=oe.y-be.y;T.coordorigin=we*-W+U+ye*-W,ge(this,1,1,we,ye,0)}else T.style.filter=X,ge(this,v.scalex,v.scaley,v.dx,v.dy,v.rotate);else T.style.filter=X,D.matrix=x(A),D.offset=A.offset();return s!==null&&(this._.transform=s,a._extractTransform(this,s)),this},u.rotate=function(r,s,h){if(this.removed)return this;if(r!=null){if((r=x(r).split(G)).length-1&&(s=w(r[1]),h=w(r[2])),r=w(r[0]),h==null&&(s=h),s==null||h==null){var m=this.getBBox(1);s=m.x+m.width/2,h=m.y+m.height/2}return this._.dirtyT=1,this.transform(this._.transform.concat([["r",r,s,h]])),this}},u.translate=function(r,s){return this.removed?this:((r=x(r).split(G)).length-1&&(s=w(r[1])),r=w(r[0])||0,s=+s||0,this._.bbox&&(this._.bbox.x+=r,this._.bbox.y+=s),this.transform(this._.transform.concat([["t",r,s]])),this)},u.scale=function(r,s,h,m){if(this.removed)return this;if((r=x(r).split(G)).length-1&&(s=w(r[1]),h=w(r[2]),m=w(r[3]),isNaN(h)&&(h=null),isNaN(m)&&(m=null)),r=w(r[0]),s==null&&(s=r),m==null&&(h=m),h==null||m==null)var v=this.getBBox(1);return h=h==null?v.x+v.width/2:h,m=m==null?v.y+v.height/2:m,this.transform(this._.transform.concat([["s",r,s,h,m]])),this._.dirtyT=1,this},u.hide=function(){return!this.removed&&(this.node.style.display="none"),this},u.show=function(){return!this.removed&&(this.node.style.display=X),this},u.auxGetBBox=a.el.getBBox,u.getBBox=function(){var r=this.auxGetBBox();if(this.paper&&this.paper._viewBoxShift){var s={},h=1/this.paper._viewBoxShift.scale;return s.x=r.x-this.paper._viewBoxShift.dx,s.x*=h,s.y=r.y-this.paper._viewBoxShift.dy,s.y*=h,s.width=r.width*h,s.height=r.height*h,s.x2=s.x+s.width,s.y2=s.y+s.height,s}return r},u._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},u.remove=function(){if(!this.removed&&this.node.parentNode){for(var r in this.paper.__set__&&this.paper.__set__.exclude(this),a.eve.unbind("raphael.*.*."+this.id),a._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape),this)this[r]=typeof this[r]=="function"?a._removedFactory(r):null;this.removed=!0}},u.attr=function(r,s){if(this.removed)return this;if(r==null){var h={};for(var m in this.attrs)this.attrs[o](m)&&(h[m]=this.attrs[m]);return h.gradient&&h.fill=="none"&&(h.fill=h.gradient)&&delete h.gradient,h.transform=this._.transform,h}if(s==null&&a.is(r,"string")){if(r=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;for(var v=r.split(G),A={},D=0,T=v.length;D<T;D++)(r=v[D])in this.attrs?A[r]=this.attrs[r]:a.is(this.paper.customAttributes[r],"function")?A[r]=this.paper.customAttributes[r].def:A[r]=a._availableAttrs[r];return T-1?A:A[v[0]]}if(this.attrs&&s==null&&a.is(r,"array")){for(A={},D=0,T=r.length;D<T;D++)A[r[D]]=this.attr(r[D]);return A}var V;for(var j in s!=null&&((V={})[r]=s),s==null&&a.is(r,"object")&&(V=r),V)K("raphael.attr."+j+"."+this.id,this,V[j]);if(V){for(j in this.paper.customAttributes)if(this.paper.customAttributes[o](j)&&V[o](j)&&a.is(this.paper.customAttributes[j],"function")){var oe=this.paper.customAttributes[j].apply(this,[].concat(V[j]));for(var be in this.attrs[j]=V[j],oe)oe[o](be)&&(V[be]=oe[be])}V.text&&this.type=="text"&&(this.textpath.string=V.text),fe(this,V)}return this},u.toFront=function(){return!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&a._tofront(this,this.paper),this},u.toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),a._toback(this,this.paper)),this)},u.insertAfter=function(r){return this.removed?this:(r.constructor==a.st.constructor&&(r=r[r.length-1]),r.node.nextSibling?r.node.parentNode.insertBefore(this.node,r.node.nextSibling):r.node.parentNode.appendChild(this.node),a._insertafter(this,r,this.paper),this)},u.insertBefore=function(r){return this.removed?this:(r.constructor==a.st.constructor&&(r=r[0]),r.node.parentNode.insertBefore(this.node,r.node),a._insertbefore(this,r,this.paper),this)},u.blur=function(r){var s=this.node.runtimeStyle,h=s.filter;return h=h.replace(ve,X),+r!=0?(this.attrs.blur=r,s.filter=h+U+" progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+r||1.5)+")",s.margin=a.format("-{0}px 0 0 -{0}px",z(+r||1.5))):(s.filter=h,s.margin=0,delete this.attrs.blur),this},a._engine.path=function(r,s){var h=xe("shape");h.style.cssText=Q,h.coordsize=W+U+W,h.coordorigin=s.coordorigin;var m=new c(h,s),v={fill:"none",stroke:"#000"};r&&(v.path=r),m.type="path",m.path=[],m.Path=X,fe(m,v),s.canvas&&s.canvas.appendChild(h);var A=xe("skew");return A.on=!0,h.appendChild(A),m.skew=A,m.transform(X),m},a._engine.rect=function(r,s,h,m,v,A){var D=a._rectPath(s,h,m,v,A),T=r.path(D),V=T.attrs;return T.X=V.x=s,T.Y=V.y=h,T.W=V.width=m,T.H=V.height=v,V.r=A,V.path=D,T.type="rect",T},a._engine.ellipse=function(r,s,h,m,v){var A=r.path();return A.attrs,A.X=s-m,A.Y=h-v,A.W=2*m,A.H=2*v,A.type="ellipse",fe(A,{cx:s,cy:h,rx:m,ry:v}),A},a._engine.circle=function(r,s,h,m){var v=r.path();return v.attrs,v.X=s-m,v.Y=h-m,v.W=v.H=2*m,v.type="circle",fe(v,{cx:s,cy:h,r:m}),v},a._engine.image=function(r,s,h,m,v,A){var D=a._rectPath(h,m,v,A),T=r.path(D).attr({stroke:"none"}),V=T.attrs,j=T.node,oe=j.getElementsByTagName("fill")[0];return V.src=s,T.X=V.x=h,T.Y=V.y=m,T.W=V.width=v,T.H=V.height=A,V.path=D,T.type="image",oe.parentNode==j&&j.removeChild(oe),oe.rotate=!0,oe.src=s,oe.type="tile",T._.fillpos=[h,m],T._.fillsize=[v,A],j.appendChild(oe),ge(T,1,1,0,0,0),T},a._engine.text=function(r,s,h,m){var v=xe("shape"),A=xe("path"),D=xe("textpath");s=s||0,h=h||0,m=m||"",A.v=a.format("m{0},{1}l{2},{1}",z(s*W),z(h*W),z(s*W)+1),A.textpathok=!0,D.string=x(m),D.on=!0,v.style.cssText=Q,v.coordsize=W+U+W,v.coordorigin="0 0";var T=new c(v,r),V={fill:"#000",stroke:"none",font:a._availableAttrs.font,text:m};T.shape=v,T.path=A,T.textpath=D,T.type="text",T.attrs.text=x(m),T.attrs.x=s,T.attrs.y=h,T.attrs.w=1,T.attrs.h=1,fe(T,V),v.appendChild(D),v.appendChild(A),r.canvas.appendChild(v);var j=xe("skew");return j.on=!0,v.appendChild(j),T.skew=j,T.transform(X),T},a._engine.setSize=function(r,s){var h=this.canvas.style;return this.width=r,this.height=s,r==+r&&(r+="px"),s==+s&&(s+="px"),h.width=r,h.height=s,h.clip="rect(0 "+r+" "+s+" 0)",this._viewBox&&a._engine.setViewBox.apply(this,this._viewBox),this},a._engine.setViewBox=function(r,s,h,m,v){a.eve("raphael.setViewBox",this,this._viewBox,[r,s,h,m,v]);var A,D,T=this.getSize(),V=T.width,j=T.height;return v&&(h*(A=j/m)<V&&(r-=(V-h*A)/2/A),m*(D=V/h)<j&&(s-=(j-m*D)/2/D)),this._viewBox=[r,s,h,m,!!v],this._viewBoxShift={dx:-r,dy:-s,scale:T},this.forEach(function(oe){oe.transform("...")}),this},a._engine.initWin=function(r){var s=r.document;s.styleSheets.length<31?s.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)"):s.styleSheets[0].addRule(".rvml","behavior:url(#default#VML)");try{!s.namespaces.rvml&&s.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),xe=function(h){return s.createElement("<rvml:"+h+' class="rvml">')}}catch{xe=function(m){return s.createElement("<"+m+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},a._engine.initWin(a._g.win),a._engine.create=function(){var r=a._getContainer.apply(0,arguments),s=r.container,h=r.height,m=r.width,v=r.x,A=r.y;if(!s)throw new Error("VML container not found.");var D=new a._Paper,T=D.canvas=a._g.doc.createElement("div"),V=T.style;return v=v||0,A=A||0,m=m||512,h=h||342,D.width=m,D.height=h,m==+m&&(m+="px"),h==+h&&(h+="px"),D.coordsize=216e5+U+216e5,D.coordorigin="0 0",D.span=a._g.doc.createElement("span"),D.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",T.appendChild(D.span),V.cssText=a.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",m,h),s==1?(a._g.doc.body.appendChild(T),V.left=v+"px",V.top=A+"px",V.position="absolute"):s.firstChild?s.insertBefore(T,s.firstChild):s.appendChild(T),D.renderfix=function(){},D},a.prototype.clear=function(){a.eve("raphael.clear",this),this.canvas.innerHTML=X,this.span=a._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},a.prototype.remove=function(){for(var r in a.eve("raphael.remove",this),this.canvas.parentNode.removeChild(this.canvas),this)this[r]=typeof this[r]=="function"?a._removedFactory(r):null;return!0};var p=a.st;for(var n in u)u[o](n)&&!p[o](n)&&(p[n]=function(r){return function(){var s=arguments;return this.forEach(function(h){h[r].apply(h,s)})}}(n))}}.apply(H,b))===void 0||(M.exports=f)}])})})(bn);const qt=Bn(bn.exports);var q={};q.Common={nodeIdIncrement:0,activeNode:0,roundFloat:function(d,k){for(var M=0,H=1;M<k;)H*=10,M++;return Math.round(d*H)/H},apply:function(d,k){if(d&&typeof k=="object")for(var M in k)d[M]=k[M];return d},addRaphEventHandler:function(d,k,M,H){try{d[k](function(C,b){return function(f,a){var o=b;o.e=f,C(o)}}(M,H))}catch{}},isInteger:function(d){return!isNaN(parseInt(d))},isXMLSerializerAvailable:function(){return typeof XMLSerializer=="function"},createSvgEl:function(d,k){if(d=document.createElementNS("http://www.w3.org/2000/svg",d),k)for(var M in k)k.hasOwnProperty(M)&&d.setAttribute(M,String(k[M]));return d},createGradientEl:function(d,k,M){if(k.type!="radialGradient")return!1;var H=q.Common.createSvgEl("radialGradient",{id:d,gradientUnits:"userSpaceOnUse",cx:M[0],cy:M[1],r:M[2],fx:M[0],fy:M[1]});if(k.stop)for(var C=k.stop,b=0;b<C.length;b++){var f=C[b];f["@attributes"]?H.appendChild(q.Common.createSvgEl("stop",f["@attributes"])):(f._attributes&&delete f._attributes,f._children&&delete f._children,f.__proto__&&delete f.__proto__,H.appendChild(q.Common.createSvgEl("stop",f)))}return H},setCssStyle:function(d,k){var M=document.styleSheets[0];M.addRule?M.addRule(d,k):M.insertRule&&M.insertRule(d+" { "+k+" }",M.cssRules.length)}};q.PhyloCanvas=function(){var d,k,M,H,C;return function(b,f,a,o,x){if(this.getNewickObject=function(){return M},this.clear=function(){},this.scale=function(L){H.svg.scale(L)},this.getSvg=function(){return H},this.getPhylogram=function(){return d},this.getSvgSource=function(){if(qt.svg&&q.Common.isXMLSerializerAvailable()){var L=new XMLSerializer;return L.serializeToString(H.svg.canvas)}else return!1},typeof b=="object")if(b.xml){if(b.fileSource)var w=b.xml;else var w=bt.textToXML(b.xml);w=bt.xmlToJSON(w),C=new q.PhyloCanvas.PhyloxmlParse(w)}else if(b.phyloxml){if(b.fileSource)var w=b.phyloxml;else var w=bt.textToXML(b.phyloxml);w=bt.xmlToJSON(w),C=new q.PhyloCanvas.PhyloxmlParse(w)}else if(b.nexml){if(b.fileSource)var w=b.nexml;else var w=bt.textToXML(b.nexml);w=bt.xmlToJSON(w),C=new q.PhyloCanvas.NexmlParse(w,b)}else b.json?C=new q.PhyloCanvas.PhyloxmlParse(b.json):b.newick?C=new q.PhyloCanvas.NewickParse(b.newick):b.nexmlJson?C=new q.PhyloCanvas.NexmlJsonParse(b):alert("Please set the format of input data");else C=new q.PhyloCanvas.NewickParse(b);k=f,H=new q.PhyloCanvas.Render.SVG(k,a,o),x=="circular"?d=new q.PhyloCanvas.Render.CircularPhylogram(H,C):d=new q.PhyloCanvas.Render.Phylogram(H,C)}}();q.PhyloCanvas.prototype={};q.PhyloCanvas.Node=function(){return function(d,k){this.id=q.Common.nodeIdIncrement+=1,this.level=0,this.len=0,this.newickLen=0,this.name="",this.type="",this.chart={},this.img=[],d&&q.Common.apply(this,d),this._countAllChildren=!1,this._countImmediateChildren=!1,this._midBranchPosition=!1,this.children=new Array,k&&k.children.push(this)}}();q.PhyloCanvas.Node.prototype={getCountAllChildren:function(){if(this._countAllChildren!==!1)return this._countAllChildren;var d=0;for(var k in this.children)if(q.Common.isInteger(k)){var M=this.children[k];M.children&&M.children.length>0?d+=M.getCountAllChildren():d++}return this._countAllChildren=d,d},getCountImmediateChildren:function(){if(this._countImmediateChildren!==!1)return this._countImmediateChildren;var d=0;for(var k in this.children){var M=this.children[k];d+=M.length}return this._countImmediateChildren=d,d},getMidbranchPosition:function(d){if(this._midBranchPosition!==!1)return this._midBranchPosition;for(var k=[0,0],M=0;M<this.children.length;M++){var H=this.children[M];H.children&&H.children.length>0?M==0&&d?(k[0]=H.getMidbranchPosition(!0),k[1]+=H.getCountAllChildren()-1):M==0?(k[0]=H.getMidbranchPosition(),k[1]+=H.getCountAllChildren()):M==this.children.length-1?k[1]+=H.getMidbranchPosition():k[1]+=H.getCountAllChildren():M==0&&d?k[0]=0:M==0?(k[0]=1,k[1]+=1):(M==this.children.length-1,k[1]+=1)}return this._midBranchPosition=k[1]>=k[0]?(k[1]+k[0])/2:k[0],this._midBranchPosition}};q.PhyloCanvas.NewickParse=function(){var d,k,M,H=0,C=0,b,f,a=function(F){for(var B=new q.PhyloCanvas.Node;k!==")"&&k!==",";)k===":"?(L(),B.len=q.Common.roundFloat(x(),4),B.len==0&&(B.len=1e-4)):k==="'"||k==='"'?(B.type="label",B.name=w(k)):(B.type="label",B.name=x());return B.level=F.level+1,B},o=function(F){var B=new q.PhyloCanvas.Node;for(F&&(B.level=F.level+1);k!==")";)L(),k==="("?B.children.push(o(B)):B.children.push(a(B));return L(),k!==":"&&k!==")"&&k!==","&&k!==";"&&(B.type="label",B.name=x()),k===":"&&(L(),B.len=q.Common.roundFloat(x(),4),B.len==0&&(B.len=1e-4),B.type="stem"),B},x=function(){for(var F="";k!==":"&&k!==")"&&k!==","&&k!==";";)F+=k,L();return F},w=function(F){for(var B="";k!==F;)B+=k,L();return B},L=function(){return k=d.charAt(M),M+=1,k},z=function(F,B){if(F.children&&F.children.length)for(var N=0;N<F.children.length;N++){var G=F.children[N];G.len===0&&(G.len=1),G.newickLen=q.Common.roundFloat(G.len+F.newickLen,4),G.level>H&&(H=G.level),G.newickLen>C&&(C=G.newickLen),G.children.length>0&&z(G)}return F};return function(F){this.getRoot=function(){return b},this.getLevels=function(){return H},this.getNewickLen=function(){return C},this.getValidate=function(){return f},H=0,C=0,d=F,M=0,L(),b=o(),b=z(b)}}();q.PhyloCanvas.NewickParse.prototype={};q.PhyloCanvas.PhyloxmlParse=function(){var d=0,k=0,M,H,C=function(a,o){var x=new q.PhyloCanvas.Node;if(o&&(x.level=o.level+1),a.clade&&a.clade.length)for(var w=0;w<a.clade.length;w++){var L=a.clade[w];x.children.push(C(L,x))}if(a.branch_length&&(typeof a.branch_length=="object"&&(a.branch_length=a.branch_length[0].Text),x.len=q.Common.roundFloat(a.branch_length,4),x.len==0&&(x.len=1e-4)),a.color?(x.red=a.color[0].red[0].Text,x.green=a.color[0].green[0].Text,x.blue=a.color[0].blue[0].Text):(x.red=0,x.green=0,x.blue=0),a.property&&a.property[0].applies_to=="node"&&a.property[0].ref=="style:font_color"&&(x.font_color_hex=a.property[0].Text),a.name?(x.type="label",x.name=a.name[0].Text,a.name[0]&&a.name[0].style&&(x.style=a.name[0].style),a.name[0]&&a.name[0].bgStyle&&(x.bgStyle=a.name[0].bgStyle)):a.confidence&&(x.name=a.confidence[0].Text),a.sequence&&a.sequence[0]&&a.sequence[0].name&&a.sequence[0].name[0]&&a.sequence[0].name[0].Text&&(x.sequenceName=a.sequence[0].name[0].Text),a.taxonomy&&a.taxonomy[0]&&(a.taxonomy[0].scientific_name&&a.taxonomy[0].scientific_name[0]&&a.taxonomy[0].scientific_name[0].Text&&(x.taxonomyScientificName=a.taxonomy[0].scientific_name[0].Text),a.taxonomy[0].common_name&&a.taxonomy[0].common_name[0]&&a.taxonomy[0].common_name[0].Text&&(x.taxonomyCommonName=a.taxonomy[0].common_name[0].Text)),a.sequence&&a.sequence[0]&&a.sequence[0].accession&&a.sequence[0].accession[0]&&a.sequence[0].accession[0].Text&&(x.sequenceAccession=a.sequence[0].accession[0].Text),a.point&&(x.LatLong=[a.point[0].lat[0].Text,a.point[0].long[0].Text]),x.name||(x.sequenceName?x.name=x.sequenceName:x.taxonomyScientificName?x.name=x.taxonomyScientificName:x.taxonomyCommonName?x.name=x.taxonomyCommonName:x.sequenceAccession&&(x.name=x.sequenceAccession),x.name&&(x.type="label")),a.annotation&&(a.annotation[0]&&a.annotation[0].desc&&a.annotation[0].desc[0]&&a.annotation[0].desc[0].Text&&(x.description=a.annotation[0].desc[0].Text),a.annotation[0]&&a.annotation[0].uri&&a.annotation[0].uri[0]&&a.annotation[0].uri[0].Text&&(x.uri=a.annotation[0].uri[0].Text),a.annotation[0]&&a.annotation[0].img))for(var w in a.annotation[0].img)q.Common.isInteger(w)&&(x.img[w]=a.annotation[0].img[w].Text);if(a.chart&&a.chart[0])for(var w in a.chart[0])w!="Text"&&w!="_children"&&(x.chart[w]=a.chart[0][w][0].Text);return x&&x.level>1&&(x.len||(H="Error. Please include Branch Lengths - we only draw rooted phylogenetic trees.")),x},b=function(a,o){if(a.children&&a.children.length)for(var x=0;x<a.children.length;x++){var w=a.children[x];w.newickLen=Math.round((w.len+a.newickLen)*1e4)/1e4,w.level>d&&(d=w.level),w.newickLen>k&&(k=w.newickLen),w.children.length>0&&b(w)}return a},f=function(a,o){for(var x in a)x!="_children"&&x!="Text"&&(x=="rectangular"||x=="circular"?f(a[x][0],x):(q.PhyloCanvas.Render.Parameters[x]||(q.PhyloCanvas.Render.Parameters[x]={}),q.PhyloCanvas.Render.Parameters.set(x,a[x][0].Text,o)))};return function(a){if(this.getRoot=function(){return M},this.getLevels=function(){return d},this.getNewickLen=function(){return k},this.getValidate=function(){return H},a.phylogeny&&a.phylogeny[0]&&a.phylogeny[0].clade&&(M=C(a.phylogeny[0].clade[0])),a.phylogeny&&a.phylogeny[0]&&a.phylogeny[0].render&&a.phylogeny[0].render[0]){var o=a.phylogeny[0].render[0];if(o&&o.styles){var x=o.styles[0];for(var w in x)if(w!="_children"&&w!="Text")if(x[w][0].type&&x[w][0].type=="radialGradient"&&qt.svg)x[w][0].name=w,q.PhyloCanvas.Render.Style[w]=x[w][0],q.PhyloCanvas.Render.Style.jsphylosvgGradientList||(q.PhyloCanvas.Render.Style.jsphylosvgGradientList=[]),q.PhyloCanvas.Render.Style.jsphylosvgGradientList.push(w);else{q.PhyloCanvas.Render.Style[w]||(q.PhyloCanvas.Render.Style[w]={});for(var L in x[w][0])L!="_attributes"&&L!="_children"&&L!="type"&&(q.PhyloCanvas.Render.Style[w][L.replace("_","-")]=x[w][0][L])}}if(o&&o.parameters&&f(o.parameters[0]),o&&o.charts){var z=o.charts[0];for(var w in z)if(w!="_children"&&w!="Text")for(var L in z[w])z[w][L].type=="binary"?(z[w][L].chart=w,q.PhyloCanvas.Render.Parameters.binaryCharts.push(z[w][L])):z[w][L].type=="integratedBinary"?(z[w][L].chart=w,q.PhyloCanvas.Render.Parameters.integratedBinaryCharts.push(z[w][L])):z[w][L].type=="bar"&&(z[w][L].chart=w,q.PhyloCanvas.Render.Parameters.barCharts.length==1&&q.PhyloCanvas.Render.Parameters.barCharts.shift(),q.PhyloCanvas.Render.Parameters.barCharts.push(z[w][L]))}}M=b(M)}}();q.PhyloCanvas.PhyloxmlParse.prototype={};q.PhyloCanvas.NexmlParse=function(){var d=0,k=0,M,H,C,b,f=function(o,x,w){var L=new q.PhyloCanvas.Node;w&&(L.level=w.level+1);for(var z=0;z<C.length;z++)if(C[z].source==o.id)for(var F=0;F<b.length;F++)C[z].target==b[F].id&&L.children.push(f(b[F],C[z].length,L));if(L&&L.level>0&&!L.len&&(L.len=1),x&&(L.len=q.Common.roundFloat(x,4),L.len==0&&(L.len=1e-4)),o.label&&(L.type="label",L.name=o.label,o.style&&(L.style=o.style)),o.color){const B=o.color.replace(/[a-z%\s\(\)]/g,"").split(",");L.red=B[0],L.green=B[1],L.blue=B[2]}else{const B=q.PhyloCanvas.Render.Style.line.stroke.replace(/[a-z%\s\(\)]/g,"").split(",");L.red=B[0],L.green=B[1],L.blue=B[2]}return L},a=function(o,x){if(o.children&&o.children.length)for(var w=0;w<o.children.length;w++){var L=o.children[w];L.newickLen=Math.round((L.len+o.newickLen)*1e4)/1e4,L.level>d&&(d=L.level),L.newickLen>k&&(k=L.newickLen),L.children.length>0&&a(L)}return o};return function(o,x){this.getRoot=function(){return M},this.getLevels=function(){return d},this.getNewickLen=function(){return k},this.getValidate=function(){return H},x.tree&&o.trees[0]&&o.trees[0].tree[x.tree-1]?(C=o.trees[0].tree[x.tree-1].edge,b=o.trees[0].tree[x.tree-1].node):(C=o.trees[0].tree[0].edge,b=o.trees[0].tree[0].node);for(var w=0;w<b.length;w++){var L=0;if(b[w].root&&b[w].root=="true"){M=b[w];break}for(var z=0;z<C.length;z++)C[z].target==b[w].id&&L++;if(L==0){M=b[w];break}}M?(M=f(M),M=a(M)):H="Error. Currently, only rooted NeXML trees are supported."}}();q.PhyloCanvas.NexmlParse.prototype={};q.PhyloCanvas.NexmlJsonParse=function(){var d=0,k=0,M,H,C=[],b=[],f=function(x,w,L){var z=new q.PhyloCanvas.Node;L&&(z.level=L.level+1);for(var F=0;F<C.length;F++)if(C[F].source==x.id)for(var B=0;B<b.length;B++)C[F].target==b[B].id&&z.children.push(f(b[B],C[F].length,z));return w&&(z.len=q.Common.roundFloat(w,4),z.len==0&&(z.len=1e-4)),x.label&&(z.type="label",z.name=x.label,x.accession&&(z.accession=x.accession),x.style&&(z.style=x.style),x.bgStyle&&(z.bgStyle=x.bgStyle)),x.chart&&(z.chart=x.chart),z&&z.level>1&&(z.len||(H="Error. Please include Branch Lengths - we only draw rooted phylogenetic trees.")),z},a=function(x,w){if(x.children&&x.children.length)for(var L=0;L<x.children.length;L++){var z=x.children[L];z.newickLen=Math.round((z.len+x.newickLen)*1e4)/1e4,z.level>d&&(d=z.level),z.newickLen>k&&(k=z.newickLen),z.children.length>0&&a(z)}return x},o=function(x,w){for(var L in x)L!="_children"&&L!="Text"&&(L=="rectangular"||L=="circular"?o(x[L],L):(q.PhyloCanvas.Render.Parameters[L]||(q.PhyloCanvas.Render.Parameters[L]={}),q.PhyloCanvas.Render.Parameters.set(L,x[L],w)))};return function(x){this.getRoot=function(){return M},this.getLevels=function(){return d},this.getNewickLen=function(){return k},this.getValidate=function(){return H};var w=x.nexmlJson.nexml,L=w.render;if(L&&L.styles){var z=L.styles;for(var F in z)if(F!="_children"&&F!="Text")if(z[F]["@attributes"].type&&z[F]["@attributes"].type=="radialGradient"&&qt.svg)z[F].name=F,z[F].type=z[F]["@attributes"].type,q.PhyloCanvas.Render.Style[F]=z[F],q.PhyloCanvas.Render.Style.jsphylosvgGradientList||(q.PhyloCanvas.Render.Style.jsphylosvgGradientList=[]),q.PhyloCanvas.Render.Style.jsphylosvgGradientList.push(F);else{q.PhyloCanvas.Render.Style[F]||(q.PhyloCanvas.Render.Style[F]={});for(var B in z[F]["@attributes"])B!="_attributes"&&B!="_children"&&B!="type"&&(q.PhyloCanvas.Render.Style[F][B.replace("_","-")]=z[F]["@attributes"][B])}}if(L&&L.parameters&&o(L.parameters),L&&L.charts){var N=L.charts;for(var F in N)N[F]["@attributes"].chart=F,N[F]["@attributes"].type=="binary"?q.PhyloCanvas.Render.Parameters.binaryCharts.push(N[F]["@attributes"]):N[F]["@attributes"].type=="integratedBinary"?q.PhyloCanvas.Render.Parameters.integratedBinaryCharts.push(N[F]["@attributes"]):N[F]["@attributes"].type=="bar"&&q.PhyloCanvas.Render.Parameters.barCharts.push(N[F]["@attributes"])}if(x.tree&&w.trees[0]&&w.trees[0].tree[x.tree-1])C=w.trees[0].tree[x.tree-1].edge,b=w.trees[0].tree[x.tree-1].node;else{for(var F=0;F<w.trees.tree.edge.length;F++)C.push(w.trees.tree.edge[F]["@attributes"]);for(var F=0;F<w.trees.tree.node.length;F++){var G=w.trees.tree.node[F]["@attributes"];G.label&&(G.chart=w.trees.tree.node[F].chart),b.push(G)}}for(var F=0;F<b.length;F++)b[F].root&&b[F].root=="true"&&(M=b[F]);M?(M=f(M),M=a(M)):H="Error. Currently, only rooted NeXML trees are supported."}}();q.PhyloCanvas.NexmlParse.prototype={};q.PhyloCanvas.Render={};q.PhyloCanvas.Render.Style={line:{stroke:"rgb(0,0,0)","stroke-width":1},text:{"font-family":"Verdana","font-size":12,"text-anchor":"start"},path:{stroke:"rgb(0,0,0)","stroke-width":1},connectedDash:{stroke:"rgb(200,200,200)","stroke-dasharray":". "},textSecantBg:{fill:"#EEE",stroke:"#DDD"},highlightedEdgeCircle:{fill:"black",stroke:"black"},barChart:{fill:"#003300",stroke:"#DDD"},getStyle:function(d,k){return this[d]?this[d]:this[k]}};q.PhyloCanvas.Render.Parameters={jsOverride:0,Rectangular:{bufferX:200,paddingX:10,paddingY:20,bufferInnerLabels:10,bufferOuterLabels:5,minHeightBetweenLeaves:10,alignPadding:0,alignRight:!1,showScaleBar:!1},Circular:{bufferRadius:.33,bufferAngle:20,initStartAngle:160,innerCircleRadius:0,minHeightBetweenLeaves:5,bufferInnerLabels:2,bufferOuterLabels:5},binaryCharts:[],integratedBinaryCharts:[],barCharts:[],binaryChartBufferInner:5,binaryChartBufferSiblings:.01,binaryChartThickness:15,binaryChartDisjointed:!1,barChartBufferInner:3,barChartHeight:50,barChartWidth:.5,set:function(d,k,M){this.jsOverride||(M?M=="circular"?this.Circular[d]=parseFloat(k):M=="rectangular"&&(this.Rectangular[d]=parseFloat(k)):this[d]=parseFloat(k))}};q.PhyloCanvas.Render.Line=function(){return function(d,k,M,H,C,b,f,a){this.type="line",this.attr=q.PhyloCanvas.Render.Style.line,this.attr.stroke=["rgb(",C,",",b,",",f,")"].join(""),this.x1=d,this.x2=k,this.y1=M,this.y2=H,a&&(q.Common.apply(this,a),a.attr&&(this.attr=a.attr))}}();q.PhyloCanvas.Render.Text=function(){return function(d,k,M,H){this.type="text",this.attr=q.PhyloCanvas.Render.Style.text,this.x=d,this.y=k,this.text=M,H&&(q.Common.apply(this,H),H.attr&&(this.attr=H.attr))}}();q.PhyloCanvas.Render.Path=function(){return q.PhyloCanvas.Render.Style.path,function(d,k){this.type="path",this.attr=q.PhyloCanvas.Render.Style.path,this.path=d,k&&(q.Common.apply(this,k),k.attr&&(this.attr=k.attr))}}();q.PhyloCanvas.Render.Circle=function(){return function(d,k,M,H){this.type="circle",this.x=d,this.y=k,this.radius=M,H&&(q.Common.apply(this,H),H.attr&&(this.attr=H.attr))}}();q.PhyloCanvas.Render.SVG=function(){return function(d,k,M){this.canvasSize=[k,M],this.svg=qt(d,this.canvasSize[0],this.canvasSize[1])}}();q.PhyloCanvas.Render.SVG.prototype={render:function(){for(var d=this.phylogramObject.getDrawInstructs(),k=0;k<d.length;k++)if(d[k].type=="line")this.svg.path(["M",d[k].x1,d[k].y1,"L",d[k].x2,d[k].y2]).attr(q.PhyloCanvas.Render.Style.line);else if(d[k].type=="path")this.svg.path(d[k].path).attr(d[k].attr);else if(d[k].type=="circle")this.svg.circle(d[k].x,d[k].y,d[k].radius).attr({stroke:"black",fill:"black"});else{var M=this.svg.text(d[k].x,d[k].y,d[k].text).attr(q.PhyloCanvas.Render.Style.text);d[k].attr&&M.attr(d[k].attr),d[k].rotate&&M.rotate(d[k].rotate);var H=M.getBBox();Math.sqrt(H.height*H.height+H.width*H.width)}},draw:function(d){var k,M;if(d.type=="line")k=this.svg.path(["M",d.x1,d.y1,"L",d.x2,d.y2]).attr(q.PhyloCanvas.Render.Style.line);else if(d.type=="path")k=this.svg.path(d.path).attr(d.attr);else if(d.type=="circle")k=this.svg.circle(d.x,d.y,d.radius).attr({stroke:"black",fill:"black"});else if(d.type=="text"){k=this.svg.text(d.x,d.y,d.text).attr(q.PhyloCanvas.Render.Style.text),d.attr&&k.attr(d.attr),d.rotate&&k.rotate(d.rotate);var H=k.getBBox();M=Math.sqrt(H.height*H.height+H.width*H.width)}return[k,M]}};q.PhyloCanvas.Render.Phylogram=function(){var d,k=q.PhyloCanvas.Render.Parameters.Rectangular,M,H,C,b,f,a,o=!0,x=0,w=0,L,z,F,B,N,G,K=[],U=function($,Q,W,I){return["M",$,Q,"L",W,Q,"L",W,I,"L",$,I,"Z"]},X=function($,Q){if($.len&&o==!1&&$.children.length==0&&(x=q.Common.roundFloat(x+b,4)),$.children.length>0){var W=[],I,ie,re,ge,xe,Y,fe;if($.len&&(I=Q,ie=Q=q.Common.roundFloat(Q+C*$.len,4),re=x+$.getMidbranchPosition(o)*b,ge=re,xe=$.red,Y=$.green,fe=$.blue,d.draw(new q.PhyloCanvas.Render.Line(I,ie,re,ge,xe,Y,fe))),$.name){var pe={};if(pe=q.PhyloCanvas.Render.Style.getStyle("bootstrap","text"),$.font_color_hex?pe.fill=$.font_color_hex:pe.fill="#000000",$.uri&&(pe.href=$.uri),$.description&&(pe.title=$.description),$.level==0)var c=x+$.getMidbranchPosition(o)*b;else var c=ge;d.draw(new q.PhyloCanvas.Render.Text((ie||Q)+5,c,$.name,{attr:pe}))}if($.children&&$.children.length)for(var u=0;u<$.children.length;u++){var p=$.children[u];W.push(X(p,Q))}for(var n=[],u=0;u<W.length;u++)W[u][0]&&n.push(W[u][0]),W[u][1]&&n.push(W[u][1]);for(var r=Math.min.apply(null,n),s=Math.max.apply(null,n),h=(r+s)/2,m="",v="",A="",D=0,u=0;u<$.children.length;++u){var T=$.children[u];if(u==0)m=T.red,v=T.green,A=T.blue;else if(m==T.red&&v==T.green&&A==T.blue)D=1;else{D=0;break}}D==0?q.PhyloCanvas.Render.Style.line.stroke="black":(xe=$.children[0].red,Y=$.children[0].green,fe=$.children[0].blue,q.PhyloCanvas.Render.Style.line.stroke=["rgb(",xe,",",Y,",",fe,")"].join("")),$.children.length==2?(xe=$.children[0].red,Y=$.children[0].green,fe=$.children[0].blue,q.PhyloCanvas.Render.Style.line.stroke=["rgb(",xe,",",Y,",",fe,")"].join(""),d.draw(new q.PhyloCanvas.Render.Path(["M",Q+1e-4,r,"L",Q,r,"L",Q,h],{attr:q.PhyloCanvas.Render.Style.line})),xe=$.children[1].red,Y=$.children[1].green,fe=$.children[1].blue,q.PhyloCanvas.Render.Style.line.stroke=["rgb(",xe,",",Y,",",fe,")"].join(""),d.draw(new q.PhyloCanvas.Render.Path(["M",Q,h,"L",Q,s,"L",Q+1e-4,s],{attr:q.PhyloCanvas.Render.Style.line}))):d.draw(new q.PhyloCanvas.Render.Path(["M",Q+1e-4,r,"L",Q,r,"L",Q,s,"L",Q+1e-4,s],{attr:q.PhyloCanvas.Render.Style.line}))}else{if(I=Q,ie=q.Common.roundFloat(Q+C*$.len,2),re=x,ge=x,xe=$.red,Y=$.green,fe=$.blue,$.y=x,K.push($),d.draw(new q.PhyloCanvas.Render.Line(I,ie,re,ge,xe,Y,fe)),k.alignRight&&d.draw(new q.PhyloCanvas.Render.Path(["M",ie,re,"L",k.alignPadding+f,ge],{attr:q.PhyloCanvas.Render.Style.connectedDash})),$.name){var pe={};$.style&&(pe=q.PhyloCanvas.Render.Style.getStyle($.style,"text")),$.font_color_hex?pe.fill=$.font_color_hex:pe.fill="#000000",pe["text-anchor"]="start",$.uri&&(pe.href=$.uri),$.description&&(pe.title=$.description);var V=d.draw(new q.PhyloCanvas.Render.Text(k.alignRight?f+k.bufferInnerLabels+k.alignPadding:ie+k.bufferInnerLabels,ge,$.name,{attr:pe}));w=Math.max(V[1],w),q.PhyloCanvas.Render.Parameters.mouseRollOver&&q.Common.addRaphEventHandler(V[0],"mouseover",q.PhyloCanvas.Render.Parameters.mouseRollOver,{svg:d,node:$,x:ie,y:ge,textEl:V[0]}),q.PhyloCanvas.Render.Parameters.mouseRollOut&&q.Common.addRaphEventHandler(V[0],"mouseout",q.PhyloCanvas.Render.Parameters.mouseRollOut,{svg:d,node:$,x:ie,y:ge,textEl:V[0]}),q.PhyloCanvas.Render.Parameters.onClickAction&&q.Common.addRaphEventHandler(V[0],"click",q.PhyloCanvas.Render.Parameters.onClickAction,{svg:d,node:$,x:ie,y:ge,textEl:V[0]})}o&&(o=!1)}return[re,ge]},ae=function(){y=x+b,z=0,F=k.showScaleBar*C,d.draw(new q.PhyloCanvas.Render.Line(z,F,y,y)),d.draw(new q.PhyloCanvas.Render.Text((z+F)/2,y-8,k.showScaleBar))},de=function($,Q,W){for(var I=(W&&W.bufferInner?W.bufferInner:0)|q.PhyloCanvas.Render.Parameters.binaryChartBufferInner,ie=(W&&W.bufferSiblings?W.bufferSiblings*b:0)|(q.PhyloCanvas.Render.Parameters.binaryChartBufferSiblings<1?b*q.PhyloCanvas.Render.Parameters.binaryChartBufferSiblings:q.PhyloCanvas.Render.Parameters.binaryChartBufferSiblings),re=(W&&W.thickness?W.thickness:0)|q.PhyloCanvas.Render.Parameters.binaryChartThickness,ge=0;ge<K.length;ge++){var xe=K[ge];d.draw(new q.PhyloCanvas.Render.Path(U($+I,xe.y-b/2+ie/2,$+I+re,xe.y+b/2-ie/2),{attr:q.PhyloCanvas.Render.Style.getStyle(xe.chart[Q],"textSecantBg")}))}return $+I+re},ve=function($,Q,W){for(var I=[],ie,re=W&&W.bufferInner?W.bufferInner:0|q.PhyloCanvas.Render.Parameters.barChartBufferInner,ge=W&&W.height?W.height:0|q.PhyloCanvas.Render.Parameters.barChartHeight,xe=W&&W.width?W.width<1?b*W.width:W.width:0|(q.PhyloCanvas.Render.Parameters.barChartWidth<1?b*q.PhyloCanvas.Render.Parameters.barChartWidth:q.PhyloCanvas.Render.Parameters.barChartWidth),Y=0,fe=0;fe<K.length;fe++)I.push(K[fe].chart[Q]);ie=Math.max.apply(null,I),Y=q.Common.roundFloat(ge/ie,4);for(var fe=0;fe<K.length;fe++){var pe=K[fe];d.draw(new q.PhyloCanvas.Render.Path(U($+re,pe.y-xe/2,$+re+Y*pe.chart[Q],pe.y+xe/2),{attr:q.PhyloCanvas.Render.Style.getStyle(pe.chart[Q],"barChart")}))}return $+re+ge};return function($,Q){this.getCanvasSize=function(){return[M,H]},this.getRoot=function(){return Q.getRoot()},Q.getValidate()&&d.draw(0,0,Q.getValidate()),o=!0,d=$;var W=Q.getRoot(),I=Q.getNewickLen();if(M=d.canvasSize[0],H=d.canvasSize[1],B=k.bufferX,N=k.paddingX,G=k.paddingY,a=k.minHeightBetweenLeaves,x=G,C=Math.round((M-B-N*2)/I),b=Math.round((H-G*2)/(k.showScaleBar?W.getCountAllChildren():W.getCountAllChildren()-1)),b<a&&(b=a),f=Math.round(M-B-N*2),(q.PhyloCanvas.Render.Parameters.binaryCharts.length||q.PhyloCanvas.Render.Parameters.barCharts.length)&&(k.alignRight=!0),X(W,N),k.showScaleBar&&ae(),L=f+w+k.bufferInnerLabels,q.PhyloCanvas.Render.Parameters.binaryCharts.length){var ie=q.PhyloCanvas.Render.Parameters.binaryCharts;for(var re in ie)L=de(L,ie[re].chart,ie[re])}if(q.PhyloCanvas.Render.Parameters.barCharts.length){var ge=q.PhyloCanvas.Render.Parameters.barCharts;for(var re in ge)ve(L,ge[re].chart,ge[re])}K=[],typeof bgLabelsHold<"u"&&(bgLabelsHold=[])}}();q.PhyloCanvas.Render.Phylogram.prototype={};q.PhyloCanvas.Render.CircularPhylogram=function(){var d,k=q.PhyloCanvas.Render.Parameters.Circular,M,H,C,b,f,a,o=!0,x=0,w,L,z,F=[],B=[],N,G,K=0,U,X=Math.PI/180;function ae(Y,fe){return fe+=U,[q.Common.roundFloat(w+Y*Math.sin(fe*X),4),q.Common.roundFloat(L+Y*Math.cos(fe*X),4)]}function de(Y){var fe=Q(90-Y-U);if(fe>90&&fe<270){fe+=180;var pe="end"}else var pe="start";return[fe,pe]}function ve(Y,fe,pe,c){var u=ae(Y,fe),p=ae(Y,pe),n=[],r,s=0;return Math.abs(Q(pe-fe))>180?r=1:r=-1,c&&c.invertSecant&&(r*=-1,s=1),c&&c.noMove||n.push("M"),n.push(u[0],u[1],"A",Y,Y,0,r<1?0:1,s,p[0],p[1]),n}function $(Y,fe,pe,c){var u=[],p=ae(fe,Y),n=ae(pe,Y);return c&&c.noMove||u.push("M"),u.push(p[0],p[1],"L",n[0],n[1]),u}function Q(Y){for(;Y>360||Y<0;)Y>360?Y-=360:Y<0&&(Y+=360);return Y}function W(Y,fe,pe,c){if(!fe&&Y.length>1)var c=Y[3],pe=Y[2],fe=Y[1],Y=Y[0];var u=ie("M",ve(Y,pe,c,{noMove:1,invertSecant:0}),"L",ve(fe,c,pe,{noMove:1,invertSecant:1}),"Z");return u}function I(Y,fe){if(fe=fe,Y.len&&(o?x=N||1:Y.children.length==0&&(x=q.Common.roundFloat(x+f,4))),Y.children.length>0){var pe=[],c,u,p;if(c=fe,u=fe+=q.Common.roundFloat(b*Y.len,4),Y.name,Y.children&&Y.children.length)for(var n=0;n<Y.children.length;n++){var r=Y.children[n],s=I(r,fe);s>0&&pe.push(s)}var h=q.Common.roundFloat(Math.min.apply(null,pe),4),m=q.Common.roundFloat(Math.max.apply(null,pe),4);Y.level!=0&&d.draw(new q.PhyloCanvas.Render.Path(ie("M",ae(fe+.01,h),"L",ve(fe,h,m,{noMove:!0}),"L",ae(fe+.01,m)))),Y.len&&(p=q.Common.roundFloat(h+(m-h)/2,4),d.draw(new q.PhyloCanvas.Render.Path($(p,c,u))))}else if(Y.y=x,F.push(Y),c=fe,u=fe=q.Common.roundFloat(fe+b*Y.len),p=x,d.draw(new q.PhyloCanvas.Render.Path($(p,c,u))),d.draw(new q.PhyloCanvas.Render.Path($(p,u,z),{attr:q.PhyloCanvas.Render.Style.connectedDash})),Y.name){var j=ae(z+k.bufferInnerLabels,p),v=de(p),A=v[0],D=v[1],T={};Y.style&&q.Common.apply(T,q.PhyloCanvas.Render.Style.getStyle(Y.style,"text")),Y.font_color_hex?T.fill=Y.font_color_hex:T.fill="#000000",T["text-anchor"]=D,Y.uri&&(T.href=Y.uri),Y.description&&(T.title=Y.description);var V=d.draw(new q.PhyloCanvas.Render.Text(j[0],j[1],Y.name,{attr:T,rotate:[A,j[0],j[1]]}));Y.bgStyle&&B.push([Y.bgStyle,p]);var j=ae(u,p);q.PhyloCanvas.Render.Parameters.mouseRollOver&&q.Common.addRaphEventHandler(V[0],"mouseover",q.PhyloCanvas.Render.Parameters.mouseRollOver,{svg:d,node:Y,x:j[0],y:j[1],textEl:V[0]}),q.PhyloCanvas.Render.Parameters.mouseRollOut&&q.Common.addRaphEventHandler(V[0],"mouseout",q.PhyloCanvas.Render.Parameters.mouseRollOut,{svg:d,node:Y,x:j[0],y:j[1],textEl:V[0]}),q.PhyloCanvas.Render.Parameters.onClickAction&&q.Common.addRaphEventHandler(V[0],"click",q.PhyloCanvas.Render.Parameters.onClickAction,{svg:d,node:Y,x:j[0],y:j[1],textEl:V[0]}),K=Math.max(V[1],K)}return o&&(o=!1),p}function ie(Y){for(var fe=Y,pe=1;pe<arguments.length;pe++)fe=fe.concat(arguments[pe]);return fe}function re(){var u=[];if(B.length>0){if(q.PhyloCanvas.Render.Style.jsphylosvgGradientList)for(var Y=0;Y<q.PhyloCanvas.Render.Style.jsphylosvgGradientList.length;Y++){var fe=q.PhyloCanvas.Render.Style.jsphylosvgGradientList[Y],pe=q.Common.createGradientEl(fe,q.PhyloCanvas.Render.Style[fe],[w,L,z+K+k.bufferOuterLabels]);d.svg.defs.appendChild(pe)}for(var Y=0;Y<B.length;Y++){if(Y!=B.length-1&&B[Y][0]==B[Y+1][0]){B[Y+1][2]=B[Y][2]?B[Y][2]:B[Y][1];continue}var u=W(z,z+K+k.bufferOuterLabels,B[Y][2]?B[Y][2]-f/2:B[Y][1]-f/2,B[Y][1]+f/2),c=q.PhyloCanvas.Render.Style.getStyle(B[Y][0],"textSecantBg"),p=d.draw(new q.PhyloCanvas.Render.Path(u,{attr:c.type?{}:c}));c.type&&c.type=="radialGradient"&&p[0].node.setAttribute("fill","url(#"+c.name+")"),c.type&&c.type=="radialGradient"&&p[0].node.setAttribute("stroke","none"),p[0].toBack()}}var u=W(z,z+K+k.bufferOuterLabels,(N||1)-f/2,360-f/2),p=d.draw(new q.PhyloCanvas.Render.Path(u,{attr:q.PhyloCanvas.Render.Style.textSecantBg}));return p[0].toBack(),z+K+k.bufferOuterLabels}function ge(Y,fe,pe){for(var c=pe&&pe.bufferInner?parseFloat(pe.bufferInner):q.PhyloCanvas.Render.Parameters.binaryChartBufferInner,u=(pe&&pe.bufferSiblings?pe.bufferSiblings*f:0)|(q.PhyloCanvas.Render.Parameters.binaryChartBufferSiblings<1?f*q.PhyloCanvas.Render.Parameters.binaryChartBufferSiblings:q.PhyloCanvas.Render.Parameters.binaryChartBufferSiblings),p=pe&&pe.thickness?parseFloat(pe.thickness):q.PhyloCanvas.Render.Parameters.binaryChartThickness,n=(pe&&pe.disjointed?pe.disjointed:!1)|q.PhyloCanvas.Render.Parameters.binaryChartDisjointed,r=pe&&pe.isInternal?pe.isInternal:!1,s=!0,h,m=0;m<F.length;m++){var v=F[m];if((!F[m+1]||v.chart[fe]!==F[m+1].chart[fe]||n)&&v.chart[fe]!="none"){var A=q.PhyloCanvas.Render.Style.getStyle(v.chart[fe],"textSecantBg");if(r)var D=[z-c-p,z-c,(h||v.y)-f/2+(s&&!n?0:u/2),v.y+f/2-(m==F.length-1&&!n?0:u/2)];else var D=[Y+c,Y+c+p,(h||v.y)-f/2+(s&&!n?0:u/2),v.y+f/2-(m==F.length-1&&!n?0:u/2)];if(A.label){var T=q.PhyloCanvas.Render.Style.getStyle(A.labelStyle,"text"),V=ae((D[0]+D[1])/2,(D[2]+D[3])/2),j=de((D[2]+D[3])/2),oe=Q(j[0]+(T.rotate?parseFloat(T.rotate):0)),be=Q(90-(D[2]+D[3])/2-U);be>90&&be<270&&(oe+=180),T["text-anchor"]||(T["text-anchor"]="middle"),v.font_color_hex?A.fill=v.font_color_hex:A.fill="#000000";var we=d.draw(new q.PhyloCanvas.Render.Text(V[0],V[1],A.label,{attr:T,rotate:oe}));we[0].toBack()}if(A.borderStyle){var ye=q.PhyloCanvas.Render.Style.getStyle(A.borderStyle,"textSecantBg"),Ae=[z,ye.fullsize?D[1]:D[0],D[2],D[3]],Ee=d.draw(new q.PhyloCanvas.Render.Path(W(Ae),{attr:ye}));Ee[0].toBack()}var _e=d.draw(new q.PhyloCanvas.Render.Path(W(D),{attr:A}));_e[0].toBack(),h=0,s=!1}else h||(h=v.y),v.chart[fe]=="none"&&(h=0);s=!1}return r?Y:Y+c+p}function xe(Y,fe,pe){for(var c=[],u,p=pe&&pe.bufferInner?parseFloat(pe.bufferInner):q.PhyloCanvas.Render.Parameters.barChartBufferInner,n=pe&&pe.height?parseFloat(pe.height):q.PhyloCanvas.Render.Parameters.barChartHeight?q.PhyloCanvas.Render.Parameters.barChartHeight:0,r=pe&&pe.width?parseFloat(pe.width)<1?f*parseFloat(pe.width):parseFloat(pe.width):0|(q.PhyloCanvas.Render.Parameters.barChartWidth<1?f*q.PhyloCanvas.Render.Parameters.barChartWidth:q.PhyloCanvas.Render.Parameters.barChartWidth),s=0,h=0;h<F.length;h++)c.push(F[h].chart[fe]);u=Math.max.apply(null,c),s=q.Common.roundFloat(n/u,4);for(var h=0;h<F.length;h++){var m=F[h];m.chart[fe]>0&&d.draw(new q.PhyloCanvas.Render.Path(W(Y+p,Y+p+s*m.chart[fe],m.y-r/2,m.y+r/2),{attr:q.PhyloCanvas.Render.Style.getStyle(m.chart[fe],"barChart")}))}return Y+p+n}return function(Y,fe,pe){if(this.getCanvasSize=function(){return[M,H]},this.getRoot=function(){return fe.getRoot()},fe.getValidate()){Y.draw({type:"text",x:0,y:Y.canvasSize[1]/3,text:fe.getValidate()});return}d=Y;var c=fe.getRoot(),u=fe.getNewickLen();if(M=d.canvasSize[0],H=d.canvasSize[1],w=M/2,L=H/2,C=Math.min.apply(null,[M,H]),pe=k.bufferRadius>1?k.bufferRadius:q.Common.roundFloat(C*k.bufferRadius,4),N=k.bufferAngle,a=k.innerCircleRadius,k.minHeightBetweenLeaves,U=k.initStartAngle,z=Math.round((C-pe-a)/2),b=(z-a)/u,f=q.Common.roundFloat((360-N)/c.getCountAllChildren(),4),I(c,a),G=z+K+k.bufferOuterLabels,q.PhyloCanvas.Render.Parameters.integratedBinaryCharts.length){var p=q.PhyloCanvas.Render.Parameters.integratedBinaryCharts;for(var n in p){var r=p[n].bufferInner?p[n].bufferInner:q.PhyloCanvas.Render.Parameters.binaryChartBufferInner,s=p[n].thickness?p[n].thickness:q.PhyloCanvas.Render.Parameters.binaryChartThickness;G=ge(G-s-r,p[n].chart,p[n])}}if(G=re(),q.PhyloCanvas.Render.Parameters.binaryCharts.length){var h=q.PhyloCanvas.Render.Parameters.binaryCharts;for(var n in h)G=ge(G,h[n].chart,h[n])}if(q.PhyloCanvas.Render.Parameters.barCharts.length){var m=q.PhyloCanvas.Render.Parameters.barCharts;for(var n in m)G=xe(G,m[n].chart,m[n])}F=[],B=[]}}();q.PhyloCanvas.Render.CircularPhylogram.prototype={};var bt=function(){var d=function(H){if(!!H&&typeof H=="object"){let C=function(){};return C.prototype=H,new C}},k=function(H){var C="";!!H&&typeof H=="string"&&(C=H);var b=/^((-)?([0-9]*)((\.{0,1})([0-9]+))?$)/;return b.test(C)},M={xmlToJSON:function(H){try{let o=function(F){return F.replace(/^\s+|\s+$/gm,"")},x=function(F){var B=/-/g,N=String(F).replace(B,"_");return N},w=function(F,B){if(B.attributes.length>0){var N=B.attributes.length-1,G;F._attributes=[];do G=String(x(B.attributes[N].name)),F._attributes.push(G),F[G]=o(B.attributes[N].value);while(N--)}},L=function(F){F.getNodeByAttribute=function(B,N){if(this.length>0){var G,K=this.length-1;try{do if(G=this[K],G[B]==N)return G;while(K--)}catch{return!1}return!1}},F.contains=function(B,N){if(this.length>0){var G=this.length-1;try{do if(this[G][B]==N)return!0;while(G--)}catch{return!1}return!1}},F.indexOf=function(B,N){var G=-1;if(this.length>0){var K=this.length-1;try{do this[K][B]==N&&(G=K);while(K--)}catch{return-1}return G}},F.SortByAttribute=function(B,N){if(this.length){let G=function(U,X){var ae=U[X];return ae=k(ae)?parseFloat(ae):ae,ae},K=function(U,X){var ae=0,de,ve;return de=G(U,B),ve=G(X,B),de<ve?ae=-1:ve<de&&(ae=1),N&&(ae=N.toUpperCase()=="DESC"?0-ae:ae),ae};this.sort(K)}},F.SortByValue=function(B){if(this.length){let N=function(K){var U=K.Text;return U=k(U)?parseFloat(U):U,U},G=function(K,U){var X=0,ae,de;return ae=N(K),de=N(U),ae<de?X=-1:de<ae&&(X=1),B&&(X=B.toUpperCase()=="DESC"?0-X:X),X};this.sort(G)}},F.SortByNode=function(B,N){if(this.length){let G=function(U,X){var ae=U[X][0].Text;return ae=k(ae)?parseFloat(ae):ae,ae},K=function(U,X){var ae=0,de,ve;return de=G(U,B),ve=G(X,B),de<ve?ae=-1:ve<de&&(ae=1),N&&(ae=N.toUpperCase()=="DESC"?0-ae:ae),ae};this.sort(K)}}},z=function(F,B){var N,G,K,U="";if(!B)return null;if(B.attributes.length>0&&w(F,B),F.Text="",B.hasChildNodes()){var X=B.childNodes.length-1,ae=0;do switch(G=B.childNodes[ae],G.nodeType){case 1:F._children=[],N=G.localName?G.localName:G.baseName,N=x(N),U!=N&&F._children.push(N),F[N]||(F[N]=[]),K={},F[N].push(K),G.attributes.length>0&&w(K,G),F[N].contains||L(F[N]),U=N,G.hasChildNodes()&&z(K,G);break;case 3:F.Text+=o(G.nodeValue);break;case 4:F.Text+=G.text?o(G.text):o(G.nodeValue);break}while(ae++<X)}};if(!H)return null;var C={};C.typeOf="JSXBObject";var b=H.nodeType==9?H.documentElement:H;if(C.RootName=b.nodeName||"",H.nodeType==3||H.nodeType==4)return H.nodeValue;var f=function(){var F={activate:function(){var B=[];return B&&(B.getNodesByAttribute=function(N,G){if(!!B&&B.length>0){var K=[],U,X=B.length-1;try{do U=B[X],U[N]===G&&K.push(U);while(X--);return K.reverse(),K}catch{return null}return null}},B.getNodeByAttribute=function(N,G){if(!!B&&B.length>0){var K,U=B.length-1;try{do if(K=B[U],K[N]===G)return K;while(U--)}catch{return null}return null}},B.getNodesByValue=function(N){if(!!B&&B.length>0){var G=[],K,U=B.length-1;try{do K=B[U],!!K.Text&&K.Text===N&&G.push(K);while(U--);return G}catch{return null}return null}},B.contains=function(N,G){if(!!B&&B.length>0){var K=B.length-1;try{do if(B[K][N]===G)return!0;while(K--)}catch{return!1}return!1}},B.indexOf=function(N,G){var K=-1;if(!!B&&B.length>0){var U=B.length-1;try{do B[U][N]===G&&(K=U);while(U--)}catch{return-1}return K}},B.SortByAttribute=function(N,G){if(!!B&&B.length>0){let K=function(X,ae){var de=X[ae];return de=bam.validation.isNumeric(de)?parseFloat(de):de,de},U=function(X,ae){var de,ve;de=K(X,N),ve=K(ae,N);var $=de<ve?-1:ve<de?1:0;return G&&($=G.toUpperCase()==="DESC"?0-$:$),$};B.sort(U)}},B.SortByValue=function(N){if(!!B&&B.length>0){let G=function(U){var X=U.Text;return X=bam.validation.isNumeric(X)?parseFloat(X):X,X},K=function(U,X){var ae,de;ae=G(U),de=G(X);var ve=ae<de?-1:de<ae?1:0;return N&&(ve=N.toUpperCase()==="DESC"?0-ve:ve),ve};B.sort(K)}},B.SortByNode=function(N,G){if(!!B&&B.length>0){let K=function(X,ae){var de=X[ae][0].Text;return de=bam.validation.isNumeric(de)?parseFloat(de):de,de},U=function(X,ae){var de,ve;de=K(X,N),ve=K(ae,N);var $=de<ve?-1:ve<de?1:0;return G&&($=G.toUpperCase()==="DESC"?0-$:$),$};B.sort(U)}}),B}};return F}(),a=function(){var F=d(f);return F.activate()};return z(C,b),H=null,b=null,C}catch{return null}},textToXML:function(H){var C=null;try{C=document.all?new ActiveXObject("Microsoft.XMLDOM"):new DOMParser,C.async=!1}catch{throw new Error("XML Parser could not be instantiated")}var b;try{document.all?b=C.loadXML(H)?C:!1:b=C.parseFromString(H,"text/xml")}catch{throw new Error("Error parsing XML string")}return b}};return M}();const Ie={};Ie.defaults={skip_sgml:!1,syncope:!1};var Tn=Ie.schemes={tamil:{vowels:["\u0B85","\u0B86","\u0B87","\u0B88","\u0B89","\u0B8A","\u{1130B}","\u{11360}","\u{1130C}","\u{11361}","\u0B8E","\u0B8F","\u0B90","\u0B92","\u0B93","\u0B94"],vowel_marks:["\u0BBE","\u0BBF","\u0BC0","\u0BC1","\u0BC2","\u{11343}","\u{11344}","\u{11362}","\u{11363}","\u0BC6","\u0BC7","\u0BC8","\u0BCA","\u0BCB","\u0BCC"],other_marks:["\u{11302}","\u{11303}","\u{11301}","","","\u0B83"],virama:["\u0BCD"],consonants:["\u0B95","\u{11316}","\u{11317}","\u{11318}","\u0B99","\u0B9A","\u{1131B}","\u0B9C","\u{1131D}","\u0B9E","\u0B9F","\u{11320}","\u{11321}","\u{11322}","\u0BA3","\u0BA4","\u{11325}","\u{11326}","\u{11327}","\u0BA8","\u0BAA","\u{1132B}","\u{1132C}","\u{1132D}","\u0BAE","\u0BAF","\u0BB0","\u0BB2","\u0BB5","\u0BB6","\u0BB7","\u0BB8","\u0BB9","\u0BB3","\u0BB4","\u0BB1","\u0BA9"],symbols:["\u0BE6","\u0BE7","\u0BE8","\u0BE9","\u0BEA","\u0BEB","\u0BEC","\u0BED","\u0BEE","\u0BEF","\u0BD0","","\u{1133D}","\u0964","\u0965","\u0BF0","\u0BF1","\u0BF2"]},grantha:{vowels:["\u{11305}","\u{11306}","\u{11307}","\u{11308}","\u{11309}","\u{1130A}","\u{1130B}","\u{11360}","\u{1130C}","\u{11361}","\u0B8E","\u{1130F}","\u{11310}","\u0B92","\u{11313}","\u{11314}"],vowel_marks:["\u{1133E}","\u{1133F}","\u{11340}","\u{11341}","\u{11342}","\u{11343}","\u{11344}","\u{11362}","\u{11363}","\u0BC6","\u{11347}","\u{11348}","\u0BCA","\u{1134B}","\u{1134C}"],other_marks:["\u{11302}","\u{11303}","\u{11301}","\u{1135E}","\u{1135F}","\u0B83"],virama:["\u{1134D}"],consonants:["\u{11315}","\u{11316}","\u{11317}","\u{11318}","\u{11319}","\u{1131A}","\u{1131B}","\u{1131C}","\u{1131D}","\u{1131E}","\u{1131F}","\u{11320}","\u{11321}","\u{11322}","\u{11323}","\u{11324}","\u{11325}","\u{11326}","\u{11327}","\u{11328}","\u{1132A}","\u{1132B}","\u{1132C}","\u{1132D}","\u{1132E}","\u{1132F}","\u{11330}","\u{11332}","\u{11335}","\u{11336}","\u{11337}","\u{11338}","\u{11339}","\u{11333}","\u0BB4","\u0BB1","\u0BA9"],symbols:["\u0BE6","\u0BE7","\u0BE8","\u0BE9","\u0BEA","\u0BEB","\u0BEC","\u0BED","\u0BEE","\u0BEF","\u{11350}","","\u{1133D}","\u0964","\u0965","\u0BF0","\u0BF1","\u0BF2"]},malayalam:{vowels:["\u0D05","\u0D06","\u0D07","\u0D08","\u0D09","\u0D0A","\u0D0B","\u0D60","\u0D0C","\u0D61","\u0D0E","\u0D0F","\u0D10","\u0D12","\u0D13","\u0D14"],vowel_marks:["\u0D3E","\u0D3F","\u0D40","\u0D41","\u0D42","\u0D43","\u0D44","\u0D62","\u0D63","\u0D46","\u0D47","\u0D48","\u0D4A","\u0D4B","\u0D4C"],other_marks:["\u0D02","\u0D03","\u0D01","","",""],virama:["\u0D4D"],consonants:["\u0D15","\u0D16","\u0D17","\u0D18","\u0D19","\u0D1A","\u0D1B","\u0D1C","\u0D1D","\u0D1E","\u0D1F","\u0D20","\u0D21","\u0D22","\u0D23","\u0D24","\u0D25","\u0D26","\u0D27","\u0D28","\u0D2A","\u0D2B","\u0D2C","\u0D2D","\u0D2E","\u0D2F","\u0D30","\u0D32","\u0D35","\u0D36","\u0D37","\u0D38","\u0D39","\u0D33","\u0D34","\u0D31","\u0D29"],symbols:["\u0D66","\u0D67","\u0D68","\u0D69","\u0D6A","\u0D6B","\u0D6C","\u0D6D","\u0D6E","\u0D6F","\u0D12\u0D02","","\u0D3D","\u0964","\u0965","\u0D70","\u0D71","\u0D72"]},newa:{vowels:["\u{11400}","\u{11401}","\u{11402}","\u{11403}","\u{11404}","\u{11405}","\u{11406}","\u{11407}","\u{11408}","\u{11409}","","\u{1140A}","\u{1140B}","","\u{1140C}","\u{1140D}"],vowel_marks:["\u{11435}","\u{11436}","\u{11437}","\u{11438}","\u{11439}","\u{1143A}","\u{1143B}","\u{1143C}","\u{1143D}","","\u{1143E}","\u{1143F}","","\u{11440}","\u{11441}"],other_marks:["\u{11444}","\u{11445}","\u{11443}","\u{11460}","\u{11461}",""],virama:["\u{11442}"],consonants:["\u{1140E}","\u{1140F}","\u{11410}","\u{11411}","\u{11412}","\u{11414}","\u{11415}","\u{11416}","\u{11417}","\u{11418}","\u{1141A}","\u{1141B}","\u{1141C}","\u{1141D}","\u{1141E}","\u{1141F}","\u{11420}","\u{11421}","\u{11422}","\u{11423}","\u{11425}","\u{11426}","\u{11427}","\u{11428}","\u{11429}","\u{1142B}","\u{1142C}","\u{1142E}","\u{11430}","\u{11431}","\u{11432}","\u{11433}","\u{11434}"],symbols:["\u{11450}","\u{11451}","\u{11452}","\u{11453}","\u{11454}","\u{11455}","\u{11456}","\u{11457}","\u{11458}","\u{11459}","\u{11449}","","\u{11447}","\u{1144B}","\u{1144C}"]},sarada:{vowels:["\u{11183}","\u{11184}","\u{11185}","\u{11186}","\u{11187}","\u{11188}","\u{11189}","\u{1118A}","\u{1118B}","\u{1118C}","","\u{1118D}","\u{1118E}","","\u{1118F}","\u{11190}"],vowel_marks:["\u{111B3}","\u{111B4}","\u{111B5}","\u{111B6}","\u{111B7}","\u{111B8}","\u{111B9}","\u{111BA}","\u{111BB}","","\u{111BC}","\u{111BD}","","\u{111BE}","\u{111BF}"],other_marks:["\u{11181}","\u{11182}","\u{11180}","\u{111C1}","\u{111C2}",""],virama:["\u{111C0}"],consonants:["\u{11191}","\u{11192}","\u{11193}","\u{11194}","\u{11195}","\u{11196}","\u{11197}","\u{11198}","\u{11199}","\u{1119A}","\u{1119B}","\u{1119C}","\u{1119D}","\u{1119E}","\u{1119F}","\u{111A0}","\u{111A1}","\u{111A2}","\u{111A3}","\u{111A4}","\u{111A5}","\u{111A6}","\u{111A7}","\u{111A8}","\u{111A9}","\u{111AA}","\u{111AB}","\u{111AC}","\u{111AE}","\u{111AF}","\u{111B0}","\u{111B1}","\u{111B2}","\u{111AD}"],symbols:["\u{111D0}","\u{111D1}","\u{111D2}","\u{111D3}","\u{111D4}","\u{111D5}","\u{111D6}","\u{111D7}","\u{111D8}","\u{111D9}","\u{111C4}","","\u{111C1}","\u{111C5}","\u{111C6}"]},nandinagari:{vowels:["\u{119A0}","\u{119A1}","\u{119A2}","\u{119A3}","\u1194","\u{119A5}","\u{119A6}","\u{119A7}","\u{119C9}\u{119D6}","\u{119C9}\u{119D7}","","\u{119AA}","\u{119AB}","","\u{119AC}","\u{119AD}"],vowel_marks:["\u{119D1}","\u{119D2}","\u{119D3}","\u{119D4}","\u{119D5}","\u{119D6}","\u{119D7}","\u{119C9}\u{119D6}","\u{119C9}\u{119D7}","","\u{119DA}","\u{119DB}","","\u{119DC}","\u{119DD}"],other_marks:["\u{119DE}","\u{119DF}","","",""],virama:["\u{119E0}"],consonants:["\u{119AE}","\u{119AF}","\u{119B0}","\u{119B1}","\u11B2","\u{119B3}","\u{119B4}","\u{119B5}","\u{119B6}","\u{119B7}","\u{119B8}","\u{119B9}","\u{119BA}","\u{119BB}","\u{119BC}","\u{119BD}","\u{119BE}","\u{119BF}","\u{119C0}","\u{119C1}","\u{119C2}","\u{119C3}","\u{119C4}","\u{119C5}","\u{119C6}","\u{119C7}","\u{119C8}","\u{119C9}","\u{119CA}","\u{119CB}","\u{119CC}","\u{119CD}","\u{119CE}","\u{119CF}","","\u{119D0}"],symbols:["\u0CE6","\u0CE7","\u0CE8","\u0CE9","\u0CEA","\u0CEB","\u0CEC","\u0CED","\u0CEE","\u0CEF","\u{119AC}\u{119DE}","","\u{119E1}","\u0964","\u0965"]},bengali:{vowels:["\u0985","\u0986","\u0987","\u0988","\u0989","\u098A","\u098B","\u09E0","\u098C","\u09E1","","\u098F","\u0990","","\u0993","\u0994"],vowel_marks:["\u09BE","\u09BF","\u09C0","\u09C1","\u09C2","\u09C3","\u09C4","\u09E2","\u09E3","","\u09C7","\u09C8","\u09CB","\u09CC"],other_marks:["\u0982","\u0983","\u0981","","",""],virama:["\u09CD"],consonants:["\u0995","\u0996","\u0997","\u0998","\u0999","\u099A","\u099B","\u099C","\u099D","\u099E","\u099F","\u09A0","\u09A1","\u09A2","\u09A3","\u09A4","\u09A5","\u09A6","\u09A7","\u09A8","\u09AA","\u09AB","\u09AC","\u09AD","\u09AE","\u09AF","\u09B0","\u09B2","\u09AC","\u09B6","\u09B7","\u09B8","\u09B9","\u0933","","","","\u09AF\u09BC","","","","","","","\u09DC","\u09DD"],symbols:["\u09E6","\u09E7","\u09E8","\u09E9","\u09EA","\u09EB","\u09EC","\u09ED","\u09EE","\u09EF","\u0993\u0981","","\u09BD","\u0964","\u0965"]},devanagari:{vowels:["\u0905","\u0906","\u0907","\u0908","\u0909","\u090A","\u090B","\u0960","\u090C","\u0961","\u090E","\u090F","\u0910","\u0912","\u0913","\u0914"],vowel_marks:["\u093E","\u093F","\u0940","\u0941","\u0942","\u0943","\u0944","\u0962","\u0963","\u0946","\u0947","\u0948","\u094A","\u094B","\u094C","\u094E","\u094E\u0947","\u094E\u093E","\u094E\u094B"],other_marks:["\u0902","\u0903","\u0901","\u1CF5","\u1CF6",""],virama:["\u094D"],consonants:["\u0915","\u0916","\u0917","\u0918","\u0919","\u091A","\u091B","\u091C","\u091D","\u091E","\u091F","\u0920","\u0921","\u0922","\u0923","\u0924","\u0925","\u0926","\u0927","\u0928","\u092A","\u092B","\u092C","\u092D","\u092E","\u092F","\u0930","\u0932","\u0935","\u0936","\u0937","\u0938","\u0939","\u0933","\u0934","\u0931","\u0928\u093C","\u092F\u093C","\u0915\u093C","\u0916\u093C","\u0917\u093C","\u091C\u093C","\u091D\u093C","\u092B\u093C","\u0921\u093C","\u0922\u093C","\u0925\u093C","\u0927\u093C","\u0935\u093C"],symbols:["\u0966","\u0967","\u0968","\u0969","\u096A","\u096B","\u096C","\u096D","\u096E","\u096F","\u0950","\uA8FD","\u093D","\u0964","\u0965"],zwj:["\u200D"],skip:[""],accent:["\u0951","\u0952"],combo_accent:"\u0903\u0951 \u0903\u0952 \u0902\u0951 \u0902\u0952".split(" ")},telugu:{vowels:["\u0C05","\u0C06","\u0C07","\u0C08","\u0C09","\u0C0A","\u0C0B","\u0C60","\u0C0C","\u0C61","\u0C0E","\u0C0F","\u0C10","\u0C12","\u0C13","\u0C14"],vowel_marks:["\u0C3E","\u0C3F","\u0C40","\u0C41","\u0C42","\u0C43","\u0C44","\u0C62","\u0C63","\u0C46","\u0C47","\u0C48","\u0C4A","\u0C4B","\u0C4C"],other_marks:["\u0C02","\u0C03","\u0C00","","",""],virama:["\u0C4D"],consonants:["\u0C15","\u0C16","\u0C17","\u0C18","\u0C19","\u0C1A","\u0C1B","\u0C1C","\u0C1D","\u0C1E","\u0C1F","\u0C20","\u0C21","\u0C22","\u0C23","\u0C24","\u0C25","\u0C26","\u0C27","\u0C28","\u0C2A","\u0C2B","\u0C2C","\u0C2D","\u0C2E","\u0C2F","\u0C30","\u0C32","\u0C35","\u0C36","\u0C37","\u0C38","\u0C39","\u0C33","\u0C34","\u0C31"],symbols:["\u0C66","\u0C67","\u0C68","\u0C69","\u0C6A","\u0C6B","\u0C6C","\u0C6D","\u0C6E","\u0C6F","\u0C13\u0C02","","\u0C3D","\u0964","\u0965"]},iast:{vowels:["a","\u0101","i","\u012B","u","\u016B","\u1E5B","\u1E5D","l\u0325","l\u0325\u0304","e","\u0113","ai","o","\u014D","au","\xEA","a\xEE","\xF4","a\xFB"],other_marks:["\u1E43","\u1E25","m\u0310","\u1E96","\u1E2B","\u1E35"],virama:[""],consonants:["k","kh","g","gh","\u1E45","c","ch","j","jh","\xF1","\u1E6D","\u1E6Dh","\u1E0D","\u1E0Dh","\u1E47","t","th","d","dh","n","p","ph","b","bh","m","y","r","l","v","\u015B","\u1E63","s","h","\u1E37","\u1E3B","\u1E5F","\u1E49","\u1E8F","q","qh","\u0121","z","zh","f","\u1E59","\u1E59h","\u1E6Bh","\u1E0Bh","w"],symbols:["0","1","2","3","4","5","6","7","8","9","o\u1E41","o\u1E3F","'","|","||","\u2070","\u2070\u2070","\u2070\u2070\u2070"]}},wn={},Nn={},Rt={};Ie.isRomanScheme=function(d){return wn.hasOwnProperty(d)};Ie.addBrahmicScheme=function(d,k){Ie.schemes[d]=k};Ie.addRomanScheme=function(d,k){"vowel_marks"in k||(k.vowel_marks=k.vowels.slice(1)),Ie.schemes[d]=k,wn[d]=!0};(function(){for(var d=["iast"],k=0,M;M=d[k];k++)Ie.addRomanScheme(M,Tn[M])})();var Mn=function(d,k){var M=Nn[d]||{},H={},C=Ie.schemes[d],b={},f=[],a={},o=Ie.schemes[k];for(var x in C)if(!!C.hasOwnProperty(x)){var w=C[x],L=o[x];if(L!==void 0)for(var z=0;z<w.length;z++){var F=w[z],B=L[z],N=M[F]||[],G=N.length,K=0;for(f.push(F.length),K=0;K<G;K++)f.push(N[K].length);if(x==="vowel_marks"||x==="virama")for(a[F]=B,K=0;K<G;K++)a[N[K]]=B;else{for(b[F]=B,K=0;K<G;K++)b[N[K]]=B;if(x==="consonants"||x==="other")for(H[F]=B,K=0;K<G;K++)H[N[K]]=B}}}return{consonants:H,fromRoman:Ie.isRomanScheme(d),letters:b,marks:a,maxTokenLength:Math.max.apply(Math,f),toRoman:Ie.isRomanScheme(k),virama:o.virama}},Dn=function(d,k,M){for(var H=[],C=k.consonants,b=d.length,f=!1,a=k.letters,o=k.marks,x=k.maxTokenLength,w=M.skip_sgml,L=M.syncope,z,F,B="",N=k.toRoman,G=k.virama,K=!1,U=!1,X=!1,ae=0,de;(de=d.charAt(ae))||B;ae++){var ve=x-B.length;if(!(ve>0&&ae<b&&(B+=de,ve>1)))for(var $=0;$<x;$++){var Q=B.substr(0,x-$);if(K===!0)K=Q!==">";else if(Q==="<")K=w;else if(Q==="##"){X=!X,B=B.substr(2);break}if(U=K||X,(z=a[Q])!==void 0&&!U){N?H.push(z):(f?(F=o[Q])?H.push(F):Q!=="a"&&(H.push(G),H.push(z)):H.push(z),f=Q in C),B=B.substr(x-$);break}else $===x-1&&(f&&(f=!1,L||H.push(G)),H.push(Q),B=B.substr(1))}}return f&&!L&&H.push(G),H.join("")},In=function(d,k){for(var M=[],H=k.consonants,C=!1,b=k.letters,f=k.marks,a=d.length,o=k.maxTokenLength,x,w="",L=k.toRoman,z=!1,F=0,B;(B=d.charAt(F))||w;F++){var N=o-w.length;if(!(N>0&&F<a&&(w+=B,N>1)))for(var G=0;G<o;G++){var K=w.substr(0,o-G);if((x=f[K])!==void 0&&!z){M.push(x),C=!1,w=w.substr(o-G);break}else if(x=b[K]){C&&(M.push("a"),C=!1),M.push(x),C=L&&K in H,w=w.substr(o-G);break}else G===o-1&&(C&&(M.push("a"),C=!1),M.push(K),w=w.substr(1))}}return C&&M.push("a"),M.join("")};Ie.t=function(d,k,M,H){H=H||{};var C=Rt.options||{},b=Ie.defaults,f=Rt.from===k&&Rt.to===M,a;for(var o in b)if(b.hasOwnProperty(o)){var x=b[o];o in H&&(x=H[o]),H[o]=x,x!==C[o]&&(f=!1)}return f?a=Rt.map:(a=Mn(k,M),Rt={from:k,map:a,options:H,to:M}),a.fromRoman?Dn(d,a,H):In(d,a)};const Fn=function(){const d=[{name:"valapalagilaka",search:"\u1E59",replace:()=>"r"},{name:"short e",search:"\u1EBD",replace:()=>"e"},{name:"short o",search:"\xF5",replace:()=>"o"},{name:"p\u1E5B\u1E63\u1E6Dham\u0101tr\u0101 e",search:"\xEA",replace:()=>"e"},{name:"p\u1E5B\u1E63\u1E6Dham\u0101tr\u0101 o",search:"\xF4",replace:()=>"o"},{name:"p\u1E5B\u1E63\u1E6Dham\u0101tr\u0101 ai",search:"\xCA",replace:()=>"E"},{name:"p\u1E5B\u1E63\u1E6Dham\u0101tr\u0101 au",search:"\xD4",replace:()=>"O"},{name:"candrabindu",search:"m\u0310",replace:()=>"M"},{name:"o\u1E43k\u0101ras",search:"o\u1E41",replace:()=>"oM"},{name:"additional punctuation",search:"[()\\[\\],;?!|\xA6_\\-\u2013\u2014\u2015=+\\d.\\/]+",replace:()=>""},{name:"geminated aspirated consonants",search:"(?:kK|gG|cC|jJ|wW|qQ|tT|dD|pP|bB)",replace:b=>b[0].slice(-1)},{name:"geminated m after h",search:"(?:Mhm|hmm)",replace:()=>"hm"},{name:"geminated t",search:"([rfi]|p[aA])tt|tt(?=[rvy]\\S)",replace:b=>b[1]?`${b[1]}t`:"t"},{name:"geminated consonants after r",search:"([rf]\\s*)([kgcjwqdpbRnmyvl])\\2{1,2}",replace:b=>`${b[1]}${b[2]}`},{name:"final nasal variants",search:"(?:[MN][lSs]|nn)(?!\\S)",replace:()=>"n"},{name:"internal nasal variants",search:"[mnNYR](?=[pPbBmdDtTnwWqQcCjJkKgG])",replace:()=>"M"},{name:"final anusv\u0101ra variants",search:"M?[mN](?!\\S)|n(?=\\s+[tdn])|Y(?=\\s+[jc])",replace:()=>"M"},{name:"visarga a\u1E25 before voiced consonants",search:"(?<!\\sB)(?:a[Hr]|[o])(?=\\s+['gGjJqQdDnbBmrylvh])",replace:()=>"aH"},{name:"visarga a\u1E25 before vowels",search:"aH(?=\\s+[AiIeuUof])",replace:()=>"a"},{name:"visarga a\u1E25 before unvoiced consonants and space + anusv\u0101ra",search:"o\\s+(?=[kKcCwWtTpPszSM])",replace:()=>"aH a"},{name:"visarga \u0101\u1E25 variants",search:"AH(?=\\s+[aAiIeEuUogGjJqQdDbBnmyrlvh])",replace:()=>"A"},{name:"other visarga variants",search:"H?[rszS](?!\\S)",replace:()=>"H"},{name:"superfluous avagrahas",search:"(\\S)'+",replace:b=>b[1]},{name:"double avagrahas",search:"''",replace:()=>"A"},{name:"avagrahas",search:"'",replace:()=>"a"},{name:"internal visarga variants",search:"z(?=[kK])|s(?=s)",replace:()=>"H"},{name:"final au/\u0101v",search:"Av(?!\\S)",replace:()=>"O"},{name:"final su",search:"(?<=[sz])v(?=\\s+[aAiIuUoOeE])",replace:()=>"u"},{name:"final i",search:"i(?=\\s+[aAuUoOeE])",replace:()=>"y"},{name:"kcch/k\u015B",search:"k(\\s*)(?:S|c?C)",replace:b=>`k${b[1]}S`},{name:"c\u015B/t\u015B",search:"[tc](\\s*)S",replace:b=>`c${b[1]}C`},{name:"cch/ch",search:"([aAiIuUeEoO])C",replace:b=>`${b[1]}cC`},{name:"final t + hi",search:"d(\\s+)D(?=[iy](?:\\s|$))",replace:b=>`t${b[1]}h`},{name:"final t + voiced syllable",search:"d(?=(?:\\s+[aAiIeEuUoOgGdDbByrv]|\\s*$))",replace:()=>"t"},{name:"final t + n/m",search:"([ai])n(?=\\s+[nm])",replace:b=>`${b[1]}t`},{name:"final t + c/j",search:"j(?=\\s+j)|c(?=\\s+c)",replace:()=>"t"},{name:"i/y + vowel",search:"y(?=\\s+[aAuUeEoO])",replace:()=>"i"},{name:"bhd for bdh",search:"Bd",replace:()=>"bD"}],k={none:{name:"remove spaces",search:"\\s",replace:()=>""},collapse:{name:"collapse spaces",search:"\\s+",replace:()=>" "}},M=function(b,f){const a=f.join(""),o=[],x=[...a.matchAll(b.search)];let w=0,L=null;for(const z of f){const F=w+z.length;let B=z,N=0;if(L)if(L.length<=z.length)B=H(z,0,L.length,L.text),N=L.text.length-L.length,L=null;else{B=L.text.slice(0,z.length);const K=L.text.slice(z.length);L={length:L.length-z.length,text:K};continue}for(;x.length>0&&x[0].index<F;){const G=x.shift(),K=G.index-w+N,U=b.replace(G);if(G.index+G[0].length<F)B=H(B,K,G[0].length,U),N=N+U.length-G[0].length;else{const X=z.length-K+N,ae=U.slice(0,X);B=B.slice(0,K)+ae;const de=U.slice(X);L={length:G[0].length-X,text:de}}}o.push(B),w=F}return o},H=function(b,f,a,o){return b.slice(0,f)+o+b.slice(f+a)};return function(b){let f=b.map(a=>Ie.t(a,"iast","slp1"));for(const a of[...d,k.none])f=M(a,f);return f.map(a=>Ie.t(a,"slp1","iast"))}}(),it={smush:function(d,k){return d.toLowerCase().replace(/([ḍdrmvynhs]) ([aāiīuūṛeoéó])/g,"$1$2"+k).replace(/([kgcjṭḍtdpb]) h/g,"$1\u200C"+k+"h").replace(/([kgcjñḍtdnpbmrlyvśṣsṙ]) ([kgcjṭḍtdnpbmyrlvśṣshḻ])/g,"$1"+k+"$2").replace(/([oóeéā]) ([ṃ'])/g,"$1"+k+"$2").replace(/^ṃ/,"'\u200D\u1E43").replace(/^ḥ/,"'\u200D\u1E25").replace(/^_y/,"'\u200Dy").replace(/ü/g,"\u200Cu").replace(/ï/g,"\u200Ci").replace(/_{1,2}(?=\s*)/g,function(M){if(M==="__")return"\u200D";if(M==="_")return"\u200C"})},iast:function(d,k){const M=k||"devanagari";return Ie.t(d,M,"iast",{skip_sgml:!0})},devanagari:function(d,k){const M=k||"",H={skip_sgml:!0},C=d.replace(/ṙ/g,"r").replace(/^_ā/,"\u093D\u200D\u093E"),b=it.smush(C,M);return Ie.t(b,"iast","devanagari",H).replace(/¯/g,"\uA8FB")},malayalam:function(d,k){const M=k||"",H={skip_sgml:!0},C={\u0D15:"\u0D7F",\u0D24:"\u0D7D",\u0D28:"\u0D7B",\u0D2E:"\u0D54",\u0D30:"\u0D7C"},b=d.replace(/^_ā/,"\u0D3D\u200D\u0D3E"),f=it.smush(b,M).replace(/e/g,"\u1EBD").replace(/o/g,"\xF5").replace(/ṙ/g,"r").replace(/ṁ/g,"\u1E43").replace(/ḿ/g,"\u1E43").replace(/í/g,"i").replace(/ú/g,"u").replace(/é/g,"e");return Ie.t(f,"iast","malayalam",H).replace(/(^|[^്])ര്(?=\S)/g,"$1\u0D4E").replace(/([കതനമര])്(?![^\s\u200C,—’―])/g,function(o,x){return C[x]})},grantha:function(d,k){const M=k||"",H={skip_sgml:!0},C=new Map([["\u0D38","\uE1D3"],["\u0D30","\u0D7C"],["\u0D2F","\uE1CB"],["\u0D1A","\uE1B6"],["\u0D26","\uE1C2"],["\u0D36","\uE1D2"]]),b=new RegExp("(["+[...C.keys()].join("")+"])\u0D4D(?![^\u200C ,\u2014\u2019\u2015])","g"),f=d.replace(/^_ā/,"\u0D3D\u200D\u0D3E"),a=it.smush(f,M).replace(/e/g,"\u1EBD").replace(/o/g,"\xF5").replace(/ṙ/g,"r").replace(/ṁ/g,"\u1E43").replace(/ḿ/g,"\u1E43").replace(/í/g,"i").replace(/ú/g,"u").replace(/é/g,"e");return Ie.t(a,"iast","malayalam",H).replace(/(^|[^്])ര്(?=\S)/g,"$1\u0D4E").replace(b,(x,w)=>C.get(w)).replace(/ക്ഷി/g,"\u0B95\u0BCD\u0BB7\u0BBF")},tamil:function(d){it.smush(d);const k=new Map([["\u0B82","\u{11300}"],["\u0BBE","\u{1133E}"],["\u0BBF","\u{1133F}"],["\u0BC0","\u{11340}"],["\u0BC1","\u{11341}"],["\u0BC2","\u{11342}"],["\u0BC6","\u{11347}"],["\u0BC7","\u{11347}"],["\u0BC8","\u{11348}"],["\u0BCA","\u{1134B}"],["\u0BCB","\u{1134B}"],["\u0BCC","\u{1134C}"],["\u0BCD","\u{1134D}"],["\u0BD7","\u{11357}"]]),M=["\u{11316}","\u{11317}","\u{11318}","\u{1131B}","\u{1131D}","\u{11320}","\u{11321}","\u{11322}","\u{11325}","\u{11326}","\u{11327}","\u{1132B}","\u{1132C}","\u{1132D}"],H=d.replace(/([kṅcñṭṇtnpmyrlvḻḷṟṉ])\s+([aāiīuūeēoō])/g,"$1$2").replace(/(^|\s)_ā/g,"$1\u0B85\u200D\u0BBE").replace(/(\S)([AĀIĪUŪEĒOŌ])/g,"$1\u200C$2").replace(/(\S)·/g,"$1\u200C").toLowerCase(),C=new RegExp(`([${M.join("")}])([${[...k.keys()].join("")}])`,"g");return Ie.t(H,"iast","tamil").replace(C,function(f,a,o){return a+k.get(o)})},telugu:function(d,k){var M=k||"";const H={skip_sgml:!0},C=d.replace(/^_ā/,"\u0C3D\u200D\u0C3E"),b=it.smush(C,M).replace(/e/g,"\u1EBD").replace(/o/g,"\xF5").replace(/ṙ/g,"r\u200D").replace(/ṁ/g,"\u1E43").replace(/ḿ/g,"\u1E43").replace(/í/g,"i").replace(/ú/g,"u").replace(/é/g,"e");return Ie.t(b,"iast","telugu",H)}},Yt=function(d,k,M=!1,H="sa"){const C=it[k],b=d.cloneNode(!0),f=function(a,o){let x=a.childNodes;for(let w of x)if(w.nodeType!==8){if(w.nodeType===3){if(o!=="sa")continue;w.data=C(w.data,M)}else if(w.hasChildNodes()){let L=w.getAttribute("lang")||o;L==="sa"&&w.classList.contains("subst")&&qn(w,k),f(w,L)}}};return f(b,H),b},xn=function(d,k=!1){if(d.nodeType===3)return d;const M=document.createTreeWalker(d,NodeFilter.SHOW_TEXT,null,!1);if(k){let H;for(;M.nextNode();)H=M.currentNode;return H}else return M.nextNode},qn=function(d,k){if(d.firstChild.nodeType!==3&&d.lastChild.nodeType!==3)return;const M=d.childNodes,H=/^[aāiīuūeoṛṝḷṃḥ]/,C=/[kgṅcjñṭḍṇtdnpbmyrlvṣśsh]$/,b=["\u0101","i","\u012B","e","o","_","ai","au"],f=["h","k","\u015B","y","g","gh","c","ch","jh","\u1E6Dh","\u1E0D","\u1E0Dh","t","th","d","dh","n","p","ph","bh","m","r","\u1E3B","v","\u1E63","s"];var a=!1,o=[],x=[];const w=M[0].nodeType===3;for(let L of M){if(L.nodeType>3)continue;const z=L.textContent.trim();if(z!==""){if(z==="a"){L.textContent="";continue}if(z.match(C)){const F=xn(L,!0);F.textContent=F.textContent.replace(/\s+$/,"")+"a",k==="telugu"&&f.indexOf(z)>=0&&o.push(L)}if(L===d.lastChild&&L.nodeType===3){const F=document.createElement("span");F.appendChild(L.cloneNode(!1)),d.replaceChild(F,L),L=F,L.classList.add("aalt")}else w&&z.match(H)&&L.classList.add("aalt");switch(k){case"devanagari":(z==="i"||z==="\xE9")&&x.unshift(L);break;case"grantha":case"malayalam":if(z==="e"||z==="ai")x.unshift(L);else if(z==="o"){const F=L.cloneNode(!0);vn("o","e",F),x.unshift(F),vn("o","\u0101",L)}break;case"telugu":!a&&b.indexOf(z)>=0&&(a=!0);break}}}for(const L of x)d.insertBefore(L,d.firstChild);if(a)for(const L of o){const z=xn(L,!0);z.textContent=z.textContent+"\u200D\u0C4D"}},vn=function(d,k,M){const H=document.createTreeWalker(M,NodeFilter.SHOW_TEXT,null,!1);for(;H.nextNode();)H.currentNode.textContent.match(d)&&(H.currentNode.textContent=k)},zn=`<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
        xmlns:x="http://www.tei-c.org/ns/1.0"
        exclude-result-prefixes="x">
<xsl:output method="text" omit-xml-declaration="yes"/>
    <xsl:strip-space elements="*"/>
    <xsl:template match="/">
        <xsl:apply-templates/>
    </xsl:template>
    <xsl:template match="para[content-style][not(text())]">
        <xsl:value-of select="normalize-space(.)"/>
    </xsl:template>
    <xsl:template match="x:teiCorpus">
        <xsl:apply-templates/>
    </xsl:template>
    <xsl:template match="x:TEI">
        <xsl:value-of select="@n"/><xsl:text>,</xsl:text>
        <xsl:apply-templates/>
        <xsl:text>&#xa;</xsl:text>
    </xsl:template>
    <xsl:template match="x:text">
        <xsl:apply-templates/>
    </xsl:template>
    <xsl:template match="x:w">
        <xsl:text>"</xsl:text><xsl:apply-templates/><xsl:text>"</xsl:text>
        <!--xsl:if test="not(position() = last())"-->
            <xsl:text>,</xsl:text>
        <!--/xsl:if-->
    </xsl:template>
    <!--xsl:template match="node()|@*">
        <xsl:copy>
            <xsl:apply-templates select="node()|@*"/>
        </xsl:copy>
    </xsl:template-->
</xsl:stylesheet>
`,On=`<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
        xmlns:x="http://www.tei-c.org/ns/1.0"
        exclude-result-prefixes="x">
    <xsl:output indent="yes"/>
    <xsl:template match="x:span">
        <xsl:apply-templates/>
    </xsl:template>
    <xsl:template match="para[content-style][not(text())]">
        <xsl:value-of select="normalize-space(.)"/>
    </xsl:template>
    <xsl:template match="x:teiHeader">
        <xsl:text>&#10;&#32;&#32;&#32;&#32;</xsl:text>
            <xsl:copy><xsl:apply-templates select="node()|@*"/></xsl:copy>
    </xsl:template>
    <xsl:template match="x:xenoData">
        <xsl:text>&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;</xsl:text>
            <xsl:copy><xsl:apply-templates select="node()|@*"/></xsl:copy>
        <xsl:text>&#10;&#32;&#32;&#32;&#32;</xsl:text>
    </xsl:template>
    <xsl:template match="x:TEI">
        <xsl:text>&#10;&#32;&#32;&#32;&#32;</xsl:text>
            <xsl:copy><xsl:apply-templates select="node()|@*"/></xsl:copy>
    </xsl:template>
    <xsl:template match="x:text">
        <xsl:text>&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;</xsl:text>
            <xsl:copy><xsl:apply-templates select="node()|@*"/></xsl:copy>
        <xsl:text>&#10;&#32;&#32;&#32;&#32;</xsl:text>
    </xsl:template>
    <xsl:template match="x:w">
        <xsl:copy><xsl:apply-templates select="node()|@*"/></xsl:copy>
        <!--xsl:if test="not(position() = last())">
            <xsl:text>&#32;</xsl:text>
        </xsl:if-->
    </xsl:template>
    <xsl:template match="node()|@*">
        <xsl:copy>
            <xsl:apply-templates select="node()|@*"/>
        </xsl:copy>
    </xsl:template>
</xsl:stylesheet>
`,Hn=`<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
                xmlns:x="http://www.tei-c.org/ns/1.0"
                exclude-result-prefixes="x">
<xsl:output method="html"/>
<xsl:template match="x:teiCorpus">
    <xsl:element name="table">
        <xsl:apply-templates/>
    </xsl:element>
</xsl:template>
<xsl:template match="x:TEI">
    <xsl:apply-templates/>
</xsl:template>
<xsl:template match="x:text">
    <xsl:element name="tr">
        <xsl:attribute name="data-n"><xsl:value-of select="../@n"/></xsl:attribute>
        <xsl:if test="../@corresp">
            <xsl:attribute name="data-treename"><xsl:value-of select="../@corresp"/></xsl:attribute>
            <xsl:attribute name="data-nodename"><xsl:value-of select="../@select"/></xsl:attribute>
        </xsl:if>
        <xsl:element name="th">
            <xsl:attribute name="scope">row</xsl:attribute>
            <xsl:attribute name="draggable">true</xsl:attribute>
            <xsl:value-of select="../@n"/>
        </xsl:element>
        <xsl:apply-templates/>
    </xsl:element>
</xsl:template>
<xsl:template match="x:w">
    <xsl:element name="td">
        <xsl:choose>
            <xsl:when test="parent::x:cl">
                <xsl:choose>
                    <xsl:when test="position() = '1'">
                        <xsl:attribute name="class">lemma group-start</xsl:attribute>
                    </xsl:when>
                    <xsl:when test="position() = last()">
                        <xsl:attribute name="class">lemma group-end</xsl:attribute>
                    </xsl:when>
                    <xsl:otherwise>
                        <xsl:attribute name="class">lemma group-internal</xsl:attribute>
                    </xsl:otherwise>
                </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
                <xsl:attribute name="class">lemma</xsl:attribute>
            </xsl:otherwise>
        </xsl:choose>
        <xsl:if test="@lemma">
            <xsl:attribute name="data-normal"><xsl:value-of select="@lemma"/></xsl:attribute>
        </xsl:if>
        <xsl:if test="@emended">
            <xsl:attribute name="data-emended">true</xsl:attribute>
        </xsl:if>
        <xsl:attribute name="data-n">
            <xsl:value-of select="@n"/>
        </xsl:attribute>
        <xsl:if test="@insignificant='true'">
            <xsl:attribute name="data-insignificant">true</xsl:attribute>
        </xsl:if>
        <xsl:if test="@binary='true'">
            <xsl:attribute name="data-binary">true</xsl:attribute>
        </xsl:if>
        <xsl:apply-templates/>
    </xsl:element>
</xsl:template>
</xsl:stylesheet>
`,$n=`<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
                xmlns:x="http://www.w3.org/1999/xhtml"
                exclude-result-prefixes="x">
<xsl:output method="html" omit-xml-declaration="yes"/>

<xsl:template match="x:pb">
    <xsl:element name="hr">
        <xsl:attribute name="data-n"><xsl:value-of select="@n"/></xsl:attribute>
    </xsl:element>
    <xsl:element name="img">
        <xsl:attribute name="class">editbutton</xsl:attribute>
        <xsl:attribute name="data-n"><xsl:value-of select="@n"/></xsl:attribute>
        <xsl:attribute name="src">edit_icon.svg</xsl:attribute>
    </xsl:element>
    <h3 class="pb" lang="en"><xsl:value-of select="@n"/></h3>
</xsl:template>

<xsl:template match="x:lb">
<br />
<span class="lb" lang="en"><xsl:value-of select="@n"/></span>
</xsl:template>

<xsl:template match="x:fw">
<div class="fw">(<i lang="en"><xsl:value-of select="@type"/>, <xsl:value-of select="@place"/></i>): <xsl:apply-templates/></div>
</xsl:template>

<xsl:template match="x:div[@type='story']">
    <span class="story" lang="en">(story no. <xsl:value-of select="@num"/>, <xsl:value-of select="@city"/>, <xsl:value-of select="@king"/>)</span>
    <xsl:apply-templates/>
</xsl:template>

<xsl:template match="x:div[@type='verse']">
    <span class="verse"><xsl:apply-templates /></span>
</xsl:template>

<xsl:template match="x:del">
    <xsl:variable name="rend" select="@rend"/>
    <xsl:element name="del">
        <xsl:attribute name="data-title">
            <xsl:text>deleted</xsl:text>
            <xsl:if test="string($rend)">
                <xsl:text> (</xsl:text>
                <xsl:value-of select="$rend"/>
                <xsl:text>)</xsl:text>
           </xsl:if>
        </xsl:attribute>
        <xsl:apply-templates/>
    </xsl:element>
</xsl:template>

<xsl:template match="x:add">
    <xsl:variable name="place" select="@place"/>
    <xsl:variable name="rend" select="@rend"/>
    <xsl:element name="ins">
        <xsl:attribute name="data-title">
            <xsl:text>added</xsl:text>
            <xsl:if test="string($rend) or string($place)">
                <xsl:text> (</xsl:text>
                <xsl:value-of select="$rend"/>
                <xsl:if test="string($rend) and string($place)">
                    <xsl:text>, </xsl:text>
                </xsl:if>
                <xsl:value-of select="$place"/>
                <xsl:text>)</xsl:text>
            </xsl:if>
        </xsl:attribute>
        <xsl:apply-templates/>
    </xsl:element>
</xsl:template>

<xsl:template match="x:subst">
    <span class="subst"><xsl:apply-templates /></span>
</xsl:template>

<xsl:template match="x:g">
    <xsl:element name="span">
        <xsl:attribute name="data-title"><xsl:value-of select="@rend"/></xsl:attribute>
        <xsl:attribute name="class">gaiji</xsl:attribute>
        <xsl:apply-templates/>
    </xsl:element>
</xsl:template>

<xsl:template match="x:lg">
  <xsl:element name="span">
    <xsl:attribute name="class">tree-verse</xsl:attribute>
    <xsl:attribute name="lang">en</xsl:attribute>
    <xsl:text>[verse </xsl:text>
    <xsl:value-of select="@n"/>
    <xsl:text>]</xsl:text>
  </xsl:element>
</xsl:template>

<xsl:template match="x:l">
  <xsl:element name="span">
    <xsl:attribute name="class">l</xsl:attribute>
    <xsl:apply-templates/>
  </xsl:element>
</xsl:template>
</xsl:stylesheet>
`,Vn=`<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
                xmlns:x="http://www.tei-c.org/ns/1.0"
                exclude-result-prefixes="x">
<xsl:output method="html"/>
<xsl:template match="x:w">
    <xsl:element name="span">
        <xsl:attribute name="data-n"><xsl:value-of select="@n"/></xsl:attribute>
        <xsl:if test="@lemma">
            <xsl:attribute name="data-normal"><xsl:value-of select="@lemma"/></xsl:attribute>
        </xsl:if>
        <xsl:if test="@emended">
            <xsl:attribute name="data-emended"><xsl:value-of select="@emended"/></xsl:attribute>
        </xsl:if>
       <xsl:choose>
           <xsl:when test="not(normalize-space(.))">
                <xsl:attribute name="class">lemma invisible</xsl:attribute>
                <xsl:text>&#x00A0;</xsl:text>
            </xsl:when>
            <xsl:otherwise>
                <xsl:attribute name="class">lemma</xsl:attribute>
            </xsl:otherwise>
        </xsl:choose>
        <xsl:apply-templates/>
    </xsl:element>
    <xsl:text>&#173;</xsl:text>
</xsl:template>
<xsl:template match="x:cl">
    <xsl:element name="span">
        <xsl:attribute name="class">group</xsl:attribute>
        <xsl:apply-templates/>
    </xsl:element>
</xsl:template>
<xsl:template match="x:pb">
    <xsl:element name="hr">
        <xsl:attribute name="data-n"><xsl:value-of select="@n"/></xsl:attribute>
    </xsl:element>
    <xsl:element name="img">
        <xsl:attribute name="class">editbutton</xsl:attribute>
        <xsl:attribute name="data-n"><xsl:value-of select="@n"/></xsl:attribute>
        <xsl:attribute name="src">edit_icon.svg</xsl:attribute>
    </xsl:element>
    <h3 class="pb" lang="en"><xsl:value-of select="@n"/></h3>
</xsl:template>

<xsl:template match="x:lb">
<br />
<span class="lb" lang="en"><xsl:value-of select="@n"/></span>
</xsl:template>

<xsl:template match="x:fw">
<div class="fw">(<i lang="en"><xsl:value-of select="@type"/>, <xsl:value-of select="@place"/></i>): <xsl:apply-templates/></div>
</xsl:template>

<xsl:template match="x:div[@type='story']">
    <span class="story" lang="en">(story no. <xsl:value-of select="@num"/>, <xsl:value-of select="@city"/>, <xsl:value-of select="@king"/>)</span>
    <xsl:apply-templates/>
</xsl:template>

<xsl:template match="x:div[@type='verse']">
    <span class="verse"><xsl:apply-templates /></span>
</xsl:template>

<xsl:template match="x:del">
    <xsl:variable name="rend" select="@rend"/>
    <xsl:element name="del">
        <xsl:attribute name="data-title">
            <xsl:text>deleted</xsl:text>
            <xsl:if test="string($rend)">
                <xsl:text> (</xsl:text>
                <xsl:value-of select="$rend"/>
                <xsl:text>)</xsl:text>
           </xsl:if>
        </xsl:attribute>
        <xsl:apply-templates/>
    </xsl:element>
</xsl:template>

<xsl:template match="x:add">
    <xsl:variable name="place" select="@place"/>
    <xsl:variable name="rend" select="@rend"/>
    <xsl:element name="ins">
        <xsl:attribute name="data-title">
            <xsl:text>added</xsl:text>
            <xsl:if test="string($rend) or string($place)">
                <xsl:text> (</xsl:text>
                <xsl:value-of select="$rend"/>
                <xsl:if test="string($rend) and string($place)">
                    <xsl:text>, </xsl:text>
                </xsl:if>
                <xsl:value-of select="$place"/>
                <xsl:text>)</xsl:text>
            </xsl:if>
        </xsl:attribute>
        <xsl:apply-templates/>
    </xsl:element>
</xsl:template>

<xsl:template match="x:subst">
    <span class="subst"><xsl:apply-templates /></span>
</xsl:template>

<xsl:template match="x:g">
    <xsl:element name="span">
        <xsl:attribute name="data-title"><xsl:value-of select="@rend"/></xsl:attribute>
        <xsl:attribute name="class">gaiji</xsl:attribute>
        <xsl:apply-templates/>
    </xsl:element>
</xsl:template>

<xsl:template match="x:lg">
  <xsl:element name="span">
    <xsl:attribute name="class">lg</xsl:attribute>
    <xsl:apply-templates/>
  </xsl:element>
</xsl:template>

<xsl:template match="x:l">
  <xsl:element name="span">
    <xsl:attribute name="class">l</xsl:attribute>
    <xsl:apply-templates/>
  </xsl:element>
</xsl:template>
</xsl:stylesheet>
`,Un=`<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
                xmlns:x="http://www.w3.org/1999/xhtml"
                exclude-result-prefixes="x">
<xsl:output method="text" omit-xml-declaration="yes"/>
<xsl:template match="x:lg">
<xsl:value-of select="@n"/>
</xsl:template>
</xsl:stylesheet>
`,wt=function(d){const M=new DOMParser().parseFromString(d,"text/xml"),H=new XSLTProcessor;return H.importStylesheet(M),H},Gn=function(d){this.transformString=function(k,M){const H=d.xml.createElementNS(d.teins,"ab");return H.innerHTML=k,M.transformToFragment(H,document)},this.sheets={csv:wt(zn),xml:wt(On),matrix:wt(Hn),lemma:wt(Vn),lg:wt(Un),tree:wt($n)}},Xn=function(d){const k={curxml(){return d.xml},teins(){return d.teins},basename(){return d.filename.split(/\.[^.]+$/)[0]},range(C,b){return Array.from(Array(parseInt(b)-parseInt(C)+1).keys(),f=>f+C)},maxlemma(){return[...k.firsttext().querySelectorAll("w[n]")].length-1},lemmata(C,b){const f=b||document.querySelector("#views");return C===!1?f.querySelectorAll(".lemma"):f.querySelectorAll(`.lemma[data-n="${C}"]`)},tds(C,b){const f=b||d.matrix.boxdiv;return C===!1?f.querySelectorAll("td[data-n]"):f.querySelectorAll(`td[data-n="${C}"]`)},firsttd(C,b){return(b||d.matrix.boxdiv).querySelector(`td[data-n="${C}"]`)},tr(C){return d.matrix.boxdiv.querySelector(`tr[data-n="${C}"]`)},trs(C){return(C||d.matrix.boxdiv).querySelectorAll("tr[data-n]")},firsttr(C){return(C||d.matrix.boxdiv).querySelector("tr[data-n]")},lasttr(C){return(C||d.matrix.boxdiv).querySelector("tr[data-n]:last-of-type")},trWalker(C){return document.createNodeIterator(C,NodeFilter.SHOW_ELEMENT,{acceptNode:function(b){if(b.tagName==="TD")return NodeFilter.FILTER_ACCEPT}},!1)},textWalker(C){return document.createNodeIterator(C,NodeFilter.SHOW_ELEMENT,{acceptNode:function(b){if(b.tagName.toLowerCase()==="w")return NodeFilter.FILTER_ACCEPT}},!1)},tei(C,b=d.xml){return b.querySelector(`TEI[n="${C}"]`)},teis(C=d.xml){return C.querySelectorAll("TEI")},texts(C){return(C||d.xml).querySelectorAll("text")},serializedtexts(C,b){const f=[...C.querySelectorAll("otu[label]")].map(o=>o.getAttribute("label"));return[...k.teis()].filter(o=>f.indexOf(o.getAttribute("n"))!==-1).map(o=>[C.querySelector(`node[label="${o.getAttribute("n")}"]`).getAttribute("id"),[...o.querySelectorAll("w")].map(x=>b&&x.hasAttribute("lemma")?x.getAttribute("lemma"):x.textContent)])},serializedlevels(C){return C.map(b=>{if(b instanceof Map){const f=new Map;for(const[a,o]of b)f.set(a.getAttribute("id"),o.map(x=>x.getAttribute("id")));return f}else return b.map(f=>f.getAttribute("id"))})},firsttext(C){return C?d.xml.querySelector(`[n="${C}"] text`):d.xml.querySelector("text")},words(C,b){const f=b||d.xml;return C===!1?f.querySelectorAll("w[n]"):f.querySelectorAll(`w[n="${C}"]`)},firstword(C,b){return(b||d.xml).querySelector(`w[n="${C}"]`)},normal(C){return(C||document.getElementById("views")).querySelectorAll(".lemma[data-normal], .tree-lemma[data-normal]")},htmlreading(C,b){return b&&C.dataset.normal?C.dataset.normal:C.IAST.textContent},ths(){return d.matrix.boxdiv.querySelectorAll("th[data-ref]")},firstth(C){return d.matrix.boxdiv.querySelector(`th[data-ref="${C}"]`)},checkbox(C,b){return d.matrix.boxdiv.querySelector(`th[data-ref="${C}"] input.${b}`)},highlit(){const b=k.firsttr().querySelectorAll(".highlit"),f=new Set;for(const a of b)f.add(a.dataset.n);return f},highlitcell(){return d.matrix.boxdiv.querySelector("td.highlitcell")},highlitrow(){const C=k.highlitcell();return C?C.closest("tr"):!1},lowhigh(C){const b=[...C].sort((o,x)=>parseInt(o)-parseInt(x)),f=parseInt(b[0]),a=b.length>1?parseInt(b[b.length-1]):void 0;return[f,a]},readings(C,b){const f=b||d.matrix.boxdiv,a=k.tds(C,f);var o=0;const x=new Set;for(const w of a){const L=w.textContent;L!==""&&(o++,x.add(L))}return[o,x.size]},attr(C,b){const f=k.firsttr();var a=[];for(const o of b)k.firsttd(o,f).dataset[C]==="true"?a.push([o,!0]):a.push([o,!1]);return new Map(a)},whichattr(C){return C.hasAttribute("n")?"n":C.hasAttribute("data-n")?"data-n":C.hasAttribute("data-ref")?"data-ref":!1},clauses(C,b=!1){const f=k.firsttext();var a=!1;const o=new Set;for(const w of C){const z=k.firstword(w,f).closest("cl");z?o.add(z):b&&(a=!0)}if(o.size===0)return!1;const x=[...o].map(w=>{const L=w.querySelectorAll("w");return new Set([...L].map(z=>z.getAttribute("n")))});return a?[null].concat(x):x},clausesToRemove(C,b,f=0){const a=new Set;for(const o of C){const x=new Set(o);for(const w of b)x.delete(w);x.size<=f&&a.add(o)}return[...a]},empty(){const C=new Set,b=[...k.trs()],f=b.map(x=>k.trWalker(x)),a=b[0].querySelector("td:last-of-type").dataset.n;for(let x=0;x<=a;x++){var o=!0;for(const w of f){const L=w.nextNode();o&&L.textContent!==""&&(o=!1)}o&&C.add(x)}return C},emptyRows(C=!1){const b=k.trs(),f=new Set;for(let a=0;a<b.length;a++){const o=k.tds(!1,b[a]);(()=>{for(const w of o)if(w.textContent!=="")return!1;return!0})()&&(C?f.add(b[a].dataset.n):f.add(a))}return f},prevNonempty(C,b){for(let f=C;f>=0;f--)if(b[f].textContent!=="")return f;return!1},nextNonempty(C,b){for(let f=C;f<b.length;f++)if(b[f].textContent!=="")return f;return!1},cursorPos(C){const b=window.getSelection().getRangeAt(0),f=b.cloneRange();f.selectNodeContents(C);const a=f.toString().length;return f.setEnd(b.endContainer,b.endOffset),[f.toString().length,a]},selection(){const C=window.getSelection();if(C.isCollapsed)return!1;const b=C.rangeCount>1?C.getRangeAt(1).cloneContents():C.getRangeAt(0).cloneContents();if(!b)return!1;const f=new Set,a=b.querySelectorAll(".lemma");for(const o of a)f.add(o.dataset.n);return f}},M={undo(){return d.undo.length>0},redo(){return d.redo.length>0},checkbox(C,b=null){if(!M.anyhighlit())return!1;const f=b===null?k.highlit():b,a=k.attr(C,f);for(const o of a.values())if(o===!1)return!1;return!0},grouped(){const C=k.highlit();if(!C)return!1;const b=k.firsttr();for(const f of C){const a=k.firsttd(f,b);if(a.classList.contains("group-start")||a.classList.contains("group-internal")||a.classList.contains("group-end"))return!0}return!1},oneGrouped(){const C=k.highlit();if(C.size===0)return!1;if(C.size===1){const b=k.firsttr(),f=k.firsttd([...C][0],b);return!!(f.classList.contains("group-start")||f.classList.contains("group-end")||f.classList.contains("group-internal"))}return!0},anyhighlit(){return!!d.matrix.boxdiv.querySelector("td.highlit")},manyhighlit(){return k.highlit().size>1},highlitcell(){return!!d.matrix.boxdiv.querySelector("td.highlitcell")},normalizedView(){return document.getElementById("views").classList.contains("normalized")},anyNormalized(){return d.matrix.boxdiv.querySelector(".lemma[data-normal]")},headerView(){return d.matrix.boxdiv.querySelector("tr.header").style.display!=="none"}},H={tei:function(C){const b=d.xml.createElementNS(d.teins,"TEI");b.setAttribute("n",C);const f=k.firsttext().cloneNode(!0);b.appendChild(f);for(const a of k.words(!1,f))for(a.removeAttribute("lemma");a.firstChild;)a.firstChild.remove();return b},xmlel:function(C,b=d.xml){return b.createElementNS(d.teins,C)},emptycell:function(C){const b=document.createElement("td");return b.className="lemma",b.dataset.n=C,b},emptyword:function(C,b=d.xml){const f=b.createElementNS(d.teins,"w");return f.setAttribute("n",C),f},emptywords:function(C,b,f){const a=b||d.maxlemma,o=f||0;for(let x=o;x<=a;x++){const w=H.emptyword(x);C.appendChild(w)}},row:function(C,b){const f=document.createElement("tr"),a=document.createElement("th");a.scope="row",a.draggable=!0,a.appendChild(document.createTextNode(C)),f.dataset.n=C,f.appendChild(a);const o=k.firsttr();for(const x of o.querySelectorAll("td")){const w=document.createElement("td");w.dataset.n=x.dataset.n,w.className=x.className,b&&w.classList.add(b),f.appendChild(w)}return f},blackout(C,b){const f=document.createElement("div");f.id="blackout",f.appendChild(C),document.body.appendChild(f);const a=function(w){b(w),f.parentNode.removeChild(f)},o=function(w){if(!w.target.closest(".popup")){const z=document.querySelector("#blackout");z.parentNode.removeChild(z)}};f.querySelector("button").addEventListener("click",a),f.addEventListener("click",o)}};return{find:k,check:M,make:H}},Wn=function(d,k){const M={Intersection:function(...a){const o=a[0];return new Set([...o].filter(x=>{for(let w=1;w<a.length;w++)if(!a[w].has(x))return!1;return!0}))},Union:function(...a){return new Set(a.reduce((o,x)=>(o=[...o,...x],o),[]))}},H=function(a){const o=new Map;for(const x of k[0]){const w=d.get(x),L=w!==void 0?[w]:[];o.set(x,new Set(L))}for(let x=1;x<k.length;x++)for(const[w,L]of k[x]){const z=L.map(N=>o.get(N)),F=M.Intersection(...z);if(a&&w===a&&F.size===1)return[...F][0];const B=F.size>0?F:M.Union(...z);o.set(w,B)}return o},C=function(a,o){const x=k[0],w=new Map;for(const L of k[k.length-1])w.set(L[0],a.get(L[0]));for(let L=k.length-1;L>1;L--)for(const[z,F]of k[L]){const B=w.get(z);for(const N of F){if(x.indexOf(N)!==-1)continue;const G=a.get(N),K=(()=>{if(G.size===1)return G;const U=M.Intersection(B,G);return U.size>0?U:G})();if(o&&N===o)return K;w.set(N,K)}}return o?w.get(o):w},b=function(a=null){const o=H(a);if(typeof o=="string")return o;const x=C(o,a);return a?f(x):new Map(Array.from(x,([w,L])=>[w,f(L,!0)]))},f=function(a,o=!1){if(!o&&a.size===1)return[...a][0].trim();const x=[...a].map(w=>w.trim()===""?"_":w);return x.length===1?x[0]:"{"+x.join(", ")+"}"};return{run:b}},jn=function(d,k){const M=d.find,H=d.make,C=M.teins(),b={write:async function(f,a){const o=await a.createWritable();o.write(f),o.close()},xml:async function(f){const a=new XMLSerializer().serializeToString(k.sheets.xml.transformToDocument(f)),o=new Blob([a],{type:"text/xml;charset=utf-8"}),x=M.basename()+".xml",w=await jt({_preferPolyfill:!1,suggestedName:x,types:[{description:"TEI XML",accept:{"text/xml":[".xml"]}}]});b.write(o,w)},csv:async function(f){const a=k.sheets.csv.transformToDocument(f).documentElement.textContent,o=new Blob([a],{type:"text/csv;charset=utf-8"}),x=M.basename()+".csv",w=await jt({_preferPolyfill:!1,suggestedName:x,types:[{description:"CSV file",accept:{"text/csv":[".csv"]}}]});b.write(o,w)},nexus:async function(f){const a=[...M.texts(f)],o=a.length,x="0 1 2 3 4 5 6 7 8 9 A B C D E F G H K L M N P Q R S T U V W X Y Z a b c d e f g h k l m n p q r s t u v w x y z",[w,...L]=x.split(" "),z="-",F=a.map(Q=>"'"+Q.parentElement.getAttribute("n")+"'"),B=a.map(Q=>M.textWalker(Q)),N=a[0].querySelectorAll("w").length,G=[],K=F.map(Q=>[Q+" "]);for(let Q=0;Q<N;Q++){const W=new Set,I=[];for(let re=0;re<B.length;re++){const xe=B[re].nextNode(),Y=Ie.t(xe.textContent.trim().toLowerCase(),"iast","hk").replace(/'/g,"()");I.push(Y),Y!==""&&Y!=="[]"&&W.add(Y)}G.push(["[]",...W]);const ie=new Map([...W].map((re,ge)=>[re,L[ge]]));for(let re=0;re<I.length;re++){const ge=(xe=>{switch(I[xe]){case"":return z;case"[]":return w;default:return ie.get(I[xe])}})(re);K[re].push(ge)}}const U=G.map((Q,W)=>W+1+" / "+[...Q].map(I=>`'${I}'`).join(" ")).join(`,
`),X=K.map(Q=>Q.join("")).map(Q=>Q.replace(/0{8,}/g,W=>W.replace(/0/g,"-"))).reduce((Q,W)=>Q+`
`+W),ae=`#NEXUS

BEGIN TAXA;
  DIMENSIONS NTAX=${o};
  TAXLABELS ${F.join(" ")};
END;

BEGIN CHARACTERS;
  DIMENSIONS
    NCHAR=${N};
  FORMAT 
    DATATYPE=STANDARD 
    RESPECTCASE 
    GAP=${z} 
    MISSING=? 
    SYMBOLS="${x}";
  CHARSTATELABELS
${U}
;
MATRIX
${X}
;
END;
`,de=new Blob([ae],{type:"text/nexus;charset=iso8859-1"}),ve=M.basename()+".nex",$=await jt({_preferPolyfill:!1,suggestedName:ve,types:[{description:"NEXUS file",accept:{"text/nexus":[".nex"]}}]});b.write(de,$)},processOptions:function(f){const a=M.curxml().cloneNode(!0);if(f.get("option_normalize")){const o=a.querySelectorAll("w[lemma]");for(const x of o)x.textContent=x.getAttribute("lemma")}if(f.get("option_mergegroups")){const o=a.querySelectorAll("cl");for(const x of o){const w=x.removeChild(x.firstChild);for(;x.firstChild;){const L=w.getAttribute("lemma")||w.textContent,z=x.firstChild.getAttribute("lemma")||x.firstChild.textContent;for(w.setAttribute("lemma",L+z);x.firstChild.firstChild;)w.appendChild(x.firstChild.firstChild);x.firstChild.remove()}w.getAttribute("lemma")===w.textContent&&w.removeAttribute("lemma"),x.parentNode.insertBefore(w,x),x.parentNode.removeChild(x)}}if(f.get("option_insignificant")){const o=a.querySelectorAll('w[insignificant="true"]');for(const x of o)x.parentNode.removeChild(x)}if(f.get("option_binary")){const x=[...M.firsttext().querySelectorAll('w[binary="true"]')].map(w=>w.getAttribute("n"));for(const w of x){const L=a.querySelectorAll(`w[n="${w}"]:not(:empty)`);if(L.length===0)continue;const z=`[${L[0].textContent}]`;for(const F of L)F.textContent=z}}if(f.get("option_noempty")){const o=a.querySelectorAll("w:empty");for(const x of o)x.textContent="[]"}return f.get("option_basetext")?b.makeApp(f,a):a},makeHeader(f,a){const o=f.createElementNS(C,"teiHeader"),x=f.createElementNS(C,"fileDesc"),w=f.createElementNS(C,"sourceDesc"),L=f.createElementNS(C,"msDesc"),z=f.createElementNS(C,"msIdentifier"),F=f.createElementNS(C,"abbr");F.setAttribute("type","siglum"),F.append(f.documentElement.getAttribute("n")),z.appendChild(F),L.appendChild(z),w.appendChild(L);const B=f.createElementNS(C,"listWit");for(const N of M.teis(a)){const G=N.getAttribute("n"),K=f.createElementNS(C,"witness");K.setAttribute("xml:id",G);const U=f.createElementNS(C,"abbr");U.setAttribute("type","siglum"),U.append(G),K.appendChild(U),B.appendChild(K)}return w.appendChild(B),x.appendChild(w),o.appendChild(x),o},makeApp(f,a){const o=f.get("option_basetext"),x=M.tei(o,a),w=f.get("option_app_normalize"),L=document.implementation.createDocument(C,"",null);L.appendChild(x);const z=L.createElementNS(C,"body"),F=L.createElementNS(C,"p"),B=x.querySelector("text");for(;B.firstChild;)F.appendChild(B.firstChild);z.appendChild(F),B.appendChild(z);const N=b.makeHeader(L,a);x.insertBefore(N,x.firstChild);const G=L.documentElement.getAttribute("n"),K=M.words(!1,x);for(const U of K){const X=U.getAttribute("n"),ae=w&&U.getAttribute("lemma")||U.textContent,de=[G],ve=new Map,$=M.words(X,a);for(const Q of $){const W=Q.closest("TEI").getAttribute("n");if(w&&Q.getAttribute("lemma")===ae)de.push(W);else if(Q.textContent===ae)de.push(W);else{const I=Q.textContent===""?"[om.]":Q.textContent,ie=ve.get(I)||[];ie.push(W),ve.set(I,ie)}}if(ve.size===0)for(;U.firstChild;)U.parentElement.insertBefore(U.firstChild,U);else{const Q=L.createElementNS(C,"app");Q.setAttribute("n",X);const W=L.createElementNS(C,"lem"),I=de.map(ie=>`#${ie}`).join(" ");for(I!==""&&W.setAttribute("wit",I);U.firstChild;)W.appendChild(U.firstChild);Q.appendChild(W);for(const[ie,re]of ve){const ge=L.createElementNS(C,"rdg"),xe=re.map(Y=>`#${Y}`).join(" ");ge.setAttribute("wit",xe),ge.append(ie),Q.appendChild(ge)}U.parentElement.insertBefore(Q,U),W.textContent.match(/\s$/)&&(U.parentElement.insertBefore(L.createTextNode(" "),U),W.textContent=W.textContent.trimEnd())}U.remove()}return L},options(){return document.createRange().createContextualFragment(`<div id="exportoptions" class="popup">
    <form id="exportform">
      <div style="font-weight: bold">Export</div>
      <div>
        <input type="checkbox" id="option_insignificant" name="option_insignificant"><label for="option_insignificant">Remove insignifiant lemmata</label>
      </div>
      <div>
        <input type="checkbox" id="option_binary" name="option_binary"><label for="option_binary">Binarize marked lemmata</label>
      </div>
      <div>
        <input type="checkbox" id="option_noempty" name="option_noempty"><label for="option_noempty">Gaps are significant</label>
      </div>
      <div>
        <input type="checkbox" id="option_mergegroups" name="option_mergegroups"><label for="option_mergegroups">Merge groups</label>
      </div>
      <div>
        <input type="checkbox" id="option_normalize" name="option_normalize"><label for="option_normalize">Normalize spellings</label>
      </div>
      <div>
        <button type="submit">Export</button>
      </div>
    </form>
</div>`)},appOptions(){const f=document.createRange().createContextualFragment(`<div id="exportoptions" class="popup">
    <form id="exportform">
      <div style="font-weight: bold">Export</div>
      <div>
        <label for="option__basetext">Base text</label>
        <select id="option__basetext" name="option_basetext"></select>
      </div>
      <div>
        <input type="checkbox" id="option__app_insignificant" name="option_app_insignificant"><label for="option_app_insignificant">Ignore insignifiant lemmata</label>
      </div>
      <div>
        <input type="checkbox" id="option_mergegroups" name="option_mergegroups" checked><label for="option_mergegroups">Merge groups</label>
      </div>
      <div>
        <input type="checkbox" id="option_app_normalize" name="option_app_normalize" checked><label for="option_app_normalize">Normalized spellings in positive apparatus</label>
      </div>
      <div>
        <input type="checkbox" id="option_normalize" name="option_normalize"><label for="option_normalize">Normalize spellings in negative apparatus</label>
      </div>
      <div>
        <button type="submit">Export</button>
      </div>
    </form>
</div>`),a=f.getElementById("option__basetext"),o=[...M.trs()].map(x=>x.dataset.n);for(const x of o){const w=document.createElement("option");w.value=x,w.append(x),a.appendChild(w)}return f},showOptions:function(f,a){const o=a(),x=function(w){w.preventDefault();var L=[];const z=document.getElementById("exportform").elements;for(const B of z)B.type==="checkbox"?L.push([B.name,B.checked]):L.push([B.name,B.value]);const F=b.processOptions(new Map(L));f(F)};H.blackout(o,x)}};return b},Yn=function(d){const{find:k,check:M,make:H}=d;return{group:function(f){const a=[...f],o=a.shift(),x=k.texts();for(const L of x){const z=H.xmlel("cl"),F=k.firstword(o,L);F.parentNode.insertBefore(z,F),z.appendChild(F);for(const B of f)z.appendChild(k.firstword(B,L))}const w=a.pop();for(const L of k.tds(o))L.classList.add("group-start");for(const L of k.tds(w))L.classList.add("group-end");for(const L of a)for(const z of k.tds(L))z.classList.add("group-internal")},ungroup:function(f){const a=k.texts();for(const x of a){let w;for(const L of f){const z=k.firstword(L,x);w||(w=z.closest("cl")),w.parentNode.insertBefore(z,w)}w.parentNode.removeChild(w)}const o=[...f].flatMap(x=>[...k.tds(x)]);for(const x of o)x.classList.remove("group-start","group-internal","group-end")}}};function zt(d){var k=[],M=0;if(this.trie=this.createTrie(d.patterns),this.leftMin=d.leftmin,this.rightMin=d.rightmin,this.exceptions={},d.exceptions)for(k=d.exceptions.split(/,\s?/g);M<k.length;M+=1)this.exceptions[k[M].replace(/\u2027/g,"").toLowerCase()]=new RegExp("("+k[M].split("\u2027").join(")(")+")","i")}zt.prototype.createTrie=function(d){var k=0,M=0,H=0,C=0,b=null,f=null,a=null,o=null,x={_points:[]},w;for(k in d)if(d.hasOwnProperty(k))for(w=d[k].match(new RegExp(".{1,"+ +k+"}","g")),M=0;M<w.length;M+=1){for(b=w[M].replace(/[0-9]/g,"").split(""),f=w[M].split(/\D/),o=x,H=0;H<b.length;H+=1)a=b[H].charCodeAt(0),o[a]||(o[a]={}),o=o[a];for(o._points=[],C=0;C<f.length;C+=1)o._points[C]=f[C]||0}return x};zt.prototype.hyphenateText=function(d,k){k=k||4;for(var M=d.split(/([a-zA-Z0-9_\u0027\u00AD\u00DF-\u00EA\u00EB\u00EC-\u00EF\u00F1-\u00F6\u00F8-\u00FD\u0101\u0103\u0105\u0107\u0109\u010D\u010F\u0111\u0113\u0117\u0119\u011B\u011D\u011F\u0123\u0125\u012B\u012F\u0131\u0135\u0137\u013C\u013E\u0142\u0144\u0146\u0148\u0151\u0153\u0155\u0159\u015B\u015D\u015F\u0161\u0165\u016B\u016D\u016F\u0171\u0173\u017A\u017C\u017E\u017F\u0219\u021B\u02BC\u0390\u03AC-\u03CE\u03F2\u0401\u0410-\u044F\u0451\u0454\u0456\u0457\u045E\u0491\u0531-\u0556\u0561-\u0587\u0902\u0903\u0905-\u090B\u090E-\u0910\u0912\u0914-\u0928\u092A-\u0939\u093E-\u0943\u0946-\u0948\u094A-\u094D\u0982\u0983\u0985-\u098B\u098F\u0990\u0994-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BE-\u09C3\u09C7\u09C8\u09CB-\u09CD\u09D7\u0A02\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A14-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A82\u0A83\u0A85-\u0A8B\u0A8F\u0A90\u0A94-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABE-\u0AC3\u0AC7\u0AC8\u0ACB-\u0ACD\u0B02\u0B03\u0B05-\u0B0B\u0B0F\u0B10\u0B14-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3E-\u0B43\u0B47\u0B48\u0B4B-\u0B4D\u0B57\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB5\u0BB7-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C02\u0C03\u0C05-\u0C0B\u0C0E-\u0C10\u0C12\u0C14-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3E-\u0C43\u0C46-\u0C48\u0C4A-\u0C4D\u0C82\u0C83\u0C85-\u0C8B\u0C8E-\u0C90\u0C92\u0C94-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBE-\u0CC3\u0CC6-\u0CC8\u0CCA-\u0CCD\u0D02\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D28\u0D2A-\u0D39\u0D3E-\u0D43\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D60\u0D61\u0D7A-\u0D7F\u1F00-\u1F07\u1F10-\u1F15\u1F20-\u1F27\u1F30-\u1F37\u1F40-\u1F45\u1F50-\u1F57\u1F60-\u1F67\u1F70-\u1F7D\u1F80-\u1F87\u1F90-\u1F97\u1FA0-\u1FA7\u1FB2-\u1FB4\u1FB6\u1FB7\u1FBD\u1FBF\u1FC2-\u1FC4\u1FC6\u1FC7\u1FD2\u1FD3\u1FD6\u1FD7\u1FE2-\u1FE7\u1FF2-\u1FF4\u1FF6\u1FF7\u200D\u2019]+)/gi),H=0;H<M.length;H+=1)M[H].indexOf("/")!==-1?H!==0&&H!==M.length-1&&!/\s+\/|\/\s+/.test(M[H])&&(M[H]+="\u200B"):M[H].length>k&&(M[H]=this.hyphenate(M[H]).join("\xAD"));return M.join("")};zt.prototype.hyphenate=function(d){var k,M=[],H,C,b,f,a,o=[],x,w=d.toLowerCase(),L,z,F=Math.max,B=this.trie,N=[""];if(this.exceptions.hasOwnProperty(w))return d.match(this.exceptions[w]).slice(1);if(d.indexOf("\xAD")!==-1)return[d];for(d="_"+d+"_",k=d.toLowerCase().split(""),H=d.split(""),x=k.length,C=0;C<x;C+=1)o[C]=0,M[C]=k[C].charCodeAt(0);for(C=0;C<x;C+=1)for(a=B,b=C;b<x&&(a=a[M[b]],a);b+=1)if(L=a._points,L)for(f=0,z=L.length;f<z;f+=1)o[C+f]=F(o[C+f],L[f]);for(C=1;C<x-1;C+=1)C>this.leftMin&&C<x-this.rightMin&&o[C]%2?N.push(H[C]):N[N.length-1]+=H[C];return N};var Qn=zt;const Kn={id:"sa",leftmin:2,rightmin:2,patterns:{2:"a1e1i1o1u1\xE91\xED1\xEF1\xF31\xFA1\xFC1\u01011\u012B1\u016B1\u1E371\u1E391\u1E5B1\u1E5D1",3:"2b_2c_2d_2g_2h_2j_2k_2l_2m_2n_2p_2r_2s_2t_2v_2y_2\xF1_2\u015B_2\u1E0D_2\u1E2512\u1E2B12\u1E37_2\u1E4112\u1E4312\u1E45_2\u1E47_2\u1E6D_2\u1E961l\u03251r\u03251",4:"2bh_2ch_2dh_2gh_2jh_2kh_2m\u031012ph_2rb_2rd_2rg_2rk_2rp_2rt_2r\u1E0D_2r\u1E6D_2th_2\u1E0Dh_2\u1E6Dh_a2i1a2u1a3\xEF1a3\xFC1l\u0325\u03041r\u0325\u03041"}};window.comboView=function(){const d={teins:"http://www.tei-c.org/ns/1.0",scripts:["iast","devanagari","telugu","grantha","malayalam"],filename:null,xml:null,treelist:new Map,trees:[],textboxes:[],matrix:null,viewdiv:null,descs:null,maxlemma:null,windows:[window],dragged:null,draganchor:null,undo:[],redo:[],editing:!1},k=new Qn(Kn),M=new Gn(d),H=new Xn(d),C=new Yn(H),b=new jn(H,M),{find:f,check:a,make:o}=H,x=function(){const c=document.getElementById("tooltip");c&&c.remove()},w={matrix:function(){return d.matrix=new pe,d.matrix.init(),d.matrix.show(),document.getElementById("matrixmenu").style.display="none",L(),N.rehighlight(),d.matrix},text:function(c){const u=new fe(c);return d.textboxes.push(u),u.init(),u.show(),L(),N.rehighlight(),document.querySelector(".highlit")||W.textClick({target:u.boxdiv.querySelector(".lemma:not(.invisible)")}),u},tree:function(c,u){const p=new Y(c,u);return d.trees.push(p),p.init(),p.show(),L(),N.rehighlight(),p}},L=function(){for(const c of d.trees)c.draw()},z=function(){const c=window.getSelection?window.getSelection():document.selection;c&&(c.removeAllRanges?c.removeAllRanges():c.empty&&c.empty())},F=function(c){const u=document.createTreeWalker(c,NodeFilter.SHOW_TEXT);for(;u.nextNode();){const p=B(u.currentNode.nodeValue);u.currentNode.nodeValue=p}},B=function(c){return k.hyphenateText(c.replace(/ \|/g,"\xA0|").replace(/\| (?=\d)/g,"|\xA0").replace(/\|\|/g,"\u0965").replace(/\|/g,"\u0964"))},N={getAllWindows:function(){return window.mainWindow?window.mainWindow.comboView.getWindows():d.windows},forEachWindow:function(c){const u=N.getAllWindows();for(const p of u)if(!p.closed&&c(p)===!1)break},highlightLemma:function(c,u){var p=!!u;N.forEachWindow(n=>{const r=n.comboView.getViewdiv().querySelectorAll('[data-n="'+c+'"]');for(const h of r)(!p||!h.classList.contains("invisible"))&&h.classList.add("highlit");const s=n.comboView.getViewdiv().querySelectorAll('[data-n-trans="'+c+'"]');for(const h of s)h.classList.add("translit")})},highlightRange:function(c){if(!c||c.size===0)return;N.unHighlightAll();const[u,p]=f.lowhigh(c);if(p!==void 0)for(let n=u;n<=p;n++)N.highlightLemma(n,!0);else N.highlightLemma(u);N.repopulateTrees(u,p);for(const n of d.viewdiv.querySelectorAll(".text-box"))n.querySelector(".highlit")||n.querySelector('[data-n="'+u+'"]').classList.add("highlit");ie.xScroll(u)},highlightAll:function(){a.anyhighlit()?N.unHighlightAll():N.highlightRange(new Set([0,f.maxlemma()]))},unHighlightAll:function(){N.forEachWindow(c=>{const u=c.comboView.getViewdiv().querySelectorAll(".highlit");for(const n of u)n.classList.remove("highlit");const p=c.comboView.getViewdiv().querySelectorAll(".translit");for(const n of p)n.classList.remove("translit");N.unCelllightAll()})},unCelllightAll:function(){N.forEachWindow(c=>{const u=c.comboView.getViewdiv().querySelectorAll(".highlitcell");for(const p of u)p.classList.remove("highlitcell")})},rehighlight:function(){var c;if(N.forEachWindow(p=>{if(c=p.document.querySelectorAll(".highlit"),c.length>0)return!1}),c.length>0){var u=new Set;for(const p of c)u.add(p.dataset.n);N.highlightRange(u)}},clearTrees:function(){N.forEachWindow(c=>{const u=c.comboView.getTrees();for(const p of u)p.clearlemmata()})},repopulateTrees:function(c,u){N.forEachWindow(p=>{const n=p.comboView.getTrees();for(const r of n)r.populate(c,u),r.colourizeVariants(c,u),r.updatescript()})},highlightTreeLemma:function(c){N.forEachWindow(u=>{const p=u.comboView.getTrees();for(const n of p){const r=n.boxdiv.querySelector('.tree-lemma[data-id="'+c+'"]'),s=n.boxdiv.querySelectorAll(".tree-lemma");for(const h of s)(r.dataset.nodes&&h.dataset.nodes===r.dataset.nodes||!r.dataset.nodes&&h.dataset.id===r.dataset.id)&&h.classList.add("highlit");n.clearLabels()}})},unhighlightTrees:function(){N.forEachWindow(c=>{const u=c.comboView.getViewdiv().querySelectorAll(".tree-lemma.highlit");for(const n of u)n.classList.remove("highlit");const p=c.comboView.getTrees();for(const n of p)n.clearLabels()})}},G=function(c,u){const p=u.target.files[0],n=[...u.target.files].slice(1),r=new FileReader;r.onload=c.bind(null,p,n),r.readAsText(p)},K=function(c,u,p){d.filename=c.name,document.title=document.title+`: ${d.filename}`,d.filename.split(".").pop()==="csv"?ae(c,u,p):de(c,u,p)},U=function(c,u,p){const n=p.target.result,s=new DOMParser().parseFromString(n,"text/xml"),h=d.xml.querySelector("teiHeader > xenoData")||function(){const v=d.xml.querySelector("teiHeader")||function(){const D=o.xmlel("teiHeader");return d.xml.documentElement.appendChild(D),D}(),A=o.xmlel("xenoData");return v.appendChild(A),A}(),m=o.xmlel("stemma");m.setAttribute("format","nexml"),m.id="stemma"+[...h.querySelectorAll("stemma")].length,m.appendChild(s.firstChild.cloneNode(!0)),h.appendChild(m),X(s,m.id)},X=function(c,u,p=!0){const n=c.querySelectorAll("tree"),r=document.querySelector("#treemenu ul");for(const s of n){const h=s.id,m=c.cloneNode(!0);for(const D of m.querySelectorAll("tree"))D.id!==h&&D.parentNode.removeChild(D);const v=s.getAttribute("label")||"New Tree "+d.treelist.size;d.treelist.set(`#${u} #${h}`,m);const A=document.createElement("li");A.dataset.name=v,A.dataset.treeid=h,A.dataset.stemmaid=u,A.appendChild(document.createTextNode(v)),r.insertBefore(A,r.lastElementChild),p&&w.tree(u,h)}},ae=function(c,u,p){const n=yn.parse(p.target.result,{delimiter:","});d.xml=document.implementation.createDocument(d.teins,"",null);const r=o.xmlel("teiCorpus"),s=o.xmlel("teiHeader");r.appendChild(s),d.xml.appendChild(r);for(const h of n){const m=h[0],v=h.slice(1),A=o.xmlel("TEI");A.setAttribute("n",m);const D=o.xmlel("text");for(let T=0;T<v.length;T++){const V=v[T],j=o.xmlel("w");V&&j.appendChild(document.createTextNode(V)),j.setAttribute("n",T),D.appendChild(j)}A.appendChild(D),r.appendChild(A)}d.xml.normalize(),d.maxlemma=f.maxlemma(),Q()},de=function(c,u,p){const n=new DOMParser;d.xml=n.parseFromString(p.target.result,"text/xml"),d.xml.documentElement.getAttribute("xml:lang")==="ta"&&(d.scripts=["iast","tamil"]);const r=d.xml.querySelectorAll("teiHeader xenoData stemma nexml");for(const s of r){const h=document.implementation.createDocument("http://www.nexml.org/2009","",null);h.appendChild(s.cloneNode(!0)),X(h,s.closest("stemma").id,!1)}d.maxlemma=f.maxlemma(),u.length>0?ve(u):Q()},ve=function(c){const u=c[0],p=c.slice(1),n=function(h,m){const v=new Set(h);for(const A of m)v.delete(A);return v},r=function(h,m){const A=new DOMParser().parseFromString(m.target.result,"text/xml"),D=new Map;for(const Ee of f.teis()){const _e=Ee.getAttribute("n");D.set(_e,Ee)}const T=new Set(D.keys()),V=new Map;for(const Ee of A.querySelectorAll("TEI")){const _e=Ee.getAttribute("n");V.set(_e,Ee)}const j=new Set(V.keys()),oe=n(T,j),be=n(j,T);for(const Ee of be)o.tei(Ee);const we=[...A.querySelector("text").querySelectorAll("w[n]")].length,ye=d.maxlemma+we;for(const[Ee,_e]of V)if(D.has(Ee)){const ke=D.get(Ee).querySelector("text"),Me=_e.querySelector("text").querySelectorAll("w[n]");var Ae=d.maxlemma+1;for(const De of Me)De.setAttribute("n",Ae),ke.appendChild(De),Ae=Ae+1}else{const ke=o.xmlel("TEI");ke.setAttribute("n",Ee);const Be=o.xmlel("text");o.emptywords(Be,ye,0),ke.appendChild(Be),d.xml.documentElement.appendChild(ke)}for(const Ee of oe){const _e=D.get(Ee).querySelector("text");o.emptywords(_e,ye,d.maxlemma+1)}d.maxlemma=f.maxlemma(),h.length>0?ve(h):Q()},s=new FileReader;s.onload=r.bind(null,p),s.readAsText(u)},$=function(){var c="";const u=[...f.teis()].map(p=>p.getAttribute("n"));for(const p of u)c+=`<li data-name="${p}">${p}</li>`;document.getElementById("menu").querySelector(".ms").innerHTML=c},Q=function(){$();const c=new ge("Export");c.populate([{text:"TEI corpus",func:b.showOptions.bind(null,b.xml,b.options)},{text:"TEI apparatus",func:b.showOptions.bind(null,b.xml,b.appOptions)},{text:"CSV",func:b.showOptions.bind(null,b.csv,b.options)},{text:"NEXUS",func:b.showOptions.bind(null,b.nexus,b.options)}]);const u=new ge("Edit");u.populate([{text:"Undo",greyout:a.undo,func:I.undo},{text:"Redo",greyout:a.redo,func:I.redo},{text:"Select all",alt:"Deselect all",toggle:a.anyhighlit,func:N.highlightAll},{text:"Group by whitespace",func:I.doGroupWords},{text:"Delete empty columns",func:I.startRemoveEmpty},{text:"Delete empty rows",func:I.startRemoveEmptyRows}]);const p=new ge("Column");p.populate([{text:"(Re)normalize column",alt:"(Re)normalize columns",greyout:a.anyhighlit,toggle:a.manyhighlit,func:I.startRenormalize.bind(null,!1)},{text:"Delete column",alt:"Delete columns",greyout:a.anyhighlit,toggle:a.manyhighlit,func:I.removeCol.start.bind(null,!1)},{text:"Merge columns",greyout:a.manyhighlit,func:I.startMerge.bind(null,!1)},{text:"Group columns",alt:"Ungroup columns",greyout:a.oneGrouped,toggle:a.grouped,func:I.group.start.bind(null,!1)},{text:"Insert column",greyout:a.anyhighlit,func:I.insertCol.start},{text:"Mark insignificant",checkbox:a.checkbox.bind(null,"insignificant"),greyout:a.anyhighlit,func:I.startMarkAs.bind(null,"insignificant",!1)},{text:"Mark binary",checkbox:a.checkbox.bind(null,"binary"),greyout:a.anyhighlit,func:I.startMarkAs.bind(null,"binary",!1)}]);const n=new ge("Row");n.populate([{text:"Insert row",func:I.startNewRow}]);const r=new ge("Cell");r.populate([{text:"Edit cell",greyout:a.highlitcell,func:I.startEditCell.bind(null,!1)}]);const s=new ge("View");s.populate([{text:"Header",checkbox:a.headerView,func:ie.toggleHeader},{text:"Normalized",checkbox:a.normalizedView,greyout:a.anyNormalized,func:ie.toggleNormalize}]);const h=document.getElementById("left_menu");h.appendChild(s.box),h.appendChild(u.box),h.appendChild(p.box),h.appendChild(n.box),h.appendChild(r.box),h.appendChild(c.box);const m=document.getElementById("views");m.style.justifyContent="flex-start",m.removeChild(m.querySelector("#splash")),w.matrix();const v=document.getElementById("matrixmenu");v.addEventListener("click",w.matrix),v.removeChild(v.querySelector("ul")),document.getElementById("mssmenu").style.display="block",document.getElementById("treemenu").style.display="block"},W={selectAll(c){const u=document.createRange();u.selectNodeContents(c);const p=window.getSelection();p.removeAllRanges(),p.addRange(u)},deselect(){const c=window.getSelection();c.removeAllRanges?c.removeAllRanges():c.empty&&c.empty()},treeMouseover(c){const u=c.target.classList.contains("tree-lemma")?c.target:c.target.closest(".tree-lemma");u&&(N.highlightTreeLemma(u.dataset.id),u.addEventListener("mouseout",N.unhighlightTrees));const p=c.target.dataset.reconstructed;if(!p)return;const n=document.createElement("div");n.id="tooltip",n.style.top=c.pageY+"px",n.style.left=c.pageX+"px",n.style.opacity=0,n.style.transition="opacity 0.2s ease-in",d.viewdiv.parentElement.appendChild(n);const r=document.createElement("div");if(r.appendChild(document.createTextNode(p)),this.script!==0?n.appendChild(Yt(r,d.scripts[this.script])):n.appendChild(r),c.target.classList.contains("reconstructed")){const s=c.target.parentNode.querySelector("span.tree-lemma");if(s&&s.dataset.hasOwnProperty("emended")){const h=document.createElement("div");h.classList.add("emphasis"),h.appendChild(document.createTextNode(s.textContent)),this.script!==0?n.prepend(Yt(h,d.scripts[this.script])):n.prepend(h)}}window.getComputedStyle(n).opacity,n.style.opacity=1,c.target.addEventListener("mouseout",x)},treeClick(c){c.target.classList.contains("witness")?w.text(c.target.dataset.key):c.target.classList.contains("reconstructed")?w.text(c.target.dataset.label):c.target.classList.contains("internal")&&I.startReconstruction(c),x()},keyDown(c){if(!d.editing&&c.key.substring(0,5)==="Arrow")W.cycleVariant(c);else if(c.ctrlKey||c.metaKey)c.key==="Z"?I.redo():c.key==="z"&&I.undo();else if(!d.editing&&d.matrix&&!d.matrix.closed&c.key==="Enter"){const u=f.highlitcell();u&&(c.preventDefault(),I.startEditCell(u))}},cycleVariant(c){const u=f.highlitcell()||d.viewdiv.querySelector("td.highlit")||d.viewdiv.querySelector('td[data-n="0"]');switch(c.key){case"ArrowRight":{if(!d.matrix.closed&&u){const p=u.nextElementSibling;p&&W.textClick({target:p})}else{const p=d.viewdiv.querySelector(".highlit"),n=p?p.dataset.n:0;let r=parseInt(n)+1;for(;r<=d.maxlemma;){const s=d.viewdiv.querySelectorAll('[data-n="'+r+'"]');for(const h of s)if(h&&!h.classList.contains("invisible")){W.textClick({target:h});return}r++}}break}case"ArrowLeft":{if(!d.matrix.closed&&u){const p=u.previousElementSibling;p&&W.textClick({target:p})}else{const p=d.viewdiv.querySelector(".highlit"),n=p?p.dataset.n:0;let r=parseInt(n)-1;for(;r>=0;){const s=d.viewdiv.querySelectorAll('[data-n="'+r+'"]');for(const h of s)if(h&&!h.classList.contains("invisible")){W.textClick({target:h});return}if(r--,u){W.textClick({target:u.previousElementSibling});return}}}break}case"ArrowUp":{if(d.matrix.closed||!u)return;const n=u.closest("tr").previousElementSibling;if(!n||!n.dataset.n)return;const r=n.querySelector(`td[data-n="${u.dataset.n}"]`);W.textClick({target:r});break}case"ArrowDown":{if(d.matrix.closed||!u)return;const n=u.closest("tr").nextElementSibling;if(!n||n.tagName!=="TR")return;const r=n.querySelector(`td[data-n="${u.dataset.n}"]`);W.textClick({target:r})}}},textClick(c,u=!1){if(c.target.closest("tr.header")){W.matrixHeaderClick(c);return}const p=c.target.classList.contains("lemma")?c.target:c.target.closest(".lemma");if(p){if(!u&&c.ctrlKey){W.rightClick(c);return}const n=p.dataset.n,r=f.highlitrow();if(N.unHighlightAll(),N.highlightLemma(n),N.repopulateTrees(n),ie.xScroll(n,r),p.tagName==="TD")p.classList.add("highlitcell");else{const s=p.closest(".text-box");if(s){const h=s.dataset.id;f.tr(h).querySelector(`td[data-n="${n}"]`).classList.add("highlitcell")}}}},textMouseup(){const c=f.selection();!c||(N.highlightRange(c),z())},menuMouseover(c){const u=c.target.classList.contains("menubox")?c.target:c.target.closest(".menubox");if(u){const p=u.querySelector("ul");p&&(p.style.display="block"),u.classList.add("open")}},menuMouseout(c){const u=c.target.classList.contains("menubox")?c.target:c.target.closest(".menubox");if(u){const p=u.querySelector("ul");p&&(p.style.display="none"),u.classList.remove("open")}},menuClick(c){!c.target.parentElement||(c.target.parentElement.className==="ms"&&(W.menuMouseout(c),w.text(c.target.dataset.name)),c.target.parentElement.className==="tree"&&(W.menuMouseout(c),c.target.closest("li[data-name]")&&w.tree(c.target.dataset.stemmaid,c.target.dataset.treeid)))},thDragStart(c){!c.target.closest('th[scope="row"]')||(c.dataTransfer.setData("text/plain",c.target.textContent),I.startMoveRow(c.target.parentNode,c))},trDragEnter(c){const u=c.target.nodeType===1?c.target.closest("tr"):c.target.parentElement.closest("tr");u&&u.classList.add("dragenter")},trDragLeave(c){const u=c.target.nodeType===1?c.target.closest("tr"):c.target.parentElement.closest("tr");u&&u.classList.remove("dragenter")},trDragDrop(c){c.preventDefault(),I.finishMoveRow(c)},matrixMousedown(c){if(c.button!==0)return;if(c.ctrlKey){W.rightClick(c);return}const u=c.target.nodeType===1?c.target.closest(".lemma"):c.target.parentElement.closest(".lemma");if(u){if(u.isContentEditable)return;N.unHighlightAll(),N.highlightLemma(u.dataset.n),d.draganchor=parseInt(u.dataset.n),d.matrix.boxdiv.querySelector("table").addEventListener("mouseover",W.matrixMouseover),window.addEventListener("mouseup",W.matrixMouseup)}},matrixMouseup(c){const u=f.highlit();u.size===1?W.textClick(c):(N.clearTrees(),N.highlightRange(u)),d.draganchor=null,d.matrix.boxdiv.querySelector("table").removeEventListener("mouseover",W.matrixMouseover),window.removeEventListener("mouseup",W.matrixMouseup)},matrixMouseover(c){const u=c.target.nodeType===1?c.target.closest(".lemma"):c.target.parentElement.closest(".lemma");if(u){N.unHighlightAll();const r=d.draganchor,s=parseInt(u.dataset.n);if(r===s)N.highlightLemma(r);else{var p,n;r>s?(p=r,n=s):(p=s,n=r);for(let h=n;h<=p;h++)N.highlightLemma(h,!0)}}},matrixHeaderClick(c){if(c.target.tagName!=="INPUT")return;const u=c.target.className;if(u!=="insignificant"&&u!=="binary")return;const p=c.target.closest("th").dataset.ref,n=f.firsttd(p).dataset[u]!=="true",r=new Map([[p,n]]);I.doMarkAs(u,r)},rightClick(c){const u=c.target.nodeType===1?c.target.closest("tr[data-n] th"):c.target.parentElement.closest("tr[data-n] th");if(u){c.preventDefault(),re.remove();const n=re.create(c),r=[{text:"move row",func:I.startMoveRow.bind(null,u.parentNode)},{text:"delete row",func:I.doDeleteRow.bind(null,u.parentNode.dataset.n)}];re.populate(n,r),re.show(n);return}const p=c.target.nodeType===1?c.target.closest("td.lemma"):c.target.parentElement.closest("td.lemma");if(p){c.preventDefault();const n=p.classList.contains("highlit")?function(){const h=f.highlit();return h.size===1&&!p.classList.contains("highlitcell")&&(N.unCelllightAll(),p.classList.add("highlitcell")),h}():(W.textClick(c,!0),new Set([p.dataset.n])),r=n.size>1?[{text:"merge columns",func:I.startMerge.bind(null,n)},{text:"ungroup columns",alt:"group columns",toggle:a.grouped,func:I.group.start.bind(null,!1)},{text:"delete columns",func:I.removeCol.start.bind(null,n)}]:[{text:"edit cell",func:I.startEditCell.bind(null,p)},{text:"delete column",func:I.removeCol.start.bind(null,n)},{text:"insert column",func:I.insertCol.start}];re.remove();const s=re.create(c);re.populate(s,r),re.show(s)}}},I={undo:function(){const c=d.undo.pop();c&&c[0](...c[1])},redo:function(){const c=d.redo.pop();c&&c[0](...c[1])},doStack:function(c,u="do"){u==="undo"?(c[1].push("redo"),d.redo.push(c)):u==="redo"?(c[1].push("undo"),d.undo.push(c)):(c[1].push("undo"),d.undo.push(c),d.redo=[])},doMulti:function(c,u){const p=[];for(const n of c){const r=n[0](...n[1],"multido");p.unshift(r)}I.doStack([I.doMulti,[p]],u)},startMoveRow:function(c,u){if(d.dragged=c,d.dragged.classList.add("dragging"),u.type!=="dragstart"){for(const p of f.trs())p.classList.add("moveinprogress");d.matrix.boxdiv.querySelector("table").addEventListener("mousedown",I.finishMoveRow)}},startMerge:function(c){const u=c===!1?f.highlit():c,p=f.clauses(u,!0);if(!p)I.doMerge(u,"do");else if(p[0]===null){const n=p.filter(r=>r!==null).map(r=>[I.ungroup.go,[r]]).concat([[I.doMerge,[u]]]);I.doMulti(n,"do")}else{const n=p.map(r=>[I.ungroup.go,[r]]).concat([[I.doMerge,[u]]]);I.doMulti(n,"do")}},group:{start:function(c){const u=c===!1?f.highlit():c;a.grouped()?I.ungroup.start(u):I.group.go(u,"do")},go:function(c,u="do"){C.group(c);for(const p of d.textboxes)p.refresh();if(u==="multido")return[I.ungroup.go,[c]];I.doStack([I.ungroup.go,[c]],u)}},ungroup:{start:function(c){const p=[...f.clauses(c)].map(n=>[I.ungroup.go,[n]]);I.doMulti(p,"do")},go:function(c,u="do"){C.ungroup(c);for(const p of d.textboxes)p.refresh();if(u==="multido")return[I.group.go,[c]];I.doStack([I.group.go,[c]],u)}},insertCol:{start:function(){const c=Math.max([...f.highlit()])||d.maxlemma;I.insertCol.go({mode:"append",start:c})},go:function(c,u="do"){const p=function(s,h,m,v){const A=s();for(var D=0;D<A.length;D++){const T=h(c.start,A[D]);if(c.mode==="append")if(m)for(const V of m[D].reverse())T.insertAdjacentElement("afterend",V);else{const V=v(c.start+1);T.insertAdjacentElement("afterend",V)}else if(m)for(const V of m[D])T.insertAdjacentElement("beforebegin",V);else{const V=v(c.start);T.insertAdjacentElement("beforebegin",V)}}return m?m[0].length:1};N.unHighlightAll();var n;c.hasOwnProperty("xml")?(p(...c.xml),n=p(...c.html)):(p(f.trs,f.firsttd,null,o.emptycell),p(f.texts,f.firstword,null,o.emptyword),n=1);const r=c.mode==="append"?[...Array(n).keys()].map(s=>c.start+s+1):[...Array(n).keys()].map(s=>c.start+s);if(I.renumber(c.start),N.highlightRange(new Set(r)),I.refresh(),I.reIAST(r),I.restyleGroups(r,!0),ie.updateAllHeaders(),u==="multido")return[I.removeCol.go,[r]];I.doStack([I.removeCol.go,[r]],u)}},removeCol:{start:function(c){const u=c===!1?f.highlit():c,p=f.clauses(u);if(!p)I.removeCol.go(u,"do");else{const n=p.map(r=>[I.ungroup.go,[r]]).concat([[I.removeCol.go,[u]]]);I.doMulti(n,"do")}},go:function(c,u="do"){const p=function(A,D){const T=A(),V=[];for(const j of T){const oe=[...c].map(we=>{const ye=D(we,j);return I.unnormalize(ye),ye}),be=oe.map(we=>we.cloneNode(!0));V.push(be);for(const we of oe)we.parentNode.removeChild(we)}return[A,D,V]},n={mode:"insert"};[...c].map(A=>parseInt(A));const r=Math.min(...c),s=Math.max(...c);f.firstword(s).nextElementSibling||(n.mode="append");const m=p(f.trs,f.firsttd),v=p(f.texts,f.firstword);if(I.renumber(r-1),I.refresh(),I.restyleGroups(c,!0),ie.updateAllHeaders(),n.html=m,n.xml=v,n.mode==="append"?n.start=r-1:n.start=r,u==="multido")return[I.insertCol.go,[n]];I.doStack([I.insertCol.go,[n]],u)}},startRemoveEmpty:function(){const c=f.empty(),u=f.clauses(c);if(!u)I.removeCol.go(c,"do");else{const p=f.clausesToRemove(u,c,1);if(!p)I.removeCol.go(c,"do");else{const n=p.map(r=>[I.ungroup.go,[r]]).concat([[I.removeCol.go,[c]]]);I.doMulti(n,"do")}}},startRemoveEmptyRows:function(){const u=[...f.emptyRows(!0)].map(p=>[I.doDeleteRow,[p]]);I.doMulti(u,"do")},startEditCell:function(c){const u=c||f.highlitcell();!u||(I.unnormalize(u),u.dataset.oldContent=u.textContent,u.contentEditable="true",u.focus(),d.editing=!0,W.selectAll(u),u.addEventListener("blur",I.finishEditCell),u.addEventListener("keydown",I.cellKeyDown))},cellKeyDown:function(c){switch(c.key){case"Enter":I.finishEditCell(c);break;case"Escape":I.finishEditCell(c,!0);break;case"ArrowRight":{const u=f.cursorPos(c.target);u[0]===u[1]&&(c.preventDefault(),I.finishEditCell(c),W.cycleVariant({key:"ArrowRight"}),I.startEditCell(f.highlitcell()));break}case"ArrowLeft":{f.cursorPos(c.target)[0]===0&&(c.preventDefault(),I.finishEditCell(c),W.cycleVariant({key:"ArrowLeft"}),I.startEditCell(f.highlitcell()));break}}},startMarkAs:function(c,u,p){const n=p.target.tagName==="INPUT"?p.target:p.target.querySelector("input"),r=u===!1?f.highlit():u,s=new Map([...r].map(h=>[h,!n.checked]));I.doMarkAs(c,s)},startNewRow:function(){const c=o.row("new row"),u=c.querySelector("th");u.contentEditable=!0,u.addEventListener("blur",I.finishNewRow),u.addEventListener("keydown",I.thKeyDown),d.matrix.boxdiv.querySelector("tbody").appendChild(c),u.scrollIntoView(),u.focus(),document.execCommand("selectAll",!1,null),d.editing=!0},startRenameRow:function(){},startReconstruction:function(c){const u=c.target.dataset.key,p=c.target.closest(".tree-box").myTree,n=p.desc,r=document.createRange().createContextualFragment(`<div id="reconstructionoptions" class="popup">
    <form id="reconstructionform">
      <div>
        <label for="reconstructed_node_name">Label for node:</label>
        <input type="text" id="reconstructed_node_name" name="reconstructed_node_name" placeholder="${n}-${u}" size="15">
      </div>
      <div style="width: 100%; display: flex; justify-content: center;padding-top: 1em;">
        <button type="submit">Add to matrix</button>
      </div>
    </form>
</div>`),s=function(h){h.preventDefault();const m=blackout.querySelector("input"),v=m.value?m.value:m.placeholder;I.doReconstruction(p,u,v)};o.blackout(r,s),document.getElementById("reconstructed_node_name").focus()},thKeyDown:function(c){c.key==="Enter"&&I.finishNewRow(c)},finishNewRow:function(c){const u=c.target,p=u.textContent;u.closest("tr").dataset.n=p;const n=o.tei(p);d.xml.documentElement.appendChild(n),d.editing=!1,u.contentEditable=!1,u.removeEventListener("blur",I.finishNewRow),u.removeEventListener("keydown",I.thKeyDown),I.doStack([I.doDeleteRow,[p]],"do")},finishEditCell:function(c,u=!1){const p=c.target;d.editing=!1,p.contentEditable="false",p.removeEventListener("blur",I.finishEditCell),p.removeEventListener("keydown",I.cellKeyDown),p.blur(),W.deselect();const n=p.textContent;if(n===""){const m=p.querySelector("br");m&&m.remove()}if(u||n===p.dataset.oldContent)return;p.hasOwnProperty("IAST")||(p.IAST=p.cloneNode(!0)),p.IAST.textContent=n;const r=parseInt(p.dataset.n),s=p.closest("tr"),h=s.dataset.n;if(I.xmlChangeCell(r,h,n),s.dataset.hasOwnProperty("treename")&&!p.dataset.hasOwnProperty("emended")){const m=I.doEmend(r,h,"multido"),v=[];v.push([I.doChangeCell,[r,h,p.dataset.oldContent]]),v.push(m),I.doStack([I.doMulti,[v]],"do")}else I.doStack([I.doChangeCell,[r,h,p.dataset.oldContent]],"do");delete p.dataset.oldContent,I.refresh(),ie.updateAllHeaders(!0),p.classList.add("highlitcell")},finishMoveRow:function(c){const u=c.target.nodeType===1?c.target.closest("tr"):c.target.parentElement.closest("tr");if(u&&I.doMoveRow(d.dragged,u,"do"),c.type!=="drop"){for(const p of f.trs())p.classList.remove("moveinprogress");d.matrix.boxdiv.querySelector("table").removeEventListener("mousedown",I.finishMoveRow)}else for(const p of f.trs())p.classList.remove("dragenter");d.dragged.classList.remove("dragging"),d.dragged=null},doReconstruction:function(c,u,p){const n=o.row(p,"pending");n.dataset.treename=c.name,n.dataset.nodename=u;const r=n.querySelector("th"),s=document.createElement("div");s.id="spinner",r.prepend(s);const h=o.tei(p);h.setAttribute("type","reconstructed"),h.setAttribute("corresp",c.name),h.setAttribute("select",`#${u}`);const m=[...f.tds(!1,n)],v=[...f.words(!1,h)];d.matrix.boxdiv.querySelector("tbody").appendChild(n),r.scrollIntoView();const A=new Worker(""+new URL("worker.2ee2559d.js",import.meta.url).href),D=a.normalizedView(),T=f.serializedtexts(c.nexml,D),V=new Map(T.map(j=>[j[0],j[1][0]]));A.postMessage({readings:V,levels:c.levels,num:0,id:u}),A.onmessage=function(j){const oe=j.data.n,be=j.data.result;if(m[oe].textContent=be,m[oe].IAST=m[oe].cloneNode(!0),m[oe].classList.remove("pending"),v[oe].textContent=be,oe<d.maxlemma){const we=new Map(T.map(ye=>[ye[0],ye[1][oe+1]]));A.postMessage({readings:we,levels:c.levels,num:oe+1,id:u})}else{r.removeChild(s),d.xml.documentElement.appendChild(h),ie.updateAllHeaders(),c.draw();const we=f.highlit();we.size>0&&N.repopulateTrees(...f.lowhigh(we));const ye=document.getElementById("menu").querySelector(".ms"),Ae=document.createElement("li");Ae.setAttribute("data-name",p),Ae.appendChild(document.createTextNode(p)),ye.appendChild(Ae),I.doStack([I.doDeleteRow,[p]],"do")}}},doDeleteRow:function(c,u="do"){const p=f.tr(c),n=f.tei(c),s=[...f.teis()].indexOf(n);if(p.parentNode.removeChild(p),n.parentNode.removeChild(n),ie.updateAllHeaders(),$(),L(),u==="multido")return[I.doUndeleteRow,[p,n,s]];I.doStack([I.doUndeleteRow,[p,n,s]],u)},doUndeleteRow:function(c,u,p,n="do"){const r=u.getAttribute("n"),s=[...f.teis()];if(p===s.length)d.xml.documentElement.appendChild(u),d.matrix.boxdiv.querySelector("tbody").appendChild(c);else{const h=[...f.trs()];d.xml.documentElement.insertBefore(u,s[p]),h[p].parentNode.insertBefore(c,h[p])}if(ie.updateAllHeaders(),$(),L(),n==="multido")return[I.doDeleteRow,[r]];I.doStack([I.doDeleteRow,[r]],n)},doMoveRow:function(c,u,p="do"){const n=c.parentNode,r=[...f.trs()],s=c.previousElementSibling,h=r.indexOf(c),m=u!==null?r.indexOf(u):null,v=function(){u===-1?n.insertBefore(c,n.firstChild):u.nextElementSibling?n.insertBefore(c,u.nextElementSibling):n.appendChild(c)},A=function(){const D=d.xml.documentElement,T=[...f.teis()],V=T[h];if(m===-1)D.insertBefore(V,T[0]);else{const j=T[m];j.nextElementSibling?D.insertBefore(V,j.nextElementSibling):D.appendChild(V)}};if(v(),A(),p==="multido")return[I.doMoveRow,[c,s]];I.doStack([I.doMoveRow,[c,s]],p)},doMerge:function(c,u="do"){const p=function(h,m,v){const A=h();var D=[];for(const T of A){const V=[...v].map(be=>m(be,T)),j=V.map(be=>be.cloneNode(!0));D.push(j);for(const be of V)I.unnormalize(be);const oe=V.reduce(function(be,we){if(we.hasChildNodes())for(;we.firstChild;)be.appendChild(we.firstChild);return we.parentNode.removeChild(we),be});oe.normalize(),oe.dataset?(delete oe.dataset.normal,oe.IAST=oe.cloneNode(!0)):oe.removeAttribute("lemma")}return[h,m,D]},n=p(f.trs,f.firsttd,c),r=p(f.texts,f.firstword,c),s=parseInt([...c][0]);if(I.renumber(s),I.restyleGroups(c),I.refresh(),ie.updateAllHeaders(),u==="multido")return[I.doUnmerge,[n,r]];I.doStack([I.doUnmerge,[n,r]],u)},doUnmerge:function(c,u,p="undo"){const n=function(m,v,A){const D=f.whichattr(A[0][0]),T=A[0].map(be=>be.getAttribute(D)),V=T[0],j=m();for(var oe=0;oe<j.length;oe++){const be=A[oe].pop(),we=v(V,j[oe]);we.parentNode.replaceChild(be,we);for(const ye of A[oe])be.parentNode.insertBefore(ye,be)}return T};n(...c);const r=n(...u),h=[...r].sort((m,v)=>parseInt(m)-parseInt(v))[0];if(I.renumber(h),I.reIAST(r),I.refresh(),I.restyleGroups(r),ie.updateAllHeaders(),p==="multido")return[I.doMerge,[r]];I.doStack([I.doMerge,[r]],p)},doGroupWords:function(){let c=0;const u=[],p=f.emptyRows();for(let n=0;n<=d.maxlemma;n++){const r=f.tds(n),s=r[0].classList;if(s.contains("group-start")||s.contains("group-internal")||s.contains("group-end")){c=n+1;continue}let h=r.length-p.size,m=0;if(n===d.maxlemma)m=h;else for(let v=0;v<r.length;v++){if(p.has(v))continue;const A=r[v];(A.IAST?A.IAST.textContent:A.textContent).slice(-1)===" "&&m++}if(m/h>=.5)if(c===n){c++;continue}else{const v=f.range(c,n);u.push([I.group.go,[v]]),c=n+1}}I.doMulti(u)},doEmend:function(c,u,p="do"){const n=[...f.trs()][u],r=f.firsttd(c,n);r.dataset.emended=!0;const s=f.tei(u).querySelector("text");if(f.firstword(c,s).setAttribute("emended","true"),p==="multido")return[I.doUnemend,[c,u]];I.doStack([I.doUnemend,[c,u]],p)},doUnemend:function(c,u,p="do"){const n=[...f.trs()][u],r=f.firsttd(c,n);delete r.dataset.emended;const s=f.tei(u).querySelector("text");if(f.firstword(c,s).removeAttribute("emended"),p==="multido")return[I.doEmend,[c,u]];I.doStack([I.doEmend,[c,u]],p)},doChangeCell:function(c,u,p,n="do"){const r=I.xmlChangeCell(c,u,p),s=I.htmlChangeCell(c,u,p);if(I.refresh(),ie.updateAllHeaders(!0),W.textClick({target:s}),n==="multido")return[I.doChangeCell,[c,u,r]];I.doStack([I.doChangeCell,[c,u,r]],n)},htmlChangeCell:function(c,u,p){const n=f.tr(u),r=f.firsttd(c,n);return I.unnormalize(r),r.textContent=p,r.IAST&&(r.IAST=r.cloneNode(!0)),r},xmlChangeCell:function(c,u,p){const n=f.tei(u).querySelector("text"),r=f.firstword(c,n);I.unnormalize(r);const s=r.textContent;return r.childNodes.length===0?r.appendChild(document.createTextNode(p)):r.textContent=p,s},doMarkAs:function(c,u,p="do"){const n=[...u.keys()],r=f.attr(c,n);for(const s of n){const h=f.tds(s),m=f.words(s);if(u.get(s)===!0){for(const A of h)A.dataset[c]="true";for(const A of m)A.setAttribute(c,"true")}else{for(const A of h)delete A.dataset[c];for(const A of m)A.removeAttribute(c)}const v=f.checkbox(s,c);v.checked=u.get(s)}if(p==="multido")return[I.doMarkAs,[c,r]];I.doStack([I.doMarkAs,[c,r]],p)},refresh:function(){for(const c of d.textboxes)c.refresh();N.rehighlight(),a.anyhighlit()?N.repopulateTrees(...f.lowhigh(f.highlit())):N.clearTrees()},renumber:function(c=0){const u=function(p,n,r){const s=p();for(const m of s){const v=[...n(!1,m)],A=f.whichattr(v[0]);for(var h=parseInt(r)+1;h<v.length;h++)v[h].setAttribute(A,h)}};u(f.trs,f.tds,c),u(()=>[!0],f.ths,c),u(f.texts,f.words,c),d.maxlemma=f.maxlemma()},reIAST:function(c){const u=[...c].map(p=>[...f.lemmata(p)]).flat();for(const p of u)p.IAST=p.cloneNode(!0)},restyleGroups:function(c,u=!1){const n=u?function(s){var h=[...s];const m=parseInt(c[0])-1,v=parseInt(c[c.length-1])+1;return h.unshift(m),h.push(v),h}(c):c,r=function(s,h=!1){const m=new Set(["group-start","group-internal","group-end"]);h&&m.delete(h);for(const v of s){for(const A of m)v.classList.remove(A);h&&v.classList.add(h)}};for(const s of n){const h=f.firstword(s),m=f.tds(s);if(m.length===0)continue;const v=h.closest("cl");v?h===v.firstElementChild?r(m,"group-start"):h===v.lastElementChild?r(m,"group-end"):r(m,"group-internal"):r(m)}},startRenormalize:function(c){const u=c===!1?f.highlit():c;I.doRenormalize(Math.min(...u),Math.max(...u))},doRenormalize:function(c,u,p=!1,n="do"){a.normalizedView()||ie.showNormalized();const r=new Map,s=[...f.trs()],h=[...f.texts()],m=p?[p]:[...s.keys()];for(const v of m){const A=new Map,D=h[v],T=[...f.words(!1,D)],V=f.firstword(c,D),j=f.firstword(u,D),oe=T.indexOf(V),be=T.indexOf(j),we=T.slice(oe,be+1),ye=s[v],Ee=[...f.tds(!1,ye)].slice(oe,be+1),_e=we.map(Be=>Be.textContent),ke=Fn(_e);for(let Be=0;Be<ke.length;Be++){const Me=we[Be],De=ke[Be],Te=_e[Be],Fe=Ee[Be],qe=Me.hasAttribute("lemma")?Me.getAttribute("lemma"):!1;if(qe!==!1){if(qe===De)continue;A.set(Fe.dataset.n,qe),I.unnormalize(Me),I.unnormalize(Fe)}else A.set(Fe.dataset.n,null);De!==Te&&(Me.setAttribute("lemma",De),Fe.dataset.normal=De,Fe.textContent=De)}r.set(v,A)}ie.updateAllHeaders(!0),ie.xScrollToHighlit(),I.doStack([I.doUnrenormalize,[r]],n)},doUnrenormalize:function(c,u="undo"){a.normalizedView()||ie.showNormalized();const p=new Map,n=[...f.trs()],r=[...f.texts()];for(const[s,h]of c.entries()){const m=n[s],v=r[s],A=new Map;for(const[D,T]of h.entries()){const V=f.firsttd(D,m),j=f.firstword(D,v),oe=j.hasAttribute("lemma")?j.getAttribute("lemma"):null;A.set(D,oe),T===null?(I.unnormalize(V),I.unnormalize(j)):(V.dataset.normal=T,j.setAttribute("lemma",T),V.textContent=T)}p.set(s,A)}I.doStack([I.doUnrenormalize,[p]],u)},unnormalize:function(c){c.hasOwnProperty("IAST")&&(c.textContent=c.IAST.textContent),c.dataset&&c.dataset.hasOwnProperty("normal")&&delete c.dataset.normal,c.getAttribute("lemma")&&c.removeAttribute("lemma")}},ie={toggleNormalize:function(){a.normalizedView()?ie.showUnnormalized():ie.showNormalized()},showNormalized:function(c){if(c)c.updatescript();else{document.getElementById("views").classList.add("normalized");for(const p of d.textboxes)p.updatescript();d.matrix.updatescript(),a.anyhighlit()?N.repopulateTrees(...f.lowhigh(f.highlit())):N.clearTrees()}ie.updateAllHeaders(!0),ie.xScrollToHighlit()},showUnnormalized:function(){document.getElementById("views").classList.remove("normalized"),d.matrix.updatescript();for(const c of d.textboxes)c.updatescript();a.anyhighlit()?N.repopulateTrees(...f.lowhigh(f.highlit())):N.clearTrees(),ie.updateAllHeaders(!0),ie.xScrollToHighlit()},toggleHeader:function(){const c=d.matrix.boxdiv.querySelector("tr.header");c.style.display==="none"?c.style.display="table-row":c.style.display="none"},updateHeaders(c){for(const u of c){const p=f.firstth(u),[n,r]=f.readings(u),s=p.querySelector("span.readings"),h=n<2?n:`${n}(${r.size})`;s.textContent=h}},updateAllHeaders(c=!1){const u=[...f.trs()],p=u.map(m=>f.trWalker(m)),n=[...f.tds(!1,u[0])],r=[...f.ths()],s=d.matrix.boxdiv.querySelector("tr.header"),h=function(){const m=document.createElement("th"),v=document.createElement("span");v.classList.add("readings"),m.appendChild(v);const A=document.createElement("form");return A.innerHTML='<div><input class="insignificant" type="checkbox">Insignificant</div><div><input class="binary" type="checkbox">Binary</div>',m.appendChild(A),s.appendChild(m),m};for(let m=0;m<n.length;m++){const v=m>=r.length?h():r[m],A=n[m];v.dataset.ref=A.dataset.n;let D=0;const T=new Set;for(const j of p){const oe=j.nextNode().textContent;oe!==""&&(D++,T.add(oe))}const V=D<2?D:`${D}(${T.size})`;v.querySelector("span.readings").textContent=V,c||(v.querySelector("input.insignificant").checked=!!A.dataset.insignificant,v.querySelector("input.binary").checked=!!A.dataset.binary)}if(r.length>n.length)for(let m=n.length;m<r.length;m++)s.removeChild(r[m])},xScrollToHighlit:function(){const c=f.highlit();c.size>0&&ie.xScroll([...c][0])},xScroll:function(c,u){if(!c)return;const p=u||f.firsttr(),n=f.firsttd(c,p),r=n.getBoundingClientRect(),s=d.matrix.boxdiv,m=s.getBoundingClientRect().right,v=p.querySelector("th").getBoundingClientRect(),A=v.right,D=r.right>m,T=r.left+.1<A;D&&n.scrollIntoView({inline:"end",block:"nearest"}),T&&(n.scrollIntoView({inline:"start",block:"nearest"}),s.scroll({left:s.scrollLeft-v.width}))}},re={create:function(c){const u=document.createElement("div");return u.classList.add("contextmenu"),u.style.left=c.clientX-12+"px",u.style.top=c.clientY-22+"px",u},remove:function(){for(const c of document.querySelectorAll(".contextmenu"))c.parentNode.removeChild(c)},show:function(c){document.body.appendChild(c)},populate:function(c,u){const p=document.createElement("ul");for(const n of u){const r=document.createElement("li");if(n.hasOwnProperty("cond")){const s=document.createRange().createContextualFragment('<form><input type="checkbox"'+(n.cond()?" checked":"")+"></form>");r.appendChild(s)}if(n.hasOwnProperty("toggle")){const s=n.toggle()?n.text:n.alt;r.appendChild(document.createTextNode(s))}else r.appendChild(document.createTextNode(n.text));r.addEventListener("mouseup",n.func),p.appendChild(r)}c.appendChild(p)}};class ge{constructor(u){this.name=u,this.box=document.createElement("div"),this.box.classList.add("menubox");const p=document.createElement("div");p.classList.add("heading"),p.appendChild(document.createTextNode(u)),this.box.appendChild(p),p.addEventListener("mouseover",this.checkConditions.bind(this)),this.box.addEventListener("mouseup",this.click.bind(this)),this.items=new Map,this.conditions=new Map}populate(u){const p=this.box.querySelector("ul")||function(n){const r=document.createElement("ul");return n.box.appendChild(r),r}(this);for(const n of u){const r=document.createElement("li");if(n.hasOwnProperty("checkbox")){const s=document.createElement("form"),h=document.createElement("input");h.type="checkbox",h.addEventListener("click",m=>m.preventDefault()),s.appendChild(h),r.appendChild(s),r.appendChild(document.createTextNode(n.text)),this.conditions.set(h,n.checkbox)}else if(n.hasOwnProperty("toggle")){const s=document.createElement("span");s.appendChild(document.createTextNode(n.text)),s.dataset.text=n.text,s.dataset.alt=n.alt,this.conditions.set(s,n.toggle),r.appendChild(s)}else r.appendChild(document.createTextNode(n.text));n.hasOwnProperty("greyout")&&this.conditions.set(r,n.greyout),this.items.set(r,n.func),p.appendChild(r)}}click(u){const p=u.target.tagName==="LI"?u.target:u.target.closest("li");if(p&&!p.classList.contains("greyedout")){const n=this.items.get(p);n&&(n(u),this.checkConditions())}}checkConditions(){const u=new Map;for(const[p,n]of this.conditions){const r=u.get(n)||function(){const s=n();return u.set(n,s),s}();p.tagName==="INPUT"?p.checked=r:p.tagName==="SPAN"?r?p.textContent=p.dataset.alt:p.textContent=p.dataset.text:p.tagName==="LI"&&(r?p.classList.remove("greyedout"):p.classList.add("greyedout"))}}}class xe{constructor(u){this.name=u,this.script=0}show(){d.descs.appendChild(this.descbox),a.normalizedView()&&ie.showNormalized(this),d.viewdiv.appendChild(this.boxdiv),this.closed=!1}clear(){for(;this.boxdiv.firstChild;)this.boxdiv.removeChild(this.boxdiv.firstChild);this.svgcontainer&&(this.clearsvg(),this.boxdiv.appendChild(this.svgcontainer))}destroy(){d.viewdiv.removeChild(this.boxdiv),d.descs.removeChild(this.descbox);const u=d.trees.indexOf(this);u>-1&&d.trees.splice(u,1);const p=d.textboxes.indexOf(this);p>-1&&d.textboxes.splice(p,1),this.closed=!0,this.name==="Matrix"&&(document.getElementById("matrixmenu").style.display="block"),L(),N.rehighlight()}pullout(){this.destroy();const u="menubar=no,location=no,status=no,height=620,width=620,scrollbars=yes,centerscreen=yes",p=window.mainWindow?window.mainWindow.comboView.getWindows().length:d.windows.length,n=window.open("branch.html","branch"+p,u);n.mainWindow=window.mainWindow?window.mainWindow:window,n.startbox=this.text?{text:{name:this.name}}:{tree:this.name},n.mainWindow.comboView.addWindow(n)}makeDescBox(){const u=document.createElement("div"),p=document.createElement("div");p.classList.add("closer"),p.innerHTML="x",p.title="close";const n=document.createElement("div");n.classList.add("scripter"),n.innerHTML="A",n.title="change script",u.appendChild(p),u.appendChild(n),u.appendChild(document.createTextNode(this.desc)),this.descbox=u,p.addEventListener("click",this.destroy.bind(this)),n.addEventListener("click",this.cyclescript.bind(this))}cyclescript(){this.script=this.script+1,this.script===d.scripts.length&&(this.script=0);const u=this.descbox.querySelector(".scripter");this.script===0?u.innerHTML="A":u.innerHTML=it[d.scripts[this.script]]("a"),d.scripts[this.script]==="grantha"?u.classList.add("grantha"):u.classList.remove("grantha"),this.updatescript()}updatescript(){const u=this.boxdiv.querySelectorAll(".lemma,.tree-lemma");for(const p of u){const n=p.dataset.hasOwnProperty("normal");if(!n&&p.textContent.trim()==="")continue;const r=(h=>{if(a.normalizedView()&&n){const m=h.createElement("span");return m.appendChild(h.createTextNode(p.dataset.normal)),m}else return p.IAST.cloneNode(!0)})(document),s=this.script===0?r:Yt(r,d.scripts[this.script]);for(p.innerHTML="";s.firstChild;)p.appendChild(s.firstChild)}d.scripts[this.script]==="grantha"?this.boxdiv.classList.add("grantha"):this.boxdiv.classList.remove("grantha"),this.boxdiv.classList.contains("matrix")&&ie.xScrollToHighlit()}}class Y extends xe{constructor(u,p){super(`#${u} #${p}`),this.stemmaid=u,this.id=p,this.nexml=d.treelist.get(this.name).cloneNode(!0),this.desc=this.nexml.querySelector("tree").getAttribute("label")}init(){this.makeDescBox();const u=document.createElement("div");u.classList.add("tree-box");var p,n=0;do p="tree"+n,n++;while(document.getElementById(p));u.id=p,this.boxdiv=u,this.boxdiv.addEventListener("mouseover",W.treeMouseover.bind(this)),this.boxdiv.addEventListener("click",W.treeClick),this.svgcontainer=document.createElement("div"),this.svgcontainer.id=this.boxdiv.id+"container",this.boxdiv.appendChild(this.svgcontainer),this.boxdiv.myTree=this,this.calcPaths(),this.jiggleroot(),this.findLevels(),this.labelInternal()}show(){d.descs.appendChild(this.descbox),d.viewdiv.appendChild(this.boxdiv)}jiggleroot(){const u=this.nexml.evaluate('//nex:node[@root="true"]',this.nexml,this.nsResolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue,p=this.nexml.evaluate('//nex:edge[@source="'+u.id+'"]|//nex:edge[@target="'+u.id+'"]',this.nexml,this.nsResolver,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);if(p.snapshotLength===3){var n,r;for(let s=0;s<p.snapshotLength;s++){const h=p.snapshotItem(s),m=h.getAttribute("source"),v=h.getAttribute("target"),A=this.nexml.evaluate('//nex:node[@id="'+m+'"]',this.nexml,this.nsResolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue,D=this.nexml.evaluate('//nex:node[@id="'+v+'"]',this.nexml,this.nsResolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;if(!A.hasAttribute("otu")&&!D.hasAttribute("otu")){n=h,r=v===u.id?"target":"source";break}}if(n){const s=this.nexml.createElementNS(u.namespaceURI,"node");s.id="fakeroot",s.setAttribute("root","true"),u.removeAttribute("root"),u.parentElement.insertBefore(s,u);const h=this.nexml.createElementNS(u.namespaceURI,"edge");h.id="newrootedge",h.setAttribute("length","0"),h.setAttribute("source","fakeroot"),h.setAttribute("target",u.id),u.parentElement.insertBefore(h,n),n.setAttribute(r,s.id)}}}findLevels(){const u=this.nexml.querySelectorAll("edge"),p=[...this.nexml.querySelectorAll("node[otu]")],n=this.nexml,r=[p],s=function(v,A){const D=v.map(ye=>ye.id),T=new Map,V=new Map,j=[];for(const ye of A){const Ae=ye.getAttribute("target"),Ee=ye.getAttribute("source"),_e=(()=>D.indexOf(Ae)!==-1?{ancestor:n.getElementById(Ee),child:n.getElementById(Ae)}:D.indexOf(Ee)!==-1?{ancestor:n.getElementById(Ae),child:n.getElementById(Ee)}:null)();if(_e!==null)if(V.has(_e.ancestor)){const ke=V.get(_e.ancestor);T.set(_e.ancestor,[ke.child,_e.child]),j.push(ye),j.push(ke.edge)}else V.set(_e.ancestor,{child:_e.child,edge:ye})}const oe=[...T.keys()],be=[...V.keys()].reduce((ye,Ae)=>(oe.indexOf(Ae)===-1&&ye.push(V.get(Ae).child),ye),[]),we=[...A].reduce((ye,Ae)=>(j.indexOf(Ae)===-1&&ye.push(Ae),ye),[]);return{match:T,remainder:[...new Set(be)],edges:we}};var h=p,m=u;do{const v=s(h,m);r.push(v.match),h=[...v.match.keys(),...v.remainder],m=v.edges}while(m.length>0);this.levels=f.serializedlevels(r)}labelInternal(){for(const u of this.nexml.querySelectorAll("node:not([label])"))u.setAttribute("label",u.id)}fitch(){const u=new Map(this.levels[0].map(n=>{const r=a.normalizedView(),s=this.nexml.querySelector(`node[id="${n}"]`).getAttribute("label"),h=this.boxdiv.querySelector(`span.tree-lemma[data-id="${s}"]`),m=h?f.htmlreading(h,r):void 0;return[n,m]})),p=new Wn(u,this.levels).run();for(const[n,r]of p){const s=this.boxdiv.querySelector(`span.internal[data-key="${n}"]`);s.dataset.reconstructed=r}}clearsvg(){for(;this.svgcontainer.firstChild;)this.svgcontainer.removeChild(this.svgcontainer.firstChild)}removecolors(){const u=this.nexml.querySelectorAll("node[color]");for(let p=0;p<u.snapshotLength;p++)u.snapshotItem(p).removeAttribute("color")}drawlines(u,p){if(this.removecolors(),u){const m=this.getPath(...u.split(";")).path,v=new Set;for(const A of m)v.add(A.getAttribute("target")),v.add(A.getAttribute("source"));for(const A of v){const D=this.nexml.evaluate('//nex:node[@id="'+A+'"]',this.nexml,this.nsResolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;D.getAttribute("root")||D.setAttribute("color",p)}}const n=parseInt(window.getComputedStyle(this.svgcontainer,null).width)-15,r=parseInt(window.getComputedStyle(this.boxdiv,null).height)-10,s=function(){return r<600?600:r}();q.PhyloCanvas.Render.Style.line.stroke="rgb(162,164,170)",this.phylocanvas=new q.PhyloCanvas({nexml:this.nexml,fileSource:!0},this.svgcontainer.id,n,s);const h=this.svgcontainer.querySelectorAll('path:not([stroke="#a2a4aa"])');for(const m of h)m.style.strokeWidth="2"}draw(){this.clear(),this.drawlines(),this.makeLabels()}clearLabels(){for(const u of this.boxdiv.firstChild.querySelectorAll("text"))u.parentElement.removeChild(u)}makeLabels(){const u=[...f.texts()],p=new Set(u.map(r=>r.parentNode.getAttribute("n"))),n=new Map(u.filter(r=>r.parentNode.hasAttribute("corresp")&&r.parentNode.getAttribute("corresp")===this.name).map(r=>[r.parentNode.getAttribute("select").replace(/^#/,""),r.parentNode.getAttribute("n")]));for(const r of this.boxdiv.firstChild.querySelectorAll("text")){const s=document.createElement("div");s.setAttribute("class","tree-div");const h=parseInt(r.getAttribute("x")-5),m=parseInt(r.getAttribute("y"))-15;s.style.left=h+"px",s.style.top=m+"px";const v=r.textContent.trim();p.has(v)?s.innerHTML=`<span class="witness inactive" data-key="${v}">${v}</span><span class="tree-lemma ${v}" data-id="${v}"></span>`:v!=="fakeroot"?n.has(v)?s.innerHTML=`<span class="internal reconstructed" data-key="${v}" data-label="${n.get(v)}">${n.get(v)}</span><span class="tree-lemma invisible ${v}" data-id="${v}" data-label="${n.get(v)}"></span>`:s.innerHTML=`<span class="internal" data-key="${v}">0</span>`:s.innerHTML=`<span class="internal" data-key="${v}"></span>`,r.parentElement.removeChild(r),this.boxdiv.appendChild(s)}}clearlemmata(){for(const u of this.boxdiv.querySelectorAll("span.tree-lemma"))u.innerHTML="",u.dataset.hasOwnProperty("normal")&&delete u.dataset.normal,u.IAST=u.cloneNode(!0)}populate(u,p){const n=f.texts();for(const h of n){const m=h.parentNode.getAttribute("n"),v=this.boxdiv.querySelector(`span.tree-lemma[data-id="${m}"]`)||this.boxdiv.querySelector(`span.tree-lemma[data-label="${m}"]`);if(!!v){if(v.hasOwnProperty("IAST")||(v.IAST=v.cloneNode(!0)),v.IAST.innerHTML="",p){const A=[],D=[];var r=!1;for(let T=u;T<=p;T++){const V=f.firstword(T,h);A.push(V.innerHTML),V.hasAttribute("lemma")&&(D[T-u]=V.getAttribute("lemma")),V.hasAttribute("emended")&&(r=!0)}if(v.IAST.appendChild(M.transformString(A.join(" ").replace(/\s+/g," ").trim(),M.sheets.tree)),D.length!==0){const T=A.slice(0).map((j,oe)=>D.hasOwnProperty(oe)?D[oe]:j),V=document.createElement("span");V.appendChild(M.transformString(T.join(" ").replace(/\s+/g," ").trim(),M.sheets.tree)),v.dataset.normal=V.innerHTML}r?v.dataset.emended=!0:v.dataset.hasOwnProperty("emended")&&delete v.dataset.emended}else{const A=f.firstword(u,h);v.IAST.appendChild(M.transformString(A.innerHTML,M.sheets.tree)),A.hasAttribute("lemma")?v.dataset.normal=A.getAttribute("lemma"):delete v.dataset.normal,A.hasAttribute("emended")?v.dataset.emended=!0:v.dataset.hasOwnProperty("emended")&&delete v.dataset.emended}a.normalizedView()&&v.dataset.hasOwnProperty("normal")?v.innerHTML=v.dataset.normal:v.innerHTML=v.IAST.innerHTML}}const s=this.boxdiv.querySelectorAll(".inactive");for(const h of s)h.classList.remove("inactive");this.fitch()}calcPaths(){this.nodes=[],this.paths=[],this.longest={path:[]},this.nsResolver=this.nexml.createNSResolver(this.nexml.ownerDocument==null?this.nexml.documentElement:this.nexml.ownerDocument.documentElement);const u=this.nexml.evaluate("//nex:node[@label]",this.nexml,this.nsResolver,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE);for(let p=0;p<u.snapshotLength;p++)this.nodes.push(u.snapshotItem(p));for(let p=0;p<this.nodes.length;p++){const n=this.nodes[p],r=n.getAttribute("label"),s=n.id;for(let h=p+1;h<this.nodes.length;h++){const m=this.nodes[h],v=m.getAttribute("label"),A=m.id;this.paths.push({nodes:[r,v],path:this.pathFind(s,A)})}}for(const p of Object.keys(this.paths))this.paths[p].path.length>this.longest.path.length&&(this.longest=this.paths[p])}pathFind(u,p,n){n||(n=[]);const r=this.nexml.evaluate('//nex:edge[@source="'+u+'"]|//nex:edge[@target="'+u+'"]',this.nexml,this.nsResolver,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);var s;for(let h=0;h<r.snapshotLength;h++){const m=r.snapshotItem(h);if(s=[m],n.indexOf(m.id)!=-1)continue;n.push(m.id);const v=m.getAttribute("source")!==u?m.getAttribute("source"):m.getAttribute("target");if(v===p)return s;if(!this.nexml.evaluate('//nex:node[@id="'+v+'"]',this.nexml,this.nsResolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue.hasAttribute("otu")){const D=this.pathFind(v,p,n);if(D)return s.concat(D);continue}}return!1}analyzeVariants(u,p){const n=[],r=[],s=function(D){return D.startsWith("<lg")?M.transformString(D,M.sheets.lg).firstChild.data.slice(1):D},h=function(D){return D.map(T=>s(T)).join(" ").replace(/\s+/g," ").trim()},m=a.normalizedView()?function(D,T){const V=f.firstword(D,T);return V.hasAttribute("lemma")?V.getAttribute("lemma"):V.textContent}:function(D,T){return f.firstword(D,T).textContent};for(const D of f.texts()){const T=D.parentNode.getAttribute("n");if(!this.nexml.querySelector(`otu[label="${T}"]`))continue;const V=p?h(f.range(u,p).map(j=>m(j,D))):s(m(u,D));V===""?n.hasOwnProperty("")?n[""].push(T):n[""]=[T]:n.hasOwnProperty(V)?n[V].push(T):n[V]=[T]}const v={};for(const D of Object.keys(n)){var A={length:0,branch_length:0,paths:[]};if(n[D].length===1)A=!1;else for(let T=0;T<n[D].length;T++)for(let V=T+1;V<n[D].length;V++){const j=this.getPath(n[D][T],n[D][V]);if(j.hasOwnProperty("path")||alert(j),j.path.length===A.length){const oe=this.calcBranchLength(j.path);oe===A.branch_length?A.paths.push(j):oe>A.branch_length&&(A={length:j.path.length,branch_length:oe,paths:[j]})}else j.path.length>A.length&&(A={length:j.path.length,branch_length:this.calcBranchLength(j.path),paths:[j]})}v[D]=A}for(const D of Object.keys(r))v[D]=r[D];return v}getPath(u,p){for(const n of this.paths)if(n.nodes.indexOf(u)>-1&&n.nodes.indexOf(p)>-1)return n;return!1}calcBranchLength(u){return u.map(p=>p.getAttribute("length")).reduce((p,n)=>parseFloat(p)+parseFloat(n))}pickColour(u,p,n,r){var s=p,h=n,m=u;r&&(m=m*2,m>=1&&(m-=1,s=n,h=r));const v=h.red-s.red,A=h.green-s.green,D=h.blue-s.blue,T={red:parseInt(Math.floor(s.red+v*m),10),green:parseInt(Math.floor(s.green+A*m),10),blue:parseInt(Math.floor(s.blue+D*m),10)};return"rgb("+T.red+","+T.green+","+T.blue+")"}colourizeVariants(u,p){const n=this.analyzeVariants(u,p);for(const r of this.boxdiv.querySelectorAll("span.tree-lemma")){const s=n.hasOwnProperty(r.dataset.id)?n[n[r.dataset.id]]:n[r.textContent],h={red:252,green:70,blue:107},m={red:63,green:94,blue:251};s?(r.style.color=this.pickColour(s.length/this.longest.path.length,m,h),r.dataset.length=s.length,r.dataset.branch_length=s.branch_length,r.dataset.nodes=s.paths[0].nodes.join(";")):(r.style.color=this.pickColour(1/this.longest.path.length,m,h),r.dataset.length=0,r.dataset.branch_length=0,r.dataset.nodes=""),r.textContent.trim()===""?(r.innerHTML='<span lang="en">\xA0\xA0\xA0</span>',r.style.backgroundColor=r.style.color):r.style.backgroundColor=""}}}class fe extends xe{constructor(u){super(u),this.desc=u,this.text=f.firsttext(u)}init(){this.makeTextBox(),this.makeDescBox(),this.descbox.style.maxWidth="595px",this.descbox.style.paddingLeft="5px",this.boxdiv.addEventListener("mouseup",W.textMouseup)}refresh(){this.boxdiv.innerHTML="",this.boxdiv.appendChild(M.sheets.lemma.transformToFragment(this.text,document)),F(this.boxdiv);for(const u of f.lemmata(!1,this.boxdiv))u.IAST=u.cloneNode(!0);this.updatescript()}makeTextBox(){const u=document.createElement("div");u.dataset.id=this.name,u.classList.add("text-box"),u.appendChild(M.sheets.lemma.transformToFragment(this.text,document)),F(u);for(const p of f.lemmata(!1,u))p.IAST=p.cloneNode(!0);this.boxdiv=u}}class pe extends xe{constructor(){super(name),this.desc="Matrix",this.name="Matrix",this.makeDescBox(),this.makeViewBox(),this.descbox.style.maxWidth="100vw",this.descbox.style.paddingLeft="5px"}init(){this.makeTable()}makeViewBox(){const u=document.createElement("div");u.classList.add("matrix"),u.dataset.id=this.name,this.boxdiv=u}makeTable(){const u=document.createElement("div");u.classList.add("scroller"),u.append(M.sheets.matrix.transformToFragment(d.xml,document)),u.addEventListener("dragstart",W.thDragStart),u.addEventListener("dragenter",W.trDragEnter),u.addEventListener("dragleave",W.trDragLeave),u.addEventListener("dragover",v=>v.preventDefault()),u.addEventListener("drop",W.trDragDrop),u.addEventListener("mousedown",W.matrixMousedown);const p=document.createElement("tr");p.classList.add("header");const n=document.createElement("td");n.classList.add("anchor"),p.appendChild(n);const r=[...f.trs(u)],s=r.map(v=>f.trWalker(v)),h=f.tds(!1,r[0]);for(const v of h){const A=document.createElement("th");A.dataset.ref=v.dataset.n;let D=0;const T=new Set;for(const be of s){const we=be.nextNode();we.IAST=we.cloneNode(!0);const ye=we.textContent;ye!==""&&(D++,T.add(ye))}const V=D<2?D:`${D}(${T.size})`,j=document.createElement("span");j.classList.add("readings"),j.appendChild(document.createTextNode(V)),A.appendChild(j);const oe=document.createElement("form");oe.innerHTML='<div><input class="insignificant" title="insignificant" type="checkbox"'+(v.dataset.insignificant?"checked":"")+'></div><div><input class="binary" title="binary" type="checkbox"'+(v.dataset.binary?"checked":"")+"></div>",A.appendChild(oe),p.appendChild(A)}const m=u.querySelector("tbody");m.insertBefore(p,m.firstChild),this.boxdiv.append(u)}}return{branchinit:function(){comboView.init(),window.startbox!==void 0&&(window.startbox.tree?w.tree(window.startbox.tree.stemmaid,window.startbox.tree.id):window.startbox.text&&w.text(window.startbox.text.name,window.startbox.text.map))},maininit:function(){const c=document.getElementById("menu");c.addEventListener("mouseover",W.menuMouseover),c.addEventListener("mouseout",W.menuMouseout),c.addEventListener("click",W.menuClick),c.querySelector("#file").addEventListener("change",G.bind(null,K),!1),c.querySelector("#treefile").addEventListener("change",G.bind(null,U),!1),c.style.display="block",comboView.init()},init:function(){d.viewdiv=document.getElementById("views"),d.descs=document.getElementById("descs"),d.viewdiv.addEventListener("click",W.textClick),document.addEventListener("keydown",W.keyDown,{capture:!0}),document.addEventListener("contextmenu",W.rightClick),document.addEventListener("mouseup",re.remove)},getWindows:function(){return d.windows},addWindow:function(c){d.windows.push(c)},getViewdiv:function(){return d.viewdiv},getTrees:function(){return d.trees}}}();window.addEventListener("load",window.comboView.maininit);
