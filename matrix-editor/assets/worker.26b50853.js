(function(){"use strict";var h,g,p,m;const x=function(i,s){const d={Intersection:function(...e){const n=e[0];return new Set([...n].filter(o=>{for(let t=1;t<e.length;t++)if(!e[t].has(o))return!1;return!0}))},Union:function(...e){return new Set(e.reduce((n,o)=>(n=[...n,...o],n),[]))}},I=function(e){const n=new Map;for(const o of s[0]){const t=i.get(o),r=t!==void 0?[t]:[];n.set(o,new Set(r))}for(let o=1;o<s.length;o++)for(const[t,r]of s[o]){const f=r.map(u=>n.get(u)),c=d.Intersection(...f);if(e&&t===e&&c.size===1)return[...c][0];const l=c.size>0?c:d.Union(...f);n.set(t,l)}return n},S=function(e,n){const o=s[0],t=new Map;for(const r of s[s.length-1])t.set(r[0],e.get(r[0]));for(let r=s.length-1;r>1;r--)for(const[f,c]of s[r]){const l=t.get(f);for(const u of c){if(o.indexOf(u)!==-1)continue;const a=e.get(u),z=(()=>{if(a.size===1)return a;const M=d.Intersection(l,a);return M.size>0?M:a})();if(n&&u===n)return z;t.set(u,z)}}return n?t.get(n):t},y=function(e=null){const n=I(e);if(typeof n=="string")return n;const o=S(n,e);return e?w(o):new Map(Array.from(o,([t,r])=>[t,w(r,!0)]))},w=function(e,n=!1){if(!n&&e.size===1)return[...e][0].trim();const o=[...e].map(t=>t.trim()===""?"_":t);return o.length===1?o[0]:"{"+o.join(", ")+"}"};return{run:y}};onmessage=function(i){h=i.data.readings,g=i.data.levels,p=i.data.num,m=i.data.id;const s=new x(h,g).run(m);postMessage({n:p,result:s})}})();
